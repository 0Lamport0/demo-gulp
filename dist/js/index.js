!function(C){var A={};function c(g){if(A[g])return A[g].exports;var I=A[g]={exports:{},id:g,loaded:!1};return C[g].call(I.exports,I,I.exports,c),I.loaded=!0,I.exports}c.m=C,c.c=A,c.p="",c(0)}([function(g,I,C){g.exports=C(1)},function(module,exports,__webpack_require__){eval('/*** IMPORTS FROM imports-loader ***/\n\n\nconst IScroll = __webpack_require__(2);\r\n\r\nfunction Page(){\r\n    FastClick.attach(document.body);\r\n    this.catListElem = $(".js-navList");\r\n    this.detListElem = $(".js-contentList");\r\n    // console.log(this.catListElem);\r\n    // console.log(this.detListElem);\r\n};\r\n\r\n$.extend(Page.prototype,{\r\n    init : function(){\r\n        this.getNavData();\r\n        this.getDetailsData();\r\n        // 创建分类滚动\r\n        this.createCategoryScroller();\r\n        // 创建商品滚动\r\n        this.creataProductScroller();\r\n    },\r\n    getNavData : function(){\r\n        $.ajax({\r\n            url : "../json/index.json",\r\n            success : $.proxy(this.handleGetNavDataSucc,this),\r\n            error : $.proxy(this.handleGetNavDataErr,this)\r\n        })\r\n    },\r\n    getDetailsData : function(){\r\n        $.ajax({\r\n            url : "../json/index.json",\r\n            success : $.proxy(this.handleGetDetailsDataSucc,this),\r\n            error : $.proxy(this.handleGetDetailsDataErr,this)\r\n        })\r\n    },\r\n    handleGetNavDataSucc : function(res){\r\n        // console.log(res);\r\n        let str = "";\r\n        for( let i = 0; i < res.navData.categories.length; i ++ ){\r\n            // console.log(res.navData.categories[i]);\r\n            str += "<li class=\'nav-item iconfont\'>" + res.navData.categories[i].icon + "</li>";\r\n        }\r\n        // console.log(str);\r\n        this.catListElem.html(str);\r\n        if( this.categoryScroll ){\r\n            this.categoryScroll.refresh();\r\n        }\r\n    },\r\n    handleGetDetailsDataSucc : function(res){\r\n        // console.log(res);\r\n        let str = "";\r\n        for( let i = 0; i < res.detailsData.commodities.length; i ++ ){\r\n            // console.log(res.detailsData.commodities[i]);\r\n            str += "<li class=\'content-item\'><img src=\'" + res.detailsData.commodities[i].url + "\' alt=\'\' title=\'\' /><dl><dt>" + res.detailsData.commodities[i].title + "</dt><dd>" + res.detailsData.commodities[i].oldPrice + "</dd></dl></li>";\r\n        }\r\n        // console.log(str);\r\n        this.detListElem.html(str);\r\n        if( this.productScroll ){\r\n            this.productScroll.refresh();\r\n        }\r\n    },\r\n    handleGetNavDataErr : function(){\r\n        console.log("getNavData is error");\r\n    },\r\n    handleGetDetailsDataErr : function(){\r\n        console.log("getDetailsData is error");\r\n    },\r\n    createCategoryScroller : function(){\r\n        this.categoryScroll = new IScroll(".nav",{\r\n            scrollX : true,\r\n            scrollY : false\r\n        });\r\n    },\r\n    creataProductScroller : function(){\r\n        this.productScroll = new IScroll(".content",{\r\n            probeType : 3\r\n        });\r\n        // 添加监听事件，实现下拉刷新上拉加载\r\n        this.productScroll.on("scroll",function(){\r\n            // console.log("实现下拉刷新上拉加载");\r\n        });\r\n    }\r\n});\r\nvar page = new Page();\r\npage.init();\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvanMvcGFnZXMvaW5kZXgvaW5kZXguanM/YjlhMyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsbUNBQW1DO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdDQUF3QztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLENBQUM7QUFDRDtBQUNBIiwiZmlsZSI6IjEuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqIElNUE9SVFMgRlJPTSBpbXBvcnRzLWxvYWRlciAqKiovXG5cblxuY29uc3QgSVNjcm9sbCA9IHJlcXVpcmUoXCIuLi8uLi9jb21tb24vaXNjcm9sbC5qc1wiKTtcclxuXHJcbmZ1bmN0aW9uIFBhZ2UoKXtcclxuICAgIEZhc3RDbGljay5hdHRhY2goZG9jdW1lbnQuYm9keSk7XHJcbiAgICB0aGlzLmNhdExpc3RFbGVtID0gJChcIi5qcy1uYXZMaXN0XCIpO1xyXG4gICAgdGhpcy5kZXRMaXN0RWxlbSA9ICQoXCIuanMtY29udGVudExpc3RcIik7XHJcbiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmNhdExpc3RFbGVtKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZGV0TGlzdEVsZW0pO1xyXG59O1xyXG5cclxuJC5leHRlbmQoUGFnZS5wcm90b3R5cGUse1xyXG4gICAgaW5pdCA6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdGhpcy5nZXROYXZEYXRhKCk7XHJcbiAgICAgICAgdGhpcy5nZXREZXRhaWxzRGF0YSgpO1xyXG4gICAgICAgIC8vIOWIm+W7uuWIhuexu+a7muWKqFxyXG4gICAgICAgIHRoaXMuY3JlYXRlQ2F0ZWdvcnlTY3JvbGxlcigpO1xyXG4gICAgICAgIC8vIOWIm+W7uuWVhuWTgea7muWKqFxyXG4gICAgICAgIHRoaXMuY3JlYXRhUHJvZHVjdFNjcm9sbGVyKCk7XHJcbiAgICB9LFxyXG4gICAgZ2V0TmF2RGF0YSA6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsIDogXCIuLi9qc29uL2luZGV4Lmpzb25cIixcclxuICAgICAgICAgICAgc3VjY2VzcyA6ICQucHJveHkodGhpcy5oYW5kbGVHZXROYXZEYXRhU3VjYyx0aGlzKSxcclxuICAgICAgICAgICAgZXJyb3IgOiAkLnByb3h5KHRoaXMuaGFuZGxlR2V0TmF2RGF0YUVycix0aGlzKVxyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgZ2V0RGV0YWlsc0RhdGEgOiBmdW5jdGlvbigpe1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybCA6IFwiLi4vanNvbi9pbmRleC5qc29uXCIsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3MgOiAkLnByb3h5KHRoaXMuaGFuZGxlR2V0RGV0YWlsc0RhdGFTdWNjLHRoaXMpLFxyXG4gICAgICAgICAgICBlcnJvciA6ICQucHJveHkodGhpcy5oYW5kbGVHZXREZXRhaWxzRGF0YUVycix0aGlzKVxyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgaGFuZGxlR2V0TmF2RGF0YVN1Y2MgOiBmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgbGV0IHN0ciA9IFwiXCI7XHJcbiAgICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCByZXMubmF2RGF0YS5jYXRlZ29yaWVzLmxlbmd0aDsgaSArKyApe1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMubmF2RGF0YS5jYXRlZ29yaWVzW2ldKTtcclxuICAgICAgICAgICAgc3RyICs9IFwiPGxpIGNsYXNzPSduYXYtaXRlbSBpY29uZm9udCc+XCIgKyByZXMubmF2RGF0YS5jYXRlZ29yaWVzW2ldLmljb24gKyBcIjwvbGk+XCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHN0cik7XHJcbiAgICAgICAgdGhpcy5jYXRMaXN0RWxlbS5odG1sKHN0cik7XHJcbiAgICAgICAgaWYoIHRoaXMuY2F0ZWdvcnlTY3JvbGwgKXtcclxuICAgICAgICAgICAgdGhpcy5jYXRlZ29yeVNjcm9sbC5yZWZyZXNoKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGhhbmRsZUdldERldGFpbHNEYXRhU3VjYyA6IGZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICBsZXQgc3RyID0gXCJcIjtcclxuICAgICAgICBmb3IoIGxldCBpID0gMDsgaSA8IHJlcy5kZXRhaWxzRGF0YS5jb21tb2RpdGllcy5sZW5ndGg7IGkgKysgKXtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRldGFpbHNEYXRhLmNvbW1vZGl0aWVzW2ldKTtcclxuICAgICAgICAgICAgc3RyICs9IFwiPGxpIGNsYXNzPSdjb250ZW50LWl0ZW0nPjxpbWcgc3JjPSdcIiArIHJlcy5kZXRhaWxzRGF0YS5jb21tb2RpdGllc1tpXS51cmwgKyBcIicgYWx0PScnIHRpdGxlPScnIC8+PGRsPjxkdD5cIiArIHJlcy5kZXRhaWxzRGF0YS5jb21tb2RpdGllc1tpXS50aXRsZSArIFwiPC9kdD48ZGQ+XCIgKyByZXMuZGV0YWlsc0RhdGEuY29tbW9kaXRpZXNbaV0ub2xkUHJpY2UgKyBcIjwvZGQ+PC9kbD48L2xpPlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhzdHIpO1xyXG4gICAgICAgIHRoaXMuZGV0TGlzdEVsZW0uaHRtbChzdHIpO1xyXG4gICAgICAgIGlmKCB0aGlzLnByb2R1Y3RTY3JvbGwgKXtcclxuICAgICAgICAgICAgdGhpcy5wcm9kdWN0U2Nyb2xsLnJlZnJlc2goKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaGFuZGxlR2V0TmF2RGF0YUVyciA6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJnZXROYXZEYXRhIGlzIGVycm9yXCIpO1xyXG4gICAgfSxcclxuICAgIGhhbmRsZUdldERldGFpbHNEYXRhRXJyIDogZnVuY3Rpb24oKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImdldERldGFpbHNEYXRhIGlzIGVycm9yXCIpO1xyXG4gICAgfSxcclxuICAgIGNyZWF0ZUNhdGVnb3J5U2Nyb2xsZXIgOiBmdW5jdGlvbigpe1xyXG4gICAgICAgIHRoaXMuY2F0ZWdvcnlTY3JvbGwgPSBuZXcgSVNjcm9sbChcIi5uYXZcIix7XHJcbiAgICAgICAgICAgIHNjcm9sbFggOiB0cnVlLFxyXG4gICAgICAgICAgICBzY3JvbGxZIDogZmFsc2VcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBjcmVhdGFQcm9kdWN0U2Nyb2xsZXIgOiBmdW5jdGlvbigpe1xyXG4gICAgICAgIHRoaXMucHJvZHVjdFNjcm9sbCA9IG5ldyBJU2Nyb2xsKFwiLmNvbnRlbnRcIix7XHJcbiAgICAgICAgICAgIHByb2JlVHlwZSA6IDNcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDmt7vliqDnm5HlkKzkuovku7bvvIzlrp7njrDkuIvmi4nliLfmlrDkuIrmi4nliqDovb1cclxuICAgICAgICB0aGlzLnByb2R1Y3RTY3JvbGwub24oXCJzY3JvbGxcIixmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIuWunueOsOS4i+aLieWIt+aWsOS4iuaLieWKoOi9vVwiKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSk7XHJcbnZhciBwYWdlID0gbmV3IFBhZ2UoKTtcclxucGFnZS5pbml0KCk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9qcy9wYWdlcy9pbmRleC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9')},function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;/*** IMPORTS FROM imports-loader ***/\n\n\n/*! iScroll v5.2.0-snapshot ~ (c) 2008-2017 Matteo Spinelli ~ http://cubiq.org/license */\r\n(function (window, document, Math) {\r\n    var rAF = window.requestAnimationFrame\t||\r\n        window.webkitRequestAnimationFrame\t||\r\n        window.mozRequestAnimationFrame\t\t||\r\n        window.oRequestAnimationFrame\t\t||\r\n        window.msRequestAnimationFrame\t\t||\r\n        function (callback) { window.setTimeout(callback, 1000 / 60); };\r\n    \r\n    var utils = (function () {\r\n        var me = {};\r\n    \r\n        var _elementStyle = document.createElement('div').style;\r\n        var _vendor = (function () {\r\n            var vendors = ['t', 'webkitT', 'MozT', 'msT', 'OT'],\r\n                transform,\r\n                i = 0,\r\n                l = vendors.length;\r\n    \r\n            for ( ; i < l; i++ ) {\r\n                transform = vendors[i] + 'ransform';\r\n                if ( transform in _elementStyle ) return vendors[i].substr(0, vendors[i].length-1);\r\n            }\r\n    \r\n            return false;\r\n        })();\r\n    \r\n        function _prefixStyle (style) {\r\n            if ( _vendor === false ) return false;\r\n            if ( _vendor === '' ) return style;\r\n            return _vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n        }\r\n    \r\n        me.getTime = Date.now || function getTime () { return new Date().getTime(); };\r\n    \r\n        me.extend = function (target, obj) {\r\n            for ( var i in obj ) {\r\n                target[i] = obj[i];\r\n            }\r\n        };\r\n    \r\n        me.addEvent = function (el, type, fn, capture) {\r\n            el.addEventListener(type, fn, !!capture);\r\n        };\r\n    \r\n        me.removeEvent = function (el, type, fn, capture) {\r\n            el.removeEventListener(type, fn, !!capture);\r\n        };\r\n    \r\n        me.prefixPointerEvent = function (pointerEvent) {\r\n            return window.MSPointerEvent ?\r\n                'MSPointer' + pointerEvent.charAt(7).toUpperCase() + pointerEvent.substr(8):\r\n                pointerEvent;\r\n        };\r\n    \r\n        me.momentum = function (current, start, time, lowerMargin, wrapperSize, deceleration) {\r\n            var distance = current - start,\r\n                speed = Math.abs(distance) / time,\r\n                destination,\r\n                duration;\r\n    \r\n            deceleration = deceleration === undefined ? 0.0006 : deceleration;\r\n    \r\n            destination = current + ( speed * speed ) / ( 2 * deceleration ) * ( distance < 0 ? -1 : 1 );\r\n            duration = speed / deceleration;\r\n    \r\n            if ( destination < lowerMargin ) {\r\n                destination = wrapperSize ? lowerMargin - ( wrapperSize / 2.5 * ( speed / 8 ) ) : lowerMargin;\r\n                distance = Math.abs(destination - current);\r\n                duration = distance / speed;\r\n            } else if ( destination > 0 ) {\r\n                destination = wrapperSize ? wrapperSize / 2.5 * ( speed / 8 ) : 0;\r\n                distance = Math.abs(current) + destination;\r\n                duration = distance / speed;\r\n            }\r\n    \r\n            return {\r\n                destination: Math.round(destination),\r\n                duration: duration\r\n            };\r\n        };\r\n    \r\n        var _transform = _prefixStyle('transform');\r\n    \r\n        me.extend(me, {\r\n            hasTransform: _transform !== false,\r\n            hasPerspective: _prefixStyle('perspective') in _elementStyle,\r\n            hasTouch: 'ontouchstart' in window,\r\n            hasPointer: !!(window.PointerEvent || window.MSPointerEvent), // IE10 is prefixed\r\n            hasTransition: _prefixStyle('transition') in _elementStyle\r\n        });\r\n    \r\n        /*\r\n        This should find all Android browsers lower than build 535.19 (both stock browser and webview)\r\n        - galaxy S2 is ok\r\n        - 2.3.6 : `AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1`\r\n        - 4.0.4 : `AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30`\r\n       - galaxy S3 is badAndroid (stock brower, webview)\r\n         `AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30`\r\n       - galaxy S4 is badAndroid (stock brower, webview)\r\n         `AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30`\r\n       - galaxy S5 is OK\r\n         `AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Mobile Safari/537.36 (Chrome/)`\r\n       - galaxy S6 is OK\r\n         `AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Mobile Safari/537.36 (Chrome/)`\r\n      */\r\n        me.isBadAndroid = (function() {\r\n            var appVersion = window.navigator.appVersion;\r\n            // Android browser is not a chrome browser.\r\n            if (/Android/.test(appVersion) && !(/Chrome\\/\\d/.test(appVersion))) {\r\n                var safariVersion = appVersion.match(/Safari\\/(\\d+.\\d)/);\r\n                if(safariVersion && typeof safariVersion === \"object\" && safariVersion.length >= 2) {\r\n                    return parseFloat(safariVersion[1]) < 535.19;\r\n                } else {\r\n                    return true;\r\n                }\r\n            } else {\r\n                return false;\r\n            }\r\n        })();\r\n    \r\n        me.extend(me.style = {}, {\r\n            transform: _transform,\r\n            transitionTimingFunction: _prefixStyle('transitionTimingFunction'),\r\n            transitionDuration: _prefixStyle('transitionDuration'),\r\n            transitionDelay: _prefixStyle('transitionDelay'),\r\n            transformOrigin: _prefixStyle('transformOrigin'),\r\n            touchAction: _prefixStyle('touchAction')\r\n        });\r\n    \r\n        me.hasClass = function (e, c) {\r\n            var re = new RegExp(\"(^|\\\\s)\" + c + \"(\\\\s|$)\");\r\n            return re.test(e.className);\r\n        };\r\n    \r\n        me.addClass = function (e, c) {\r\n            if ( me.hasClass(e, c) ) {\r\n                return;\r\n            }\r\n    \r\n            var newclass = e.className.split(' ');\r\n            newclass.push(c);\r\n            e.className = newclass.join(' ');\r\n        };\r\n    \r\n        me.removeClass = function (e, c) {\r\n            if ( !me.hasClass(e, c) ) {\r\n                return;\r\n            }\r\n    \r\n            var re = new RegExp(\"(^|\\\\s)\" + c + \"(\\\\s|$)\", 'g');\r\n            e.className = e.className.replace(re, ' ');\r\n        };\r\n    \r\n        me.offset = function (el) {\r\n            var left = -el.offsetLeft,\r\n                top = -el.offsetTop;\r\n    \r\n            // jshint -W084\r\n            while (el = el.offsetParent) {\r\n                left -= el.offsetLeft;\r\n                top -= el.offsetTop;\r\n            }\r\n            // jshint +W084\r\n    \r\n            return {\r\n                left: left,\r\n                top: top\r\n            };\r\n        };\r\n    \r\n        me.preventDefaultException = function (el, exceptions) {\r\n            for ( var i in exceptions ) {\r\n                if ( exceptions[i].test(el[i]) ) {\r\n                    return true;\r\n                }\r\n            }\r\n    \r\n            return false;\r\n        };\r\n    \r\n        me.extend(me.eventType = {}, {\r\n            touchstart: 1,\r\n            touchmove: 1,\r\n            touchend: 1,\r\n    \r\n            mousedown: 2,\r\n            mousemove: 2,\r\n            mouseup: 2,\r\n    \r\n            pointerdown: 3,\r\n            pointermove: 3,\r\n            pointerup: 3,\r\n    \r\n            MSPointerDown: 3,\r\n            MSPointerMove: 3,\r\n            MSPointerUp: 3\r\n        });\r\n    \r\n        me.extend(me.ease = {}, {\r\n            quadratic: {\r\n                style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n                fn: function (k) {\r\n                    return k * ( 2 - k );\r\n                }\r\n            },\r\n            circular: {\r\n                style: 'cubic-bezier(0.1, 0.57, 0.1, 1)',\t// Not properly \"circular\" but this looks better, it should be (0.075, 0.82, 0.165, 1)\r\n                fn: function (k) {\r\n                    return Math.sqrt( 1 - ( --k * k ) );\r\n                }\r\n            },\r\n            back: {\r\n                style: 'cubic-bezier(0.175, 0.885, 0.32, 1.275)',\r\n                fn: function (k) {\r\n                    var b = 4;\r\n                    return ( k = k - 1 ) * k * ( ( b + 1 ) * k + b ) + 1;\r\n                }\r\n            },\r\n            bounce: {\r\n                style: '',\r\n                fn: function (k) {\r\n                    if ( ( k /= 1 ) < ( 1 / 2.75 ) ) {\r\n                        return 7.5625 * k * k;\r\n                    } else if ( k < ( 2 / 2.75 ) ) {\r\n                        return 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;\r\n                    } else if ( k < ( 2.5 / 2.75 ) ) {\r\n                        return 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;\r\n                    } else {\r\n                        return 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;\r\n                    }\r\n                }\r\n            },\r\n            elastic: {\r\n                style: '',\r\n                fn: function (k) {\r\n                    var f = 0.22,\r\n                        e = 0.4;\r\n    \r\n                    if ( k === 0 ) { return 0; }\r\n                    if ( k == 1 ) { return 1; }\r\n    \r\n                    return ( e * Math.pow( 2, - 10 * k ) * Math.sin( ( k - f / 4 ) * ( 2 * Math.PI ) / f ) + 1 );\r\n                }\r\n            }\r\n        });\r\n    \r\n        me.tap = function (e, eventName) {\r\n            var ev = document.createEvent('Event');\r\n            ev.initEvent(eventName, true, true);\r\n            ev.pageX = e.pageX;\r\n            ev.pageY = e.pageY;\r\n            e.target.dispatchEvent(ev);\r\n        };\r\n    \r\n        me.click = function (e) {\r\n            var target = e.target,\r\n                ev;\r\n    \r\n            if ( !(/(SELECT|INPUT|TEXTAREA)/i).test(target.tagName) ) {\r\n                // https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/initMouseEvent\r\n                // initMouseEvent is deprecated.\r\n                ev = document.createEvent(window.MouseEvent ? 'MouseEvents' : 'Event');\r\n                ev.initEvent('click', true, true);\r\n                ev.view = e.view || window;\r\n                ev.detail = 1;\r\n                ev.screenX = target.screenX || 0;\r\n                ev.screenY = target.screenY || 0;\r\n                ev.clientX = target.clientX || 0;\r\n                ev.clientY = target.clientY || 0;\r\n                ev.ctrlKey = !!e.ctrlKey;\r\n                ev.altKey = !!e.altKey;\r\n                ev.shiftKey = !!e.shiftKey;\r\n                ev.metaKey = !!e.metaKey;\r\n                ev.button = 0;\r\n                ev.relatedTarget = null;\r\n                ev._constructed = true;\r\n                target.dispatchEvent(ev);\r\n            }\r\n        };\r\n    \r\n        me.getTouchAction = function(eventPassthrough, addPinch) {\r\n            var touchAction = 'none';\r\n            if ( eventPassthrough === 'vertical' ) {\r\n                touchAction = 'pan-y';\r\n            } else if (eventPassthrough === 'horizontal' ) {\r\n                touchAction = 'pan-x';\r\n            }\r\n            if (addPinch && touchAction != 'none') {\r\n                // add pinch-zoom support if the browser supports it, but if not (eg. Chrome <55) do nothing\r\n                touchAction += ' pinch-zoom';\r\n            }\r\n            return touchAction;\r\n        };\r\n    \r\n        me.getRect = function(el) {\r\n            if (el instanceof SVGElement) {\r\n                var rect = el.getBoundingClientRect();\r\n                return {\r\n                    top : rect.top,\r\n                    left : rect.left,\r\n                    width : rect.width,\r\n                    height : rect.height\r\n                };\r\n            } else {\r\n                return {\r\n                    top : el.offsetTop,\r\n                    left : el.offsetLeft,\r\n                    width : el.offsetWidth,\r\n                    height : el.offsetHeight\r\n                };\r\n            }\r\n        };\r\n    \r\n        return me;\r\n    })();\r\n    function IScroll (el, options) {\r\n        this.wrapper = typeof el == 'string' ? document.querySelector(el) : el;\r\n        this.scroller = this.wrapper.children[0];\r\n        this.scrollerStyle = this.scroller.style;\t\t// cache style for better performance\r\n    \r\n        this.options = {\r\n    \r\n            resizeScrollbars: true,\r\n    \r\n            mouseWheelSpeed: 20,\r\n    \r\n            snapThreshold: 0.334,\r\n    \r\n    // INSERT POINT: OPTIONS\r\n            disablePointer : !utils.hasPointer,\r\n            disableTouch : utils.hasPointer || !utils.hasTouch,\r\n            disableMouse : utils.hasPointer || utils.hasTouch,\r\n            startX: 0,\r\n            startY: 0,\r\n            scrollY: true,\r\n            directionLockThreshold: 5,\r\n            momentum: true,\r\n    \r\n            bounce: true,\r\n            bounceTime: 600,\r\n            bounceEasing: '',\r\n    \r\n            preventDefault: true,\r\n            preventDefaultException: { tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT)$/ },\r\n    \r\n            HWCompositing: true,\r\n            useTransition: true,\r\n            useTransform: true,\r\n            bindToWrapper: typeof window.onmousedown === \"undefined\"\r\n        };\r\n    \r\n        for ( var i in options ) {\r\n            this.options[i] = options[i];\r\n        }\r\n    \r\n        // Normalize options\r\n        this.translateZ = this.options.HWCompositing && utils.hasPerspective ? ' translateZ(0)' : '';\r\n    \r\n        this.options.useTransition = utils.hasTransition && this.options.useTransition;\r\n        this.options.useTransform = utils.hasTransform && this.options.useTransform;\r\n    \r\n        this.options.eventPassthrough = this.options.eventPassthrough === true ? 'vertical' : this.options.eventPassthrough;\r\n        this.options.preventDefault = !this.options.eventPassthrough && this.options.preventDefault;\r\n    \r\n        // If you want eventPassthrough I have to lock one of the axes\r\n        this.options.scrollY = this.options.eventPassthrough == 'vertical' ? false : this.options.scrollY;\r\n        this.options.scrollX = this.options.eventPassthrough == 'horizontal' ? false : this.options.scrollX;\r\n    \r\n        // With eventPassthrough we also need lockDirection mechanism\r\n        this.options.freeScroll = this.options.freeScroll && !this.options.eventPassthrough;\r\n        this.options.directionLockThreshold = this.options.eventPassthrough ? 0 : this.options.directionLockThreshold;\r\n    \r\n        this.options.bounceEasing = typeof this.options.bounceEasing == 'string' ? utils.ease[this.options.bounceEasing] || utils.ease.circular : this.options.bounceEasing;\r\n    \r\n        this.options.resizePolling = this.options.resizePolling === undefined ? 60 : this.options.resizePolling;\r\n    \r\n        if ( this.options.tap === true ) {\r\n            this.options.tap = 'tap';\r\n        }\r\n    \r\n        // https://github.com/cubiq/iscroll/issues/1029\r\n        if (!this.options.useTransition && !this.options.useTransform) {\r\n            if(!(/relative|absolute/i).test(this.scrollerStyle.position)) {\r\n                this.scrollerStyle.position = \"relative\";\r\n            }\r\n        }\r\n    \r\n        if ( this.options.shrinkScrollbars == 'scale' ) {\r\n            this.options.useTransition = false;\r\n        }\r\n    \r\n        this.options.invertWheelDirection = this.options.invertWheelDirection ? -1 : 1;\r\n    \r\n        if ( this.options.probeType == 3 ) {\r\n            this.options.useTransition = false;\t}\r\n    \r\n    // INSERT POINT: NORMALIZATION\r\n    \r\n        // Some defaults\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.directionX = 0;\r\n        this.directionY = 0;\r\n        this._events = {};\r\n    \r\n    // INSERT POINT: DEFAULTS\r\n    \r\n        this._init();\r\n        this.refresh();\r\n    \r\n        this.scrollTo(this.options.startX, this.options.startY);\r\n        this.enable();\r\n    }\r\n    \r\n    IScroll.prototype = {\r\n        version: '5.2.0-snapshot',\r\n    \r\n        _init: function () {\r\n            this._initEvents();\r\n    \r\n            if ( this.options.scrollbars || this.options.indicators ) {\r\n                this._initIndicators();\r\n            }\r\n    \r\n            if ( this.options.mouseWheel ) {\r\n                this._initWheel();\r\n            }\r\n    \r\n            if ( this.options.snap ) {\r\n                this._initSnap();\r\n            }\r\n    \r\n            if ( this.options.keyBindings ) {\r\n                this._initKeys();\r\n            }\r\n    \r\n    // INSERT POINT: _init\r\n    \r\n        },\r\n    \r\n        destroy: function () {\r\n            this._initEvents(true);\r\n            clearTimeout(this.resizeTimeout);\r\n             this.resizeTimeout = null;\r\n            this._execEvent('destroy');\r\n        },\r\n    \r\n        _transitionEnd: function (e) {\r\n            if ( e.target != this.scroller || !this.isInTransition ) {\r\n                return;\r\n            }\r\n    \r\n            this._transitionTime();\r\n            if ( !this.resetPosition(this.options.bounceTime) ) {\r\n                this.isInTransition = false;\r\n                this._execEvent('scrollEnd');\r\n            }\r\n        },\r\n    \r\n        _start: function (e) {\r\n            // React to left mouse button only\r\n            if ( utils.eventType[e.type] != 1 ) {\r\n              // for button property\r\n              // http://unixpapa.com/js/mouse.html\r\n              var button;\r\n            if (!e.which) {\r\n              /* IE case */\r\n              button = (e.button < 2) ? 0 :\r\n                       ((e.button == 4) ? 1 : 2);\r\n            } else {\r\n              /* All others */\r\n              button = e.button;\r\n            }\r\n                if ( button !== 0 ) {\r\n                    return;\r\n                }\r\n            }\r\n    \r\n            if ( !this.enabled || (this.initiated && utils.eventType[e.type] !== this.initiated) ) {\r\n                return;\r\n            }\r\n    \r\n            if ( this.options.preventDefault && !utils.isBadAndroid && !utils.preventDefaultException(e.target, this.options.preventDefaultException) ) {\r\n                e.preventDefault();\r\n            }\r\n    \r\n            var point = e.touches ? e.touches[0] : e,\r\n                pos;\r\n    \r\n            this.initiated\t= utils.eventType[e.type];\r\n            this.moved\t\t= false;\r\n            this.distX\t\t= 0;\r\n            this.distY\t\t= 0;\r\n            this.directionX = 0;\r\n            this.directionY = 0;\r\n            this.directionLocked = 0;\r\n    \r\n            this.startTime = utils.getTime();\r\n    \r\n            if ( this.options.useTransition && this.isInTransition ) {\r\n                this._transitionTime();\r\n                this.isInTransition = false;\r\n                pos = this.getComputedPosition();\r\n                this._translate(Math.round(pos.x), Math.round(pos.y));\r\n                this._execEvent('scrollEnd');\r\n            } else if ( !this.options.useTransition && this.isAnimating ) {\r\n                this.isAnimating = false;\r\n                this._execEvent('scrollEnd');\r\n            }\r\n    \r\n            this.startX    = this.x;\r\n            this.startY    = this.y;\r\n            this.absStartX = this.x;\r\n            this.absStartY = this.y;\r\n            this.pointX    = point.pageX;\r\n            this.pointY    = point.pageY;\r\n    \r\n            this._execEvent('beforeScrollStart');\r\n        },\r\n    \r\n        _move: function (e) {\r\n            if ( !this.enabled || utils.eventType[e.type] !== this.initiated ) {\r\n                return;\r\n            }\r\n    \r\n            if ( this.options.preventDefault ) {\t// increases performance on Android? TODO: check!\r\n                e.preventDefault();\r\n            }\r\n    \r\n            var point\t\t= e.touches ? e.touches[0] : e,\r\n                deltaX\t\t= point.pageX - this.pointX,\r\n                deltaY\t\t= point.pageY - this.pointY,\r\n                timestamp\t= utils.getTime(),\r\n                newX, newY,\r\n                absDistX, absDistY;\r\n    \r\n            this.pointX\t\t= point.pageX;\r\n            this.pointY\t\t= point.pageY;\r\n    \r\n            this.distX\t\t+= deltaX;\r\n            this.distY\t\t+= deltaY;\r\n            absDistX\t\t= Math.abs(this.distX);\r\n            absDistY\t\t= Math.abs(this.distY);\r\n    \r\n            // We need to move at least 10 pixels for the scrolling to initiate\r\n            if ( timestamp - this.endTime > 300 && (absDistX < 10 && absDistY < 10) ) {\r\n                return;\r\n            }\r\n    \r\n            // If you are scrolling in one direction lock the other\r\n            if ( !this.directionLocked && !this.options.freeScroll ) {\r\n                if ( absDistX > absDistY + this.options.directionLockThreshold ) {\r\n                    this.directionLocked = 'h';\t\t// lock horizontally\r\n                } else if ( absDistY >= absDistX + this.options.directionLockThreshold ) {\r\n                    this.directionLocked = 'v';\t\t// lock vertically\r\n                } else {\r\n                    this.directionLocked = 'n';\t\t// no lock\r\n                }\r\n            }\r\n    \r\n            if ( this.directionLocked == 'h' ) {\r\n                if ( this.options.eventPassthrough == 'vertical' ) {\r\n                    e.preventDefault();\r\n                } else if ( this.options.eventPassthrough == 'horizontal' ) {\r\n                    this.initiated = false;\r\n                    return;\r\n                }\r\n    \r\n                deltaY = 0;\r\n            } else if ( this.directionLocked == 'v' ) {\r\n                if ( this.options.eventPassthrough == 'horizontal' ) {\r\n                    e.preventDefault();\r\n                } else if ( this.options.eventPassthrough == 'vertical' ) {\r\n                    this.initiated = false;\r\n                    return;\r\n                }\r\n    \r\n                deltaX = 0;\r\n            }\r\n    \r\n            deltaX = this.hasHorizontalScroll ? deltaX : 0;\r\n            deltaY = this.hasVerticalScroll ? deltaY : 0;\r\n    \r\n            newX = this.x + deltaX;\r\n            newY = this.y + deltaY;\r\n    \r\n            // Slow down if outside of the boundaries\r\n            if ( newX > 0 || newX < this.maxScrollX ) {\r\n                newX = this.options.bounce ? this.x + deltaX / 3 : newX > 0 ? 0 : this.maxScrollX;\r\n            }\r\n            if ( newY > 0 || newY < this.maxScrollY ) {\r\n                newY = this.options.bounce ? this.y + deltaY / 3 : newY > 0 ? 0 : this.maxScrollY;\r\n            }\r\n    \r\n            this.directionX = deltaX > 0 ? -1 : deltaX < 0 ? 1 : 0;\r\n            this.directionY = deltaY > 0 ? -1 : deltaY < 0 ? 1 : 0;\r\n    \r\n            if ( !this.moved ) {\r\n                this._execEvent('scrollStart');\r\n            }\r\n    \r\n            this.moved = true;\r\n    \r\n            this._translate(newX, newY);\r\n    \r\n    /* REPLACE START: _move */\r\n            if ( timestamp - this.startTime > 300 ) {\r\n                this.startTime = timestamp;\r\n                this.startX = this.x;\r\n                this.startY = this.y;\r\n    \r\n                if ( this.options.probeType == 1 ) {\r\n                    this._execEvent('scroll');\r\n                }\r\n            }\r\n    \r\n            if ( this.options.probeType > 1 ) {\r\n                this._execEvent('scroll');\r\n            }\r\n    /* REPLACE END: _move */\r\n    \r\n        },\r\n    \r\n        _end: function (e) {\r\n            if ( !this.enabled || utils.eventType[e.type] !== this.initiated ) {\r\n                return;\r\n            }\r\n    \r\n            if ( this.options.preventDefault && !utils.preventDefaultException(e.target, this.options.preventDefaultException) ) {\r\n                e.preventDefault();\r\n            }\r\n    \r\n            var point = e.changedTouches ? e.changedTouches[0] : e,\r\n                momentumX,\r\n                momentumY,\r\n                duration = utils.getTime() - this.startTime,\r\n                newX = Math.round(this.x),\r\n                newY = Math.round(this.y),\r\n                distanceX = Math.abs(newX - this.startX),\r\n                distanceY = Math.abs(newY - this.startY),\r\n                time = 0,\r\n                easing = '';\r\n    \r\n            this.isInTransition = 0;\r\n            this.initiated = 0;\r\n            this.endTime = utils.getTime();\r\n    \r\n            // reset if we are outside of the boundaries\r\n            if ( this.resetPosition(this.options.bounceTime) ) {\r\n                return;\r\n            }\r\n    \r\n            this.scrollTo(newX, newY);\t// ensures that the last position is rounded\r\n    \r\n            // we scrolled less than 10 pixels\r\n            if ( !this.moved ) {\r\n                if ( this.options.tap ) {\r\n                    utils.tap(e, this.options.tap);\r\n                }\r\n    \r\n                if ( this.options.click ) {\r\n                    utils.click(e);\r\n                }\r\n    \r\n                this._execEvent('scrollCancel');\r\n                return;\r\n            }\r\n    \r\n            if ( this._events.flick && duration < 200 && distanceX < 100 && distanceY < 100 ) {\r\n                this._execEvent('flick');\r\n                return;\r\n            }\r\n    \r\n            // start momentum animation if needed\r\n            if ( this.options.momentum && duration < 300 ) {\r\n                momentumX = this.hasHorizontalScroll ? utils.momentum(this.x, this.startX, duration, this.maxScrollX, this.options.bounce ? this.wrapperWidth : 0, this.options.deceleration) : { destination: newX, duration: 0 };\r\n                momentumY = this.hasVerticalScroll ? utils.momentum(this.y, this.startY, duration, this.maxScrollY, this.options.bounce ? this.wrapperHeight : 0, this.options.deceleration) : { destination: newY, duration: 0 };\r\n                newX = momentumX.destination;\r\n                newY = momentumY.destination;\r\n                time = Math.max(momentumX.duration, momentumY.duration);\r\n                this.isInTransition = 1;\r\n            }\r\n    \r\n    \r\n            if ( this.options.snap ) {\r\n                var snap = this._nearestSnap(newX, newY);\r\n                this.currentPage = snap;\r\n                time = this.options.snapSpeed || Math.max(\r\n                        Math.max(\r\n                            Math.min(Math.abs(newX - snap.x), 1000),\r\n                            Math.min(Math.abs(newY - snap.y), 1000)\r\n                        ), 300);\r\n                newX = snap.x;\r\n                newY = snap.y;\r\n    \r\n                this.directionX = 0;\r\n                this.directionY = 0;\r\n                easing = this.options.bounceEasing;\r\n            }\r\n    \r\n    // INSERT POINT: _end\r\n    \r\n            if ( newX != this.x || newY != this.y ) {\r\n                // change easing function when scroller goes out of the boundaries\r\n                if ( newX > 0 || newX < this.maxScrollX || newY > 0 || newY < this.maxScrollY ) {\r\n                    easing = utils.ease.quadratic;\r\n                }\r\n    \r\n                this.scrollTo(newX, newY, time, easing);\r\n                return;\r\n            }\r\n    \r\n            this._execEvent('scrollEnd');\r\n        },\r\n    \r\n        _resize: function () {\r\n            var that = this;\r\n    \r\n            clearTimeout(this.resizeTimeout);\r\n    \r\n            this.resizeTimeout = setTimeout(function () {\r\n                that.refresh();\r\n            }, this.options.resizePolling);\r\n        },\r\n    \r\n        resetPosition: function (time) {\r\n            var x = this.x,\r\n                y = this.y;\r\n    \r\n            time = time || 0;\r\n    \r\n            if ( !this.hasHorizontalScroll || this.x > 0 ) {\r\n                x = 0;\r\n            } else if ( this.x < this.maxScrollX ) {\r\n                x = this.maxScrollX;\r\n            }\r\n    \r\n            if ( !this.hasVerticalScroll || this.y > 0 ) {\r\n                y = 0;\r\n            } else if ( this.y < this.maxScrollY ) {\r\n                y = this.maxScrollY;\r\n            }\r\n    \r\n            if ( x == this.x && y == this.y ) {\r\n                return false;\r\n            }\r\n    \r\n            this.scrollTo(x, y, time, this.options.bounceEasing);\r\n    \r\n            return true;\r\n        },\r\n    \r\n        disable: function () {\r\n            this.enabled = false;\r\n        },\r\n    \r\n        enable: function () {\r\n            this.enabled = true;\r\n        },\r\n    \r\n        refresh: function () {\r\n            utils.getRect(this.wrapper);\t\t// Force reflow\r\n    \r\n            this.wrapperWidth\t= this.wrapper.clientWidth;\r\n            this.wrapperHeight\t= this.wrapper.clientHeight;\r\n    \r\n            var rect = utils.getRect(this.scroller);\r\n    /* REPLACE START: refresh */\r\n    \r\n            this.scrollerWidth\t= rect.width;\r\n            this.scrollerHeight\t= rect.height;\r\n    \r\n            this.maxScrollX\t\t= this.wrapperWidth - this.scrollerWidth;\r\n            this.maxScrollY\t\t= this.wrapperHeight - this.scrollerHeight;\r\n    \r\n    /* REPLACE END: refresh */\r\n    \r\n            this.hasHorizontalScroll\t= this.options.scrollX && this.maxScrollX < 0;\r\n            this.hasVerticalScroll\t\t= this.options.scrollY && this.maxScrollY < 0;\r\n            \r\n            if ( !this.hasHorizontalScroll ) {\r\n                this.maxScrollX = 0;\r\n                this.scrollerWidth = this.wrapperWidth;\r\n            }\r\n    \r\n            if ( !this.hasVerticalScroll ) {\r\n                this.maxScrollY = 0;\r\n                this.scrollerHeight = this.wrapperHeight;\r\n            }\r\n    \r\n            this.endTime = 0;\r\n            this.directionX = 0;\r\n            this.directionY = 0;\r\n            \r\n            if(utils.hasPointer && !this.options.disablePointer) {\r\n                // The wrapper should have `touchAction` property for using pointerEvent.\r\n                this.wrapper.style[utils.style.touchAction] = utils.getTouchAction(this.options.eventPassthrough, true);\r\n    \r\n                // case. not support 'pinch-zoom'\r\n                // https://github.com/cubiq/iscroll/issues/1118#issuecomment-270057583\r\n                if (!this.wrapper.style[utils.style.touchAction]) {\r\n                    this.wrapper.style[utils.style.touchAction] = utils.getTouchAction(this.options.eventPassthrough, false);\r\n                }\r\n            }\r\n            this.wrapperOffset = utils.offset(this.wrapper);\r\n    \r\n            this._execEvent('refresh');\r\n    \r\n            this.resetPosition();\r\n    \r\n    // INSERT POINT: _refresh\r\n    \r\n        },\t\r\n    \r\n        on: function (type, fn) {\r\n            if ( !this._events[type] ) {\r\n                this._events[type] = [];\r\n            }\r\n    \r\n            this._events[type].push(fn);\r\n        },\r\n    \r\n        off: function (type, fn) {\r\n            if ( !this._events[type] ) {\r\n                return;\r\n            }\r\n    \r\n            var index = this._events[type].indexOf(fn);\r\n    \r\n            if ( index > -1 ) {\r\n                this._events[type].splice(index, 1);\r\n            }\r\n        },\r\n    \r\n        _execEvent: function (type) {\r\n            if ( !this._events[type] ) {\r\n                return;\r\n            }\r\n    \r\n            var i = 0,\r\n                l = this._events[type].length;\r\n    \r\n            if ( !l ) {\r\n                return;\r\n            }\r\n    \r\n            for ( ; i < l; i++ ) {\r\n                this._events[type][i].apply(this, [].slice.call(arguments, 1));\r\n            }\r\n        },\r\n    \r\n        scrollBy: function (x, y, time, easing) {\r\n            x = this.x + x;\r\n            y = this.y + y;\r\n            time = time || 0;\r\n    \r\n            this.scrollTo(x, y, time, easing);\r\n        },\r\n    \r\n        scrollTo: function (x, y, time, easing) {\r\n            easing = easing || utils.ease.circular;\r\n    \r\n            this.isInTransition = this.options.useTransition && time > 0;\r\n            var transitionType = this.options.useTransition && easing.style;\r\n            if ( !time || transitionType ) {\r\n                    if(transitionType) {\r\n                        this._transitionTimingFunction(easing.style);\r\n                        this._transitionTime(time);\r\n                    }\r\n                this._translate(x, y);\r\n            } else {\r\n                this._animate(x, y, time, easing.fn);\r\n            }\r\n        },\r\n    \r\n        scrollToElement: function (el, time, offsetX, offsetY, easing) {\r\n            el = el.nodeType ? el : this.scroller.querySelector(el);\r\n    \r\n            if ( !el ) {\r\n                return;\r\n            }\r\n    \r\n            var pos = utils.offset(el);\r\n    \r\n            pos.left -= this.wrapperOffset.left;\r\n            pos.top  -= this.wrapperOffset.top;\r\n    \r\n            // if offsetX/Y are true we center the element to the screen\r\n            var elRect = utils.getRect(el);\r\n            var wrapperRect = utils.getRect(this.wrapper);\r\n            if ( offsetX === true ) {\r\n                offsetX = Math.round(elRect.width / 2 - wrapperRect.width / 2);\r\n            }\r\n            if ( offsetY === true ) {\r\n                offsetY = Math.round(elRect.height / 2 - wrapperRect.height / 2);\r\n            }\r\n    \r\n            pos.left -= offsetX || 0;\r\n            pos.top  -= offsetY || 0;\r\n    \r\n            pos.left = pos.left > 0 ? 0 : pos.left < this.maxScrollX ? this.maxScrollX : pos.left;\r\n            pos.top  = pos.top  > 0 ? 0 : pos.top  < this.maxScrollY ? this.maxScrollY : pos.top;\r\n    \r\n            time = time === undefined || time === null || time === 'auto' ? Math.max(Math.abs(this.x-pos.left), Math.abs(this.y-pos.top)) : time;\r\n    \r\n            this.scrollTo(pos.left, pos.top, time, easing);\r\n        },\r\n    \r\n        _transitionTime: function (time) {\r\n            if (!this.options.useTransition) {\r\n                return;\r\n            }\r\n            time = time || 0;\r\n            var durationProp = utils.style.transitionDuration;\r\n            if(!durationProp) {\r\n                return;\r\n            }\r\n    \r\n            this.scrollerStyle[durationProp] = time + 'ms';\r\n    \r\n            if ( !time && utils.isBadAndroid ) {\r\n                this.scrollerStyle[durationProp] = '0.0001ms';\r\n                // remove 0.0001ms\r\n                var self = this;\r\n                rAF(function() {\r\n                    if(self.scrollerStyle[durationProp] === '0.0001ms') {\r\n                        self.scrollerStyle[durationProp] = '0s';\r\n                    }\r\n                });\r\n            }\r\n    \r\n    \r\n            if ( this.indicators ) {\r\n                for ( var i = this.indicators.length; i--; ) {\r\n                    this.indicators[i].transitionTime(time);\r\n                }\r\n            }\r\n    \r\n    \r\n    // INSERT POINT: _transitionTime\r\n    \r\n        },\r\n    \r\n        _transitionTimingFunction: function (easing) {\r\n            this.scrollerStyle[utils.style.transitionTimingFunction] = easing;\r\n    \r\n    \r\n            if ( this.indicators ) {\r\n                for ( var i = this.indicators.length; i--; ) {\r\n                    this.indicators[i].transitionTimingFunction(easing);\r\n                }\r\n            }\r\n    \r\n    \r\n    // INSERT POINT: _transitionTimingFunction\r\n    \r\n        },\r\n    \r\n        _translate: function (x, y) {\r\n            if ( this.options.useTransform ) {\r\n    \r\n    /* REPLACE START: _translate */\r\n    \r\n                this.scrollerStyle[utils.style.transform] = 'translate(' + x + 'px,' + y + 'px)' + this.translateZ;\r\n    \r\n    /* REPLACE END: _translate */\r\n    \r\n            } else {\r\n                x = Math.round(x);\r\n                y = Math.round(y);\r\n                this.scrollerStyle.left = x + 'px';\r\n                this.scrollerStyle.top = y + 'px';\r\n            }\r\n    \r\n            this.x = x;\r\n            this.y = y;\r\n    \r\n    \r\n        if ( this.indicators ) {\r\n            for ( var i = this.indicators.length; i--; ) {\r\n                this.indicators[i].updatePosition();\r\n            }\r\n        }\r\n    \r\n    \r\n    // INSERT POINT: _translate\r\n    \r\n        },\r\n    \r\n        _initEvents: function (remove) {\r\n            var eventType = remove ? utils.removeEvent : utils.addEvent,\r\n                target = this.options.bindToWrapper ? this.wrapper : window;\r\n    \r\n            eventType(window, 'orientationchange', this);\r\n            eventType(window, 'resize', this);\r\n    \r\n            if ( this.options.click ) {\r\n                eventType(this.wrapper, 'click', this, true);\r\n            }\r\n    \r\n            if ( !this.options.disableMouse ) {\r\n                eventType(this.wrapper, 'mousedown', this);\r\n                eventType(target, 'mousemove', this);\r\n                eventType(target, 'mousecancel', this);\r\n                eventType(target, 'mouseup', this);\r\n            }\r\n    \r\n            if ( utils.hasPointer && !this.options.disablePointer ) {\r\n                eventType(this.wrapper, utils.prefixPointerEvent('pointerdown'), this);\r\n                eventType(target, utils.prefixPointerEvent('pointermove'), this);\r\n                eventType(target, utils.prefixPointerEvent('pointercancel'), this);\r\n                eventType(target, utils.prefixPointerEvent('pointerup'), this);\r\n            }\r\n    \r\n            if ( utils.hasTouch && !this.options.disableTouch ) {\r\n                eventType(this.wrapper, 'touchstart', this);\r\n                eventType(target, 'touchmove', this);\r\n                eventType(target, 'touchcancel', this);\r\n                eventType(target, 'touchend', this);\r\n            }\r\n    \r\n            eventType(this.scroller, 'transitionend', this);\r\n            eventType(this.scroller, 'webkitTransitionEnd', this);\r\n            eventType(this.scroller, 'oTransitionEnd', this);\r\n            eventType(this.scroller, 'MSTransitionEnd', this);\r\n        },\r\n    \r\n        getComputedPosition: function () {\r\n            var matrix = window.getComputedStyle(this.scroller, null),\r\n                x, y;\r\n    \r\n            if ( this.options.useTransform ) {\r\n                matrix = matrix[utils.style.transform].split(')')[0].split(', ');\r\n                x = +(matrix[12] || matrix[4]);\r\n                y = +(matrix[13] || matrix[5]);\r\n            } else {\r\n                x = +matrix.left.replace(/[^-\\d.]/g, '');\r\n                y = +matrix.top.replace(/[^-\\d.]/g, '');\r\n            }\r\n    \r\n            return { x: x, y: y };\r\n        },\r\n        _initIndicators: function () {\r\n            var interactive = this.options.interactiveScrollbars,\r\n                customStyle = typeof this.options.scrollbars != 'string',\r\n                indicators = [],\r\n                indicator;\r\n    \r\n            var that = this;\r\n    \r\n            this.indicators = [];\r\n    \r\n            if ( this.options.scrollbars ) {\r\n                // Vertical scrollbar\r\n                if ( this.options.scrollY ) {\r\n                    indicator = {\r\n                        el: createDefaultScrollbar('v', interactive, this.options.scrollbars),\r\n                        interactive: interactive,\r\n                        defaultScrollbars: true,\r\n                        customStyle: customStyle,\r\n                        resize: this.options.resizeScrollbars,\r\n                        shrink: this.options.shrinkScrollbars,\r\n                        fade: this.options.fadeScrollbars,\r\n                        listenX: false\r\n                    };\r\n    \r\n                    this.wrapper.appendChild(indicator.el);\r\n                    indicators.push(indicator);\r\n                }\r\n    \r\n                // Horizontal scrollbar\r\n                if ( this.options.scrollX ) {\r\n                    indicator = {\r\n                        el: createDefaultScrollbar('h', interactive, this.options.scrollbars),\r\n                        interactive: interactive,\r\n                        defaultScrollbars: true,\r\n                        customStyle: customStyle,\r\n                        resize: this.options.resizeScrollbars,\r\n                        shrink: this.options.shrinkScrollbars,\r\n                        fade: this.options.fadeScrollbars,\r\n                        listenY: false\r\n                    };\r\n    \r\n                    this.wrapper.appendChild(indicator.el);\r\n                    indicators.push(indicator);\r\n                }\r\n            }\r\n    \r\n            if ( this.options.indicators ) {\r\n                // TODO: check concat compatibility\r\n                indicators = indicators.concat(this.options.indicators);\r\n            }\r\n    \r\n            for ( var i = indicators.length; i--; ) {\r\n                this.indicators.push( new Indicator(this, indicators[i]) );\r\n            }\r\n    \r\n            // TODO: check if we can use array.map (wide compatibility and performance issues)\r\n            function _indicatorsMap (fn) {\r\n                if (that.indicators) {\r\n                    for ( var i = that.indicators.length; i--; ) {\r\n                        fn.call(that.indicators[i]);\r\n                    }\r\n                }\r\n            }\r\n    \r\n            if ( this.options.fadeScrollbars ) {\r\n                this.on('scrollEnd', function () {\r\n                    _indicatorsMap(function () {\r\n                        this.fade();\r\n                    });\r\n                });\r\n    \r\n                this.on('scrollCancel', function () {\r\n                    _indicatorsMap(function () {\r\n                        this.fade();\r\n                    });\r\n                });\r\n    \r\n                this.on('scrollStart', function () {\r\n                    _indicatorsMap(function () {\r\n                        this.fade(1);\r\n                    });\r\n                });\r\n    \r\n                this.on('beforeScrollStart', function () {\r\n                    _indicatorsMap(function () {\r\n                        this.fade(1, true);\r\n                    });\r\n                });\r\n            }\r\n    \r\n    \r\n            this.on('refresh', function () {\r\n                _indicatorsMap(function () {\r\n                    this.refresh();\r\n                });\r\n            });\r\n    \r\n            this.on('destroy', function () {\r\n                _indicatorsMap(function () {\r\n                    this.destroy();\r\n                });\r\n    \r\n                delete this.indicators;\r\n            });\r\n        },\r\n    \r\n        _initWheel: function () {\r\n            utils.addEvent(this.wrapper, 'wheel', this);\r\n            utils.addEvent(this.wrapper, 'mousewheel', this);\r\n            utils.addEvent(this.wrapper, 'DOMMouseScroll', this);\r\n    \r\n            this.on('destroy', function () {\r\n                clearTimeout(this.wheelTimeout);\r\n                this.wheelTimeout = null;\r\n                utils.removeEvent(this.wrapper, 'wheel', this);\r\n                utils.removeEvent(this.wrapper, 'mousewheel', this);\r\n                utils.removeEvent(this.wrapper, 'DOMMouseScroll', this);\r\n            });\r\n        },\r\n    \r\n        _wheel: function (e) {\r\n            if ( !this.enabled ) {\r\n                return;\r\n            }\r\n    \r\n            e.preventDefault();\r\n    \r\n            var wheelDeltaX, wheelDeltaY,\r\n                newX, newY,\r\n                that = this;\r\n    \r\n            if ( this.wheelTimeout === undefined ) {\r\n                that._execEvent('scrollStart');\r\n            }\r\n    \r\n            // Execute the scrollEnd event after 400ms the wheel stopped scrolling\r\n            clearTimeout(this.wheelTimeout);\r\n            this.wheelTimeout = setTimeout(function () {\r\n                if(!that.options.snap) {\r\n                    that._execEvent('scrollEnd');\r\n                }\r\n                that.wheelTimeout = undefined;\r\n            }, 400);\r\n    \r\n            if ( 'deltaX' in e ) {\r\n                if (e.deltaMode === 1) {\r\n                    wheelDeltaX = -e.deltaX * this.options.mouseWheelSpeed;\r\n                    wheelDeltaY = -e.deltaY * this.options.mouseWheelSpeed;\r\n                } else {\r\n                    wheelDeltaX = -e.deltaX;\r\n                    wheelDeltaY = -e.deltaY;\r\n                }\r\n            } else if ( 'wheelDeltaX' in e ) {\r\n                wheelDeltaX = e.wheelDeltaX / 120 * this.options.mouseWheelSpeed;\r\n                wheelDeltaY = e.wheelDeltaY / 120 * this.options.mouseWheelSpeed;\r\n            } else if ( 'wheelDelta' in e ) {\r\n                wheelDeltaX = wheelDeltaY = e.wheelDelta / 120 * this.options.mouseWheelSpeed;\r\n            } else if ( 'detail' in e ) {\r\n                wheelDeltaX = wheelDeltaY = -e.detail / 3 * this.options.mouseWheelSpeed;\r\n            } else {\r\n                return;\r\n            }\r\n    \r\n            wheelDeltaX *= this.options.invertWheelDirection;\r\n            wheelDeltaY *= this.options.invertWheelDirection;\r\n    \r\n            if ( !this.hasVerticalScroll ) {\r\n                wheelDeltaX = wheelDeltaY;\r\n                wheelDeltaY = 0;\r\n            }\r\n    \r\n            if ( this.options.snap ) {\r\n                newX = this.currentPage.pageX;\r\n                newY = this.currentPage.pageY;\r\n    \r\n                if ( wheelDeltaX > 0 ) {\r\n                    newX--;\r\n                } else if ( wheelDeltaX < 0 ) {\r\n                    newX++;\r\n                }\r\n    \r\n                if ( wheelDeltaY > 0 ) {\r\n                    newY--;\r\n                } else if ( wheelDeltaY < 0 ) {\r\n                    newY++;\r\n                }\r\n    \r\n                this.goToPage(newX, newY);\r\n    \r\n                return;\r\n            }\r\n    \r\n            newX = this.x + Math.round(this.hasHorizontalScroll ? wheelDeltaX : 0);\r\n            newY = this.y + Math.round(this.hasVerticalScroll ? wheelDeltaY : 0);\r\n    \r\n            this.directionX = wheelDeltaX > 0 ? -1 : wheelDeltaX < 0 ? 1 : 0;\r\n            this.directionY = wheelDeltaY > 0 ? -1 : wheelDeltaY < 0 ? 1 : 0;\r\n    \r\n            if ( newX > 0 ) {\r\n                newX = 0;\r\n            } else if ( newX < this.maxScrollX ) {\r\n                newX = this.maxScrollX;\r\n            }\r\n    \r\n            if ( newY > 0 ) {\r\n                newY = 0;\r\n            } else if ( newY < this.maxScrollY ) {\r\n                newY = this.maxScrollY;\r\n            }\r\n    \r\n            this.scrollTo(newX, newY, 0);\r\n    \r\n            if ( this.options.probeType > 1 ) {\r\n                this._execEvent('scroll');\r\n            }\r\n    \r\n    // INSERT POINT: _wheel\r\n        },\r\n    \r\n        _initSnap: function () {\r\n            this.currentPage = {};\r\n    \r\n            if ( typeof this.options.snap == 'string' ) {\r\n                this.options.snap = this.scroller.querySelectorAll(this.options.snap);\r\n            }\r\n    \r\n            this.on('refresh', function () {\r\n                var i = 0, l,\r\n                    m = 0, n,\r\n                    cx, cy,\r\n                    x = 0, y,\r\n                    stepX = this.options.snapStepX || this.wrapperWidth,\r\n                    stepY = this.options.snapStepY || this.wrapperHeight,\r\n                    el,\r\n                    rect;\r\n    \r\n                this.pages = [];\r\n    \r\n                if ( !this.wrapperWidth || !this.wrapperHeight || !this.scrollerWidth || !this.scrollerHeight ) {\r\n                    return;\r\n                }\r\n    \r\n                if ( this.options.snap === true ) {\r\n                    cx = Math.round( stepX / 2 );\r\n                    cy = Math.round( stepY / 2 );\r\n    \r\n                    while ( x > -this.scrollerWidth ) {\r\n                        this.pages[i] = [];\r\n                        l = 0;\r\n                        y = 0;\r\n    \r\n                        while ( y > -this.scrollerHeight ) {\r\n                            this.pages[i][l] = {\r\n                                x: Math.max(x, this.maxScrollX),\r\n                                y: Math.max(y, this.maxScrollY),\r\n                                width: stepX,\r\n                                height: stepY,\r\n                                cx: x - cx,\r\n                                cy: y - cy\r\n                            };\r\n    \r\n                            y -= stepY;\r\n                            l++;\r\n                        }\r\n    \r\n                        x -= stepX;\r\n                        i++;\r\n                    }\r\n                } else {\r\n                    el = this.options.snap;\r\n                    l = el.length;\r\n                    n = -1;\r\n    \r\n                    for ( ; i < l; i++ ) {\r\n                        rect = utils.getRect(el[i]);\r\n                        if ( i === 0 || rect.left <= utils.getRect(el[i-1]).left ) {\r\n                            m = 0;\r\n                            n++;\r\n                        }\r\n    \r\n                        if ( !this.pages[m] ) {\r\n                            this.pages[m] = [];\r\n                        }\r\n    \r\n                        x = Math.max(-rect.left, this.maxScrollX);\r\n                        y = Math.max(-rect.top, this.maxScrollY);\r\n                        cx = x - Math.round(rect.width / 2);\r\n                        cy = y - Math.round(rect.height / 2);\r\n    \r\n                        this.pages[m][n] = {\r\n                            x: x,\r\n                            y: y,\r\n                            width: rect.width,\r\n                            height: rect.height,\r\n                            cx: cx,\r\n                            cy: cy\r\n                        };\r\n    \r\n                        if ( x > this.maxScrollX ) {\r\n                            m++;\r\n                        }\r\n                    }\r\n                }\r\n    \r\n                this.goToPage(this.currentPage.pageX || 0, this.currentPage.pageY || 0, 0);\r\n    \r\n                // Update snap threshold if needed\r\n                if ( this.options.snapThreshold % 1 === 0 ) {\r\n                    this.snapThresholdX = this.options.snapThreshold;\r\n                    this.snapThresholdY = this.options.snapThreshold;\r\n                } else {\r\n                    this.snapThresholdX = Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width * this.options.snapThreshold);\r\n                    this.snapThresholdY = Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height * this.options.snapThreshold);\r\n                }\r\n            });\r\n    \r\n            this.on('flick', function () {\r\n                var time = this.options.snapSpeed || Math.max(\r\n                        Math.max(\r\n                            Math.min(Math.abs(this.x - this.startX), 1000),\r\n                            Math.min(Math.abs(this.y - this.startY), 1000)\r\n                        ), 300);\r\n    \r\n                this.goToPage(\r\n                    this.currentPage.pageX + this.directionX,\r\n                    this.currentPage.pageY + this.directionY,\r\n                    time\r\n                );\r\n            });\r\n        },\r\n    \r\n        _nearestSnap: function (x, y) {\r\n            if ( !this.pages.length ) {\r\n                return { x: 0, y: 0, pageX: 0, pageY: 0 };\r\n            }\r\n    \r\n            var i = 0,\r\n                l = this.pages.length,\r\n                m = 0;\r\n    \r\n            // Check if we exceeded the snap threshold\r\n            if ( Math.abs(x - this.absStartX) < this.snapThresholdX &&\r\n                Math.abs(y - this.absStartY) < this.snapThresholdY ) {\r\n                return this.currentPage;\r\n            }\r\n    \r\n            if ( x > 0 ) {\r\n                x = 0;\r\n            } else if ( x < this.maxScrollX ) {\r\n                x = this.maxScrollX;\r\n            }\r\n    \r\n            if ( y > 0 ) {\r\n                y = 0;\r\n            } else if ( y < this.maxScrollY ) {\r\n                y = this.maxScrollY;\r\n            }\r\n    \r\n            for ( ; i < l; i++ ) {\r\n                if ( x >= this.pages[i][0].cx ) {\r\n                    x = this.pages[i][0].x;\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            l = this.pages[i].length;\r\n    \r\n            for ( ; m < l; m++ ) {\r\n                if ( y >= this.pages[0][m].cy ) {\r\n                    y = this.pages[0][m].y;\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            if ( i == this.currentPage.pageX ) {\r\n                i += this.directionX;\r\n    \r\n                if ( i < 0 ) {\r\n                    i = 0;\r\n                } else if ( i >= this.pages.length ) {\r\n                    i = this.pages.length - 1;\r\n                }\r\n    \r\n                x = this.pages[i][0].x;\r\n            }\r\n    \r\n            if ( m == this.currentPage.pageY ) {\r\n                m += this.directionY;\r\n    \r\n                if ( m < 0 ) {\r\n                    m = 0;\r\n                } else if ( m >= this.pages[0].length ) {\r\n                    m = this.pages[0].length - 1;\r\n                }\r\n    \r\n                y = this.pages[0][m].y;\r\n            }\r\n    \r\n            return {\r\n                x: x,\r\n                y: y,\r\n                pageX: i,\r\n                pageY: m\r\n            };\r\n        },\r\n    \r\n        goToPage: function (x, y, time, easing) {\r\n            easing = easing || this.options.bounceEasing;\r\n    \r\n            if ( x >= this.pages.length ) {\r\n                x = this.pages.length - 1;\r\n            } else if ( x < 0 ) {\r\n                x = 0;\r\n            }\r\n    \r\n            if ( y >= this.pages[x].length ) {\r\n                y = this.pages[x].length - 1;\r\n            } else if ( y < 0 ) {\r\n                y = 0;\r\n            }\r\n    \r\n            var posX = this.pages[x][y].x,\r\n                posY = this.pages[x][y].y;\r\n    \r\n            time = time === undefined ? this.options.snapSpeed || Math.max(\r\n                Math.max(\r\n                    Math.min(Math.abs(posX - this.x), 1000),\r\n                    Math.min(Math.abs(posY - this.y), 1000)\r\n                ), 300) : time;\r\n    \r\n            this.currentPage = {\r\n                x: posX,\r\n                y: posY,\r\n                pageX: x,\r\n                pageY: y\r\n            };\r\n    \r\n            this.scrollTo(posX, posY, time, easing);\r\n        },\r\n    \r\n        next: function (time, easing) {\r\n            var x = this.currentPage.pageX,\r\n                y = this.currentPage.pageY;\r\n    \r\n            x++;\r\n    \r\n            if ( x >= this.pages.length && this.hasVerticalScroll ) {\r\n                x = 0;\r\n                y++;\r\n            }\r\n    \r\n            this.goToPage(x, y, time, easing);\r\n        },\r\n    \r\n        prev: function (time, easing) {\r\n            var x = this.currentPage.pageX,\r\n                y = this.currentPage.pageY;\r\n    \r\n            x--;\r\n    \r\n            if ( x < 0 && this.hasVerticalScroll ) {\r\n                x = 0;\r\n                y--;\r\n            }\r\n    \r\n            this.goToPage(x, y, time, easing);\r\n        },\r\n    \r\n        _initKeys: function (e) {\r\n            // default key bindings\r\n            var keys = {\r\n                pageUp: 33,\r\n                pageDown: 34,\r\n                end: 35,\r\n                home: 36,\r\n                left: 37,\r\n                up: 38,\r\n                right: 39,\r\n                down: 40\r\n            };\r\n            var i;\r\n    \r\n            // if you give me characters I give you keycode\r\n            if ( typeof this.options.keyBindings == 'object' ) {\r\n                for ( i in this.options.keyBindings ) {\r\n                    if ( typeof this.options.keyBindings[i] == 'string' ) {\r\n                        this.options.keyBindings[i] = this.options.keyBindings[i].toUpperCase().charCodeAt(0);\r\n                    }\r\n                }\r\n            } else {\r\n                this.options.keyBindings = {};\r\n            }\r\n    \r\n            for ( i in keys ) {\r\n                this.options.keyBindings[i] = this.options.keyBindings[i] || keys[i];\r\n            }\r\n    \r\n            utils.addEvent(window, 'keydown', this);\r\n    \r\n            this.on('destroy', function () {\r\n                utils.removeEvent(window, 'keydown', this);\r\n            });\r\n        },\r\n    \r\n        _key: function (e) {\r\n            if ( !this.enabled ) {\r\n                return;\r\n            }\r\n    \r\n            var snap = this.options.snap,\t// we are using this alot, better to cache it\r\n                newX = snap ? this.currentPage.pageX : this.x,\r\n                newY = snap ? this.currentPage.pageY : this.y,\r\n                now = utils.getTime(),\r\n                prevTime = this.keyTime || 0,\r\n                acceleration = 0.250,\r\n                pos;\r\n    \r\n            if ( this.options.useTransition && this.isInTransition ) {\r\n                pos = this.getComputedPosition();\r\n    \r\n                this._translate(Math.round(pos.x), Math.round(pos.y));\r\n                this.isInTransition = false;\r\n            }\r\n    \r\n            this.keyAcceleration = now - prevTime < 200 ? Math.min(this.keyAcceleration + acceleration, 50) : 0;\r\n    \r\n            switch ( e.keyCode ) {\r\n                case this.options.keyBindings.pageUp:\r\n                    if ( this.hasHorizontalScroll && !this.hasVerticalScroll ) {\r\n                        newX += snap ? 1 : this.wrapperWidth;\r\n                    } else {\r\n                        newY += snap ? 1 : this.wrapperHeight;\r\n                    }\r\n                    break;\r\n                case this.options.keyBindings.pageDown:\r\n                    if ( this.hasHorizontalScroll && !this.hasVerticalScroll ) {\r\n                        newX -= snap ? 1 : this.wrapperWidth;\r\n                    } else {\r\n                        newY -= snap ? 1 : this.wrapperHeight;\r\n                    }\r\n                    break;\r\n                case this.options.keyBindings.end:\r\n                    newX = snap ? this.pages.length-1 : this.maxScrollX;\r\n                    newY = snap ? this.pages[0].length-1 : this.maxScrollY;\r\n                    break;\r\n                case this.options.keyBindings.home:\r\n                    newX = 0;\r\n                    newY = 0;\r\n                    break;\r\n                case this.options.keyBindings.left:\r\n                    newX += snap ? -1 : 5 + this.keyAcceleration>>0;\r\n                    break;\r\n                case this.options.keyBindings.up:\r\n                    newY += snap ? 1 : 5 + this.keyAcceleration>>0;\r\n                    break;\r\n                case this.options.keyBindings.right:\r\n                    newX -= snap ? -1 : 5 + this.keyAcceleration>>0;\r\n                    break;\r\n                case this.options.keyBindings.down:\r\n                    newY -= snap ? 1 : 5 + this.keyAcceleration>>0;\r\n                    break;\r\n                default:\r\n                    return;\r\n            }\r\n    \r\n            if ( snap ) {\r\n                this.goToPage(newX, newY);\r\n                return;\r\n            }\r\n    \r\n            if ( newX > 0 ) {\r\n                newX = 0;\r\n                this.keyAcceleration = 0;\r\n            } else if ( newX < this.maxScrollX ) {\r\n                newX = this.maxScrollX;\r\n                this.keyAcceleration = 0;\r\n            }\r\n    \r\n            if ( newY > 0 ) {\r\n                newY = 0;\r\n                this.keyAcceleration = 0;\r\n            } else if ( newY < this.maxScrollY ) {\r\n                newY = this.maxScrollY;\r\n                this.keyAcceleration = 0;\r\n            }\r\n    \r\n            this.scrollTo(newX, newY, 0);\r\n    \r\n            this.keyTime = now;\r\n        },\r\n    \r\n        _animate: function (destX, destY, duration, easingFn) {\r\n            var that = this,\r\n                startX = this.x,\r\n                startY = this.y,\r\n                startTime = utils.getTime(),\r\n                destTime = startTime + duration;\r\n    \r\n            function step () {\r\n                var now = utils.getTime(),\r\n                    newX, newY,\r\n                    easing;\r\n    \r\n                if ( now >= destTime ) {\r\n                    that.isAnimating = false;\r\n                    that._translate(destX, destY);\r\n                    \r\n                    if ( !that.resetPosition(that.options.bounceTime) ) {\r\n                        that._execEvent('scrollEnd');\r\n                    }\r\n    \r\n                    return;\r\n                }\r\n    \r\n                now = ( now - startTime ) / duration;\r\n                easing = easingFn(now);\r\n                newX = ( destX - startX ) * easing + startX;\r\n                newY = ( destY - startY ) * easing + startY;\r\n                that._translate(newX, newY);\r\n    \r\n                if ( that.isAnimating ) {\r\n                    rAF(step);\r\n                }\r\n    \r\n                if ( that.options.probeType == 3 ) {\r\n                    that._execEvent('scroll');\r\n                }\r\n            }\r\n    \r\n            this.isAnimating = true;\r\n            step();\r\n        },\r\n    \r\n        handleEvent: function (e) {\r\n            switch ( e.type ) {\r\n                case 'touchstart':\r\n                case 'pointerdown':\r\n                case 'MSPointerDown':\r\n                case 'mousedown':\r\n                    this._start(e);\r\n                    break;\r\n                case 'touchmove':\r\n                case 'pointermove':\r\n                case 'MSPointerMove':\r\n                case 'mousemove':\r\n                    this._move(e);\r\n                    break;\r\n                case 'touchend':\r\n                case 'pointerup':\r\n                case 'MSPointerUp':\r\n                case 'mouseup':\r\n                case 'touchcancel':\r\n                case 'pointercancel':\r\n                case 'MSPointerCancel':\r\n                case 'mousecancel':\r\n                    this._end(e);\r\n                    break;\r\n                case 'orientationchange':\r\n                case 'resize':\r\n                    this._resize();\r\n                    break;\r\n                case 'transitionend':\r\n                case 'webkitTransitionEnd':\r\n                case 'oTransitionEnd':\r\n                case 'MSTransitionEnd':\r\n                    this._transitionEnd(e);\r\n                    break;\r\n                case 'wheel':\r\n                case 'DOMMouseScroll':\r\n                case 'mousewheel':\r\n                    this._wheel(e);\r\n                    break;\r\n                case 'keydown':\r\n                    this._key(e);\r\n                    break;\r\n                case 'click':\r\n                    if ( this.enabled && !e._constructed ) {\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    function createDefaultScrollbar (direction, interactive, type) {\r\n        var scrollbar = document.createElement('div'),\r\n            indicator = document.createElement('div');\r\n    \r\n        if ( type === true ) {\r\n            scrollbar.style.cssText = 'position:absolute;z-index:9999';\r\n            indicator.style.cssText = '-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px';\r\n        }\r\n    \r\n        indicator.className = 'iScrollIndicator';\r\n    \r\n        if ( direction == 'h' ) {\r\n            if ( type === true ) {\r\n                scrollbar.style.cssText += ';height:7px;left:2px;right:2px;bottom:0';\r\n                indicator.style.height = '100%';\r\n            }\r\n            scrollbar.className = 'iScrollHorizontalScrollbar';\r\n        } else {\r\n            if ( type === true ) {\r\n                scrollbar.style.cssText += ';width:7px;bottom:2px;top:2px;right:1px';\r\n                indicator.style.width = '100%';\r\n            }\r\n            scrollbar.className = 'iScrollVerticalScrollbar';\r\n        }\r\n    \r\n        scrollbar.style.cssText += ';overflow:hidden';\r\n    \r\n        if ( !interactive ) {\r\n            scrollbar.style.pointerEvents = 'none';\r\n        }\r\n    \r\n        scrollbar.appendChild(indicator);\r\n    \r\n        return scrollbar;\r\n    }\r\n    \r\n    function Indicator (scroller, options) {\r\n        this.wrapper = typeof options.el == 'string' ? document.querySelector(options.el) : options.el;\r\n        this.wrapperStyle = this.wrapper.style;\r\n        this.indicator = this.wrapper.children[0];\r\n        this.indicatorStyle = this.indicator.style;\r\n        this.scroller = scroller;\r\n    \r\n        this.options = {\r\n            listenX: true,\r\n            listenY: true,\r\n            interactive: false,\r\n            resize: true,\r\n            defaultScrollbars: false,\r\n            shrink: false,\r\n            fade: false,\r\n            speedRatioX: 0,\r\n            speedRatioY: 0\r\n        };\r\n    \r\n        for ( var i in options ) {\r\n            this.options[i] = options[i];\r\n        }\r\n    \r\n        this.sizeRatioX = 1;\r\n        this.sizeRatioY = 1;\r\n        this.maxPosX = 0;\r\n        this.maxPosY = 0;\r\n    \r\n        if ( this.options.interactive ) {\r\n            if ( !this.options.disableTouch ) {\r\n                utils.addEvent(this.indicator, 'touchstart', this);\r\n                utils.addEvent(window, 'touchend', this);\r\n            }\r\n            if ( !this.options.disablePointer ) {\r\n                utils.addEvent(this.indicator, utils.prefixPointerEvent('pointerdown'), this);\r\n                utils.addEvent(window, utils.prefixPointerEvent('pointerup'), this);\r\n            }\r\n            if ( !this.options.disableMouse ) {\r\n                utils.addEvent(this.indicator, 'mousedown', this);\r\n                utils.addEvent(window, 'mouseup', this);\r\n            }\r\n        }\r\n    \r\n        if ( this.options.fade ) {\r\n            this.wrapperStyle[utils.style.transform] = this.scroller.translateZ;\r\n            var durationProp = utils.style.transitionDuration;\r\n            if(!durationProp) {\r\n                return;\r\n            }\r\n            this.wrapperStyle[durationProp] = utils.isBadAndroid ? '0.0001ms' : '0ms';\r\n            // remove 0.0001ms\r\n            var self = this;\r\n            if(utils.isBadAndroid) {\r\n                rAF(function() {\r\n                    if(self.wrapperStyle[durationProp] === '0.0001ms') {\r\n                        self.wrapperStyle[durationProp] = '0s';\r\n                    }\r\n                });\r\n            }\r\n            this.wrapperStyle.opacity = '0';\r\n        }\r\n    }\r\n    \r\n    Indicator.prototype = {\r\n        handleEvent: function (e) {\r\n            switch ( e.type ) {\r\n                case 'touchstart':\r\n                case 'pointerdown':\r\n                case 'MSPointerDown':\r\n                case 'mousedown':\r\n                    this._start(e);\r\n                    break;\r\n                case 'touchmove':\r\n                case 'pointermove':\r\n                case 'MSPointerMove':\r\n                case 'mousemove':\r\n                    this._move(e);\r\n                    break;\r\n                case 'touchend':\r\n                case 'pointerup':\r\n                case 'MSPointerUp':\r\n                case 'mouseup':\r\n                case 'touchcancel':\r\n                case 'pointercancel':\r\n                case 'MSPointerCancel':\r\n                case 'mousecancel':\r\n                    this._end(e);\r\n                    break;\r\n            }\r\n        },\r\n    \r\n        destroy: function () {\r\n            if ( this.options.fadeScrollbars ) {\r\n                clearTimeout(this.fadeTimeout);\r\n                this.fadeTimeout = null;\r\n            }\r\n            if ( this.options.interactive ) {\r\n                utils.removeEvent(this.indicator, 'touchstart', this);\r\n                utils.removeEvent(this.indicator, utils.prefixPointerEvent('pointerdown'), this);\r\n                utils.removeEvent(this.indicator, 'mousedown', this);\r\n    \r\n                utils.removeEvent(window, 'touchmove', this);\r\n                utils.removeEvent(window, utils.prefixPointerEvent('pointermove'), this);\r\n                utils.removeEvent(window, 'mousemove', this);\r\n    \r\n                utils.removeEvent(window, 'touchend', this);\r\n                utils.removeEvent(window, utils.prefixPointerEvent('pointerup'), this);\r\n                utils.removeEvent(window, 'mouseup', this);\r\n            }\r\n    \r\n            if ( this.options.defaultScrollbars && this.wrapper.parentNode ) {\r\n                this.wrapper.parentNode.removeChild(this.wrapper);\r\n            }\r\n        },\r\n    \r\n        _start: function (e) {\r\n            var point = e.touches ? e.touches[0] : e;\r\n    \r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n    \r\n            this.transitionTime();\r\n    \r\n            this.initiated = true;\r\n            this.moved = false;\r\n            this.lastPointX\t= point.pageX;\r\n            this.lastPointY\t= point.pageY;\r\n    \r\n            this.startTime\t= utils.getTime();\r\n    \r\n            if ( !this.options.disableTouch ) {\r\n                utils.addEvent(window, 'touchmove', this);\r\n            }\r\n            if ( !this.options.disablePointer ) {\r\n                utils.addEvent(window, utils.prefixPointerEvent('pointermove'), this);\r\n            }\r\n            if ( !this.options.disableMouse ) {\r\n                utils.addEvent(window, 'mousemove', this);\r\n            }\r\n    \r\n            this.scroller._execEvent('beforeScrollStart');\r\n        },\r\n    \r\n        _move: function (e) {\r\n            var point = e.touches ? e.touches[0] : e,\r\n                deltaX, deltaY,\r\n                newX, newY,\r\n                timestamp = utils.getTime();\r\n    \r\n            if ( !this.moved ) {\r\n                this.scroller._execEvent('scrollStart');\r\n            }\r\n    \r\n            this.moved = true;\r\n    \r\n            deltaX = point.pageX - this.lastPointX;\r\n            this.lastPointX = point.pageX;\r\n    \r\n            deltaY = point.pageY - this.lastPointY;\r\n            this.lastPointY = point.pageY;\r\n    \r\n            newX = this.x + deltaX;\r\n            newY = this.y + deltaY;\r\n    \r\n            this._pos(newX, newY);\r\n    \r\n    \r\n            if ( this.scroller.options.probeType == 1 && timestamp - this.startTime > 300 ) {\r\n                this.startTime = timestamp;\r\n                this.scroller._execEvent('scroll');\r\n            } else if ( this.scroller.options.probeType > 1 ) {\r\n                this.scroller._execEvent('scroll');\r\n            }\r\n    \r\n    \r\n    // INSERT POINT: indicator._move\r\n    \r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        },\r\n    \r\n        _end: function (e) {\r\n            if ( !this.initiated ) {\r\n                return;\r\n            }\r\n    \r\n            this.initiated = false;\r\n    \r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n    \r\n            utils.removeEvent(window, 'touchmove', this);\r\n            utils.removeEvent(window, utils.prefixPointerEvent('pointermove'), this);\r\n            utils.removeEvent(window, 'mousemove', this);\r\n    \r\n            if ( this.scroller.options.snap ) {\r\n                var snap = this.scroller._nearestSnap(this.scroller.x, this.scroller.y);\r\n    \r\n                var time = this.options.snapSpeed || Math.max(\r\n                        Math.max(\r\n                            Math.min(Math.abs(this.scroller.x - snap.x), 1000),\r\n                            Math.min(Math.abs(this.scroller.y - snap.y), 1000)\r\n                        ), 300);\r\n    \r\n                if ( this.scroller.x != snap.x || this.scroller.y != snap.y ) {\r\n                    this.scroller.directionX = 0;\r\n                    this.scroller.directionY = 0;\r\n                    this.scroller.currentPage = snap;\r\n                    this.scroller.scrollTo(snap.x, snap.y, time, this.scroller.options.bounceEasing);\r\n                }\r\n            }\r\n    \r\n            if ( this.moved ) {\r\n                this.scroller._execEvent('scrollEnd');\r\n            }\r\n        },\r\n    \r\n        transitionTime: function (time) {\r\n            time = time || 0;\r\n            var durationProp = utils.style.transitionDuration;\r\n            if(!durationProp) {\r\n                return;\r\n            }\r\n    \r\n            this.indicatorStyle[durationProp] = time + 'ms';\r\n    \r\n            if ( !time && utils.isBadAndroid ) {\r\n                this.indicatorStyle[durationProp] = '0.0001ms';\r\n                // remove 0.0001ms\r\n                var self = this;\r\n                rAF(function() {\r\n                    if(self.indicatorStyle[durationProp] === '0.0001ms') {\r\n                        self.indicatorStyle[durationProp] = '0s';\r\n                    }\r\n                });\r\n            }\r\n        },\r\n    \r\n        transitionTimingFunction: function (easing) {\r\n            this.indicatorStyle[utils.style.transitionTimingFunction] = easing;\r\n        },\r\n    \r\n        refresh: function () {\r\n            this.transitionTime();\r\n    \r\n            if ( this.options.listenX && !this.options.listenY ) {\r\n                this.indicatorStyle.display = this.scroller.hasHorizontalScroll ? 'block' : 'none';\r\n            } else if ( this.options.listenY && !this.options.listenX ) {\r\n                this.indicatorStyle.display = this.scroller.hasVerticalScroll ? 'block' : 'none';\r\n            } else {\r\n                this.indicatorStyle.display = this.scroller.hasHorizontalScroll || this.scroller.hasVerticalScroll ? 'block' : 'none';\r\n            }\r\n    \r\n            if ( this.scroller.hasHorizontalScroll && this.scroller.hasVerticalScroll ) {\r\n                utils.addClass(this.wrapper, 'iScrollBothScrollbars');\r\n                utils.removeClass(this.wrapper, 'iScrollLoneScrollbar');\r\n    \r\n                if ( this.options.defaultScrollbars && this.options.customStyle ) {\r\n                    if ( this.options.listenX ) {\r\n                        this.wrapper.style.right = '8px';\r\n                    } else {\r\n                        this.wrapper.style.bottom = '8px';\r\n                    }\r\n                }\r\n            } else {\r\n                utils.removeClass(this.wrapper, 'iScrollBothScrollbars');\r\n                utils.addClass(this.wrapper, 'iScrollLoneScrollbar');\r\n    \r\n                if ( this.options.defaultScrollbars && this.options.customStyle ) {\r\n                    if ( this.options.listenX ) {\r\n                        this.wrapper.style.right = '2px';\r\n                    } else {\r\n                        this.wrapper.style.bottom = '2px';\r\n                    }\r\n                }\r\n            }\r\n    \r\n            utils.getRect(this.wrapper);\t// force refresh\r\n    \r\n            if ( this.options.listenX ) {\r\n                this.wrapperWidth = this.wrapper.clientWidth;\r\n                if ( this.options.resize ) {\r\n                    this.indicatorWidth = Math.max(Math.round(this.wrapperWidth * this.wrapperWidth / (this.scroller.scrollerWidth || this.wrapperWidth || 1)), 8);\r\n                    this.indicatorStyle.width = this.indicatorWidth + 'px';\r\n                } else {\r\n                    this.indicatorWidth = this.indicator.clientWidth;\r\n                }\r\n    \r\n                this.maxPosX = this.wrapperWidth - this.indicatorWidth;\r\n    \r\n                if ( this.options.shrink == 'clip' ) {\r\n                    this.minBoundaryX = -this.indicatorWidth + 8;\r\n                    this.maxBoundaryX = this.wrapperWidth - 8;\r\n                } else {\r\n                    this.minBoundaryX = 0;\r\n                    this.maxBoundaryX = this.maxPosX;\r\n                }\r\n    \r\n                this.sizeRatioX = this.options.speedRatioX || (this.scroller.maxScrollX && (this.maxPosX / this.scroller.maxScrollX));\r\n            }\r\n    \r\n            if ( this.options.listenY ) {\r\n                this.wrapperHeight = this.wrapper.clientHeight;\r\n                if ( this.options.resize ) {\r\n                    this.indicatorHeight = Math.max(Math.round(this.wrapperHeight * this.wrapperHeight / (this.scroller.scrollerHeight || this.wrapperHeight || 1)), 8);\r\n                    this.indicatorStyle.height = this.indicatorHeight + 'px';\r\n                } else {\r\n                    this.indicatorHeight = this.indicator.clientHeight;\r\n                }\r\n    \r\n                this.maxPosY = this.wrapperHeight - this.indicatorHeight;\r\n    \r\n                if ( this.options.shrink == 'clip' ) {\r\n                    this.minBoundaryY = -this.indicatorHeight + 8;\r\n                    this.maxBoundaryY = this.wrapperHeight - 8;\r\n                } else {\r\n                    this.minBoundaryY = 0;\r\n                    this.maxBoundaryY = this.maxPosY;\r\n                }\r\n    \r\n                this.maxPosY = this.wrapperHeight - this.indicatorHeight;\r\n                this.sizeRatioY = this.options.speedRatioY || (this.scroller.maxScrollY && (this.maxPosY / this.scroller.maxScrollY));\r\n            }\r\n    \r\n            this.updatePosition();\r\n        },\r\n    \r\n        updatePosition: function () {\r\n            var x = this.options.listenX && Math.round(this.sizeRatioX * this.scroller.x) || 0,\r\n                y = this.options.listenY && Math.round(this.sizeRatioY * this.scroller.y) || 0;\r\n    \r\n            if ( !this.options.ignoreBoundaries ) {\r\n                if ( x < this.minBoundaryX ) {\r\n                    if ( this.options.shrink == 'scale' ) {\r\n                        this.width = Math.max(this.indicatorWidth + x, 8);\r\n                        this.indicatorStyle.width = this.width + 'px';\r\n                    }\r\n                    x = this.minBoundaryX;\r\n                } else if ( x > this.maxBoundaryX ) {\r\n                    if ( this.options.shrink == 'scale' ) {\r\n                        this.width = Math.max(this.indicatorWidth - (x - this.maxPosX), 8);\r\n                        this.indicatorStyle.width = this.width + 'px';\r\n                        x = this.maxPosX + this.indicatorWidth - this.width;\r\n                    } else {\r\n                        x = this.maxBoundaryX;\r\n                    }\r\n                } else if ( this.options.shrink == 'scale' && this.width != this.indicatorWidth ) {\r\n                    this.width = this.indicatorWidth;\r\n                    this.indicatorStyle.width = this.width + 'px';\r\n                }\r\n    \r\n                if ( y < this.minBoundaryY ) {\r\n                    if ( this.options.shrink == 'scale' ) {\r\n                        this.height = Math.max(this.indicatorHeight + y * 3, 8);\r\n                        this.indicatorStyle.height = this.height + 'px';\r\n                    }\r\n                    y = this.minBoundaryY;\r\n                } else if ( y > this.maxBoundaryY ) {\r\n                    if ( this.options.shrink == 'scale' ) {\r\n                        this.height = Math.max(this.indicatorHeight - (y - this.maxPosY) * 3, 8);\r\n                        this.indicatorStyle.height = this.height + 'px';\r\n                        y = this.maxPosY + this.indicatorHeight - this.height;\r\n                    } else {\r\n                        y = this.maxBoundaryY;\r\n                    }\r\n                } else if ( this.options.shrink == 'scale' && this.height != this.indicatorHeight ) {\r\n                    this.height = this.indicatorHeight;\r\n                    this.indicatorStyle.height = this.height + 'px';\r\n                }\r\n            }\r\n    \r\n            this.x = x;\r\n            this.y = y;\r\n    \r\n            if ( this.scroller.options.useTransform ) {\r\n                this.indicatorStyle[utils.style.transform] = 'translate(' + x + 'px,' + y + 'px)' + this.scroller.translateZ;\r\n            } else {\r\n                this.indicatorStyle.left = x + 'px';\r\n                this.indicatorStyle.top = y + 'px';\r\n            }\r\n        },\r\n    \r\n        _pos: function (x, y) {\r\n            if ( x < 0 ) {\r\n                x = 0;\r\n            } else if ( x > this.maxPosX ) {\r\n                x = this.maxPosX;\r\n            }\r\n    \r\n            if ( y < 0 ) {\r\n                y = 0;\r\n            } else if ( y > this.maxPosY ) {\r\n                y = this.maxPosY;\r\n            }\r\n    \r\n            x = this.options.listenX ? Math.round(x / this.sizeRatioX) : this.scroller.x;\r\n            y = this.options.listenY ? Math.round(y / this.sizeRatioY) : this.scroller.y;\r\n    \r\n            this.scroller.scrollTo(x, y);\r\n        },\r\n    \r\n        fade: function (val, hold) {\r\n            if ( hold && !this.visible ) {\r\n                return;\r\n            }\r\n    \r\n            clearTimeout(this.fadeTimeout);\r\n            this.fadeTimeout = null;\r\n    \r\n            var time = val ? 250 : 500,\r\n                delay = val ? 0 : 300;\r\n    \r\n            val = val ? '1' : '0';\r\n    \r\n            this.wrapperStyle[utils.style.transitionDuration] = time + 'ms';\r\n    \r\n            this.fadeTimeout = setTimeout((function (val) {\r\n                this.wrapperStyle.opacity = val;\r\n                this.visible = +val;\r\n            }).bind(this, val), delay);\r\n        }\r\n    };\r\n    \r\n    IScroll.utils = utils;\r\n    \r\n    if ( typeof module != 'undefined' && module.exports ) {\r\n        module.exports = IScroll;\r\n    } else if ( true ) {\r\n            !(__WEBPACK_AMD_DEFINE_RESULT__ = function () { return IScroll; }.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\r\n    } else {\r\n        window.IScroll = IScroll;\r\n    }\r\n    \r\n    })(window, document, Math);\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvanMvY29tbW9uL2lzY3JvbGwuanM/MGVlOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsd0NBQXdDOztBQUVyRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUIsT0FBTztBQUMxQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsc0RBQXNELDZCQUE2Qjs7QUFFbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUzs7QUFFVCwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVULDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsb0NBQW9DLFVBQVU7QUFDOUMsbUNBQW1DLFVBQVU7O0FBRTdDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRDs7QUFFakQ7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNDQUFzQyw4Q0FBOEM7O0FBRXBGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSwrQ0FBK0M7O0FBRS9DOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnREFBZ0Q7QUFDaEQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0M7QUFDL0MsaUJBQWlCO0FBQ2pCLCtDQUErQztBQUMvQyxpQkFBaUI7QUFDakIsK0NBQStDO0FBQy9DO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxzQ0FBc0M7O0FBRXRDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaU1BQWlNO0FBQ2pNLGdNQUFnTTtBQUNoTTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBLHdDQUF3Qzs7QUFFeEM7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUEsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUIsT0FBTztBQUMxQjtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7OztBQUdBO0FBQ0EscURBQXFELEtBQUs7QUFDMUQ7QUFDQTtBQUNBOzs7QUFHQTs7QUFFQSxTQUFTOztBQUVUO0FBQ0E7OztBQUdBO0FBQ0EscURBQXFELEtBQUs7QUFDMUQ7QUFDQTtBQUNBOzs7QUFHQTs7QUFFQSxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQSxpREFBaUQsS0FBSztBQUN0RDtBQUNBO0FBQ0E7OztBQUdBOztBQUVBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBLG9CQUFvQjtBQUNwQixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDRDQUE0QyxLQUFLO0FBQ2pEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EseURBQXlELEtBQUs7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7O0FBRWpCO0FBQ0EsYUFBYTtBQUNiLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUEsMkJBQTJCLE9BQU87QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUzs7QUFFVDtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUEsbUJBQW1CLE9BQU87QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxtQkFBbUIsT0FBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx5REFBeUQ7QUFDekQscUVBQXFFLDJCQUEyQixzQkFBc0Isa0JBQWtCLDJCQUEyQix1Q0FBdUM7QUFDMU07O0FBRUE7O0FBRUE7QUFDQTtBQUNBLDZDQUE2QyxXQUFXLFNBQVMsVUFBVTtBQUMzRTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSw2Q0FBNkMsVUFBVSxXQUFXLFFBQVE7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7O0FBRUEscUNBQXFDOztBQUVyQztBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7OztBQUdBOztBQUVBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx3Q0FBd0M7O0FBRXhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMLDJEQUFpQyxnQkFBZ0IsRUFBRTtBQUNuRCxLQUFLO0FBQ0w7QUFDQTs7QUFFQSxLQUFLIiwiZmlsZSI6IjIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqIElNUE9SVFMgRlJPTSBpbXBvcnRzLWxvYWRlciAqKiovXG5cblxuLyohIGlTY3JvbGwgdjUuMi4wLXNuYXBzaG90IH4gKGMpIDIwMDgtMjAxNyBNYXR0ZW8gU3BpbmVsbGkgfiBodHRwOi8vY3ViaXEub3JnL2xpY2Vuc2UgKi9cclxuKGZ1bmN0aW9uICh3aW5kb3csIGRvY3VtZW50LCBNYXRoKSB7XHJcbiAgICB2YXIgckFGID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZVx0fHxcclxuICAgICAgICB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lXHR8fFxyXG4gICAgICAgIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcdFx0fHxcclxuICAgICAgICB3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZVx0XHR8fFxyXG4gICAgICAgIHdpbmRvdy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZVx0XHR8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChjYWxsYmFjaykgeyB3aW5kb3cuc2V0VGltZW91dChjYWxsYmFjaywgMTAwMCAvIDYwKTsgfTtcclxuICAgIFxyXG4gICAgdmFyIHV0aWxzID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbWUgPSB7fTtcclxuICAgIFxyXG4gICAgICAgIHZhciBfZWxlbWVudFN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jykuc3R5bGU7XHJcbiAgICAgICAgdmFyIF92ZW5kb3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdmVuZG9ycyA9IFsndCcsICd3ZWJraXRUJywgJ01velQnLCAnbXNUJywgJ09UJ10sXHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm0sXHJcbiAgICAgICAgICAgICAgICBpID0gMCxcclxuICAgICAgICAgICAgICAgIGwgPSB2ZW5kb3JzLmxlbmd0aDtcclxuICAgIFxyXG4gICAgICAgICAgICBmb3IgKCA7IGkgPCBsOyBpKysgKSB7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm0gPSB2ZW5kb3JzW2ldICsgJ3JhbnNmb3JtJztcclxuICAgICAgICAgICAgICAgIGlmICggdHJhbnNmb3JtIGluIF9lbGVtZW50U3R5bGUgKSByZXR1cm4gdmVuZG9yc1tpXS5zdWJzdHIoMCwgdmVuZG9yc1tpXS5sZW5ndGgtMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSkoKTtcclxuICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIF9wcmVmaXhTdHlsZSAoc3R5bGUpIHtcclxuICAgICAgICAgICAgaWYgKCBfdmVuZG9yID09PSBmYWxzZSApIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKCBfdmVuZG9yID09PSAnJyApIHJldHVybiBzdHlsZTtcclxuICAgICAgICAgICAgcmV0dXJuIF92ZW5kb3IgKyBzdHlsZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0eWxlLnN1YnN0cigxKTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBtZS5nZXRUaW1lID0gRGF0ZS5ub3cgfHwgZnVuY3Rpb24gZ2V0VGltZSAoKSB7IHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgfTtcclxuICAgIFxyXG4gICAgICAgIG1lLmV4dGVuZCA9IGZ1bmN0aW9uICh0YXJnZXQsIG9iaikge1xyXG4gICAgICAgICAgICBmb3IgKCB2YXIgaSBpbiBvYmogKSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXRbaV0gPSBvYmpbaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgXHJcbiAgICAgICAgbWUuYWRkRXZlbnQgPSBmdW5jdGlvbiAoZWwsIHR5cGUsIGZuLCBjYXB0dXJlKSB7XHJcbiAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgZm4sICEhY2FwdHVyZSk7XHJcbiAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgIG1lLnJlbW92ZUV2ZW50ID0gZnVuY3Rpb24gKGVsLCB0eXBlLCBmbiwgY2FwdHVyZSkge1xyXG4gICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGZuLCAhIWNhcHR1cmUpO1xyXG4gICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICBtZS5wcmVmaXhQb2ludGVyRXZlbnQgPSBmdW5jdGlvbiAocG9pbnRlckV2ZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuTVNQb2ludGVyRXZlbnQgP1xyXG4gICAgICAgICAgICAgICAgJ01TUG9pbnRlcicgKyBwb2ludGVyRXZlbnQuY2hhckF0KDcpLnRvVXBwZXJDYXNlKCkgKyBwb2ludGVyRXZlbnQuc3Vic3RyKDgpOlxyXG4gICAgICAgICAgICAgICAgcG9pbnRlckV2ZW50O1xyXG4gICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICBtZS5tb21lbnR1bSA9IGZ1bmN0aW9uIChjdXJyZW50LCBzdGFydCwgdGltZSwgbG93ZXJNYXJnaW4sIHdyYXBwZXJTaXplLCBkZWNlbGVyYXRpb24pIHtcclxuICAgICAgICAgICAgdmFyIGRpc3RhbmNlID0gY3VycmVudCAtIHN0YXJ0LFxyXG4gICAgICAgICAgICAgICAgc3BlZWQgPSBNYXRoLmFicyhkaXN0YW5jZSkgLyB0aW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzdGluYXRpb24sXHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjtcclxuICAgIFxyXG4gICAgICAgICAgICBkZWNlbGVyYXRpb24gPSBkZWNlbGVyYXRpb24gPT09IHVuZGVmaW5lZCA/IDAuMDAwNiA6IGRlY2VsZXJhdGlvbjtcclxuICAgIFxyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbiA9IGN1cnJlbnQgKyAoIHNwZWVkICogc3BlZWQgKSAvICggMiAqIGRlY2VsZXJhdGlvbiApICogKCBkaXN0YW5jZSA8IDAgPyAtMSA6IDEgKTtcclxuICAgICAgICAgICAgZHVyYXRpb24gPSBzcGVlZCAvIGRlY2VsZXJhdGlvbjtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIGRlc3RpbmF0aW9uIDwgbG93ZXJNYXJnaW4gKSB7XHJcbiAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbiA9IHdyYXBwZXJTaXplID8gbG93ZXJNYXJnaW4gLSAoIHdyYXBwZXJTaXplIC8gMi41ICogKCBzcGVlZCAvIDggKSApIDogbG93ZXJNYXJnaW47XHJcbiAgICAgICAgICAgICAgICBkaXN0YW5jZSA9IE1hdGguYWJzKGRlc3RpbmF0aW9uIC0gY3VycmVudCk7XHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IGRpc3RhbmNlIC8gc3BlZWQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGRlc3RpbmF0aW9uID4gMCApIHtcclxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uID0gd3JhcHBlclNpemUgPyB3cmFwcGVyU2l6ZSAvIDIuNSAqICggc3BlZWQgLyA4ICkgOiAwO1xyXG4gICAgICAgICAgICAgICAgZGlzdGFuY2UgPSBNYXRoLmFicyhjdXJyZW50KSArIGRlc3RpbmF0aW9uO1xyXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSBkaXN0YW5jZSAvIHNwZWVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uOiBNYXRoLnJvdW5kKGRlc3RpbmF0aW9uKSxcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvblxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICB2YXIgX3RyYW5zZm9ybSA9IF9wcmVmaXhTdHlsZSgndHJhbnNmb3JtJyk7XHJcbiAgICBcclxuICAgICAgICBtZS5leHRlbmQobWUsIHtcclxuICAgICAgICAgICAgaGFzVHJhbnNmb3JtOiBfdHJhbnNmb3JtICE9PSBmYWxzZSxcclxuICAgICAgICAgICAgaGFzUGVyc3BlY3RpdmU6IF9wcmVmaXhTdHlsZSgncGVyc3BlY3RpdmUnKSBpbiBfZWxlbWVudFN0eWxlLFxyXG4gICAgICAgICAgICBoYXNUb3VjaDogJ29udG91Y2hzdGFydCcgaW4gd2luZG93LFxyXG4gICAgICAgICAgICBoYXNQb2ludGVyOiAhISh3aW5kb3cuUG9pbnRlckV2ZW50IHx8IHdpbmRvdy5NU1BvaW50ZXJFdmVudCksIC8vIElFMTAgaXMgcHJlZml4ZWRcclxuICAgICAgICAgICAgaGFzVHJhbnNpdGlvbjogX3ByZWZpeFN0eWxlKCd0cmFuc2l0aW9uJykgaW4gX2VsZW1lbnRTdHlsZVxyXG4gICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICAgICAgLypcclxuICAgICAgICBUaGlzIHNob3VsZCBmaW5kIGFsbCBBbmRyb2lkIGJyb3dzZXJzIGxvd2VyIHRoYW4gYnVpbGQgNTM1LjE5IChib3RoIHN0b2NrIGJyb3dzZXIgYW5kIHdlYnZpZXcpXHJcbiAgICAgICAgLSBnYWxheHkgUzIgaXMgb2tcclxuICAgICAgICAtIDIuMy42IDogYEFwcGxlV2ViS2l0LzUzMy4xIChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgTW9iaWxlIFNhZmFyaS81MzMuMWBcclxuICAgICAgICAtIDQuMC40IDogYEFwcGxlV2ViS2l0LzUzNC4zMCAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIE1vYmlsZSBTYWZhcmkvNTM0LjMwYFxyXG4gICAgICAgLSBnYWxheHkgUzMgaXMgYmFkQW5kcm9pZCAoc3RvY2sgYnJvd2VyLCB3ZWJ2aWV3KVxyXG4gICAgICAgICBgQXBwbGVXZWJLaXQvNTM0LjMwIChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgTW9iaWxlIFNhZmFyaS81MzQuMzBgXHJcbiAgICAgICAtIGdhbGF4eSBTNCBpcyBiYWRBbmRyb2lkIChzdG9jayBicm93ZXIsIHdlYnZpZXcpXHJcbiAgICAgICAgIGBBcHBsZVdlYktpdC81MzQuMzAgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBNb2JpbGUgU2FmYXJpLzUzNC4zMGBcclxuICAgICAgIC0gZ2FsYXh5IFM1IGlzIE9LXHJcbiAgICAgICAgIGBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiAoQ2hyb21lLylgXHJcbiAgICAgICAtIGdhbGF4eSBTNiBpcyBPS1xyXG4gICAgICAgICBgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgTW9iaWxlIFNhZmFyaS81MzcuMzYgKENocm9tZS8pYFxyXG4gICAgICAqL1xyXG4gICAgICAgIG1lLmlzQmFkQW5kcm9pZCA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGFwcFZlcnNpb24gPSB3aW5kb3cubmF2aWdhdG9yLmFwcFZlcnNpb247XHJcbiAgICAgICAgICAgIC8vIEFuZHJvaWQgYnJvd3NlciBpcyBub3QgYSBjaHJvbWUgYnJvd3Nlci5cclxuICAgICAgICAgICAgaWYgKC9BbmRyb2lkLy50ZXN0KGFwcFZlcnNpb24pICYmICEoL0Nocm9tZVxcL1xcZC8udGVzdChhcHBWZXJzaW9uKSkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzYWZhcmlWZXJzaW9uID0gYXBwVmVyc2lvbi5tYXRjaCgvU2FmYXJpXFwvKFxcZCsuXFxkKS8pO1xyXG4gICAgICAgICAgICAgICAgaWYoc2FmYXJpVmVyc2lvbiAmJiB0eXBlb2Ygc2FmYXJpVmVyc2lvbiA9PT0gXCJvYmplY3RcIiAmJiBzYWZhcmlWZXJzaW9uLmxlbmd0aCA+PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc2FmYXJpVmVyc2lvblsxXSkgPCA1MzUuMTk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkoKTtcclxuICAgIFxyXG4gICAgICAgIG1lLmV4dGVuZChtZS5zdHlsZSA9IHt9LCB7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybTogX3RyYW5zZm9ybSxcclxuICAgICAgICAgICAgdHJhbnNpdGlvblRpbWluZ0Z1bmN0aW9uOiBfcHJlZml4U3R5bGUoJ3RyYW5zaXRpb25UaW1pbmdGdW5jdGlvbicpLFxyXG4gICAgICAgICAgICB0cmFuc2l0aW9uRHVyYXRpb246IF9wcmVmaXhTdHlsZSgndHJhbnNpdGlvbkR1cmF0aW9uJyksXHJcbiAgICAgICAgICAgIHRyYW5zaXRpb25EZWxheTogX3ByZWZpeFN0eWxlKCd0cmFuc2l0aW9uRGVsYXknKSxcclxuICAgICAgICAgICAgdHJhbnNmb3JtT3JpZ2luOiBfcHJlZml4U3R5bGUoJ3RyYW5zZm9ybU9yaWdpbicpLFxyXG4gICAgICAgICAgICB0b3VjaEFjdGlvbjogX3ByZWZpeFN0eWxlKCd0b3VjaEFjdGlvbicpXHJcbiAgICAgICAgfSk7XHJcbiAgICBcclxuICAgICAgICBtZS5oYXNDbGFzcyA9IGZ1bmN0aW9uIChlLCBjKSB7XHJcbiAgICAgICAgICAgIHZhciByZSA9IG5ldyBSZWdFeHAoXCIoXnxcXFxccylcIiArIGMgKyBcIihcXFxcc3wkKVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlLnRlc3QoZS5jbGFzc05hbWUpO1xyXG4gICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICBtZS5hZGRDbGFzcyA9IGZ1bmN0aW9uIChlLCBjKSB7XHJcbiAgICAgICAgICAgIGlmICggbWUuaGFzQ2xhc3MoZSwgYykgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB2YXIgbmV3Y2xhc3MgPSBlLmNsYXNzTmFtZS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICBuZXdjbGFzcy5wdXNoKGMpO1xyXG4gICAgICAgICAgICBlLmNsYXNzTmFtZSA9IG5ld2NsYXNzLmpvaW4oJyAnKTtcclxuICAgICAgICB9O1xyXG4gICAgXHJcbiAgICAgICAgbWUucmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbiAoZSwgYykge1xyXG4gICAgICAgICAgICBpZiAoICFtZS5oYXNDbGFzcyhlLCBjKSApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHZhciByZSA9IG5ldyBSZWdFeHAoXCIoXnxcXFxccylcIiArIGMgKyBcIihcXFxcc3wkKVwiLCAnZycpO1xyXG4gICAgICAgICAgICBlLmNsYXNzTmFtZSA9IGUuY2xhc3NOYW1lLnJlcGxhY2UocmUsICcgJyk7XHJcbiAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgIG1lLm9mZnNldCA9IGZ1bmN0aW9uIChlbCkge1xyXG4gICAgICAgICAgICB2YXIgbGVmdCA9IC1lbC5vZmZzZXRMZWZ0LFxyXG4gICAgICAgICAgICAgICAgdG9wID0gLWVsLm9mZnNldFRvcDtcclxuICAgIFxyXG4gICAgICAgICAgICAvLyBqc2hpbnQgLVcwODRcclxuICAgICAgICAgICAgd2hpbGUgKGVsID0gZWwub2Zmc2V0UGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICBsZWZ0IC09IGVsLm9mZnNldExlZnQ7XHJcbiAgICAgICAgICAgICAgICB0b3AgLT0gZWwub2Zmc2V0VG9wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGpzaGludCArVzA4NFxyXG4gICAgXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBsZWZ0OiBsZWZ0LFxyXG4gICAgICAgICAgICAgICAgdG9wOiB0b3BcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgXHJcbiAgICAgICAgbWUucHJldmVudERlZmF1bHRFeGNlcHRpb24gPSBmdW5jdGlvbiAoZWwsIGV4Y2VwdGlvbnMpIHtcclxuICAgICAgICAgICAgZm9yICggdmFyIGkgaW4gZXhjZXB0aW9ucyApIHtcclxuICAgICAgICAgICAgICAgIGlmICggZXhjZXB0aW9uc1tpXS50ZXN0KGVsW2ldKSApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgXHJcbiAgICAgICAgbWUuZXh0ZW5kKG1lLmV2ZW50VHlwZSA9IHt9LCB7XHJcbiAgICAgICAgICAgIHRvdWNoc3RhcnQ6IDEsXHJcbiAgICAgICAgICAgIHRvdWNobW92ZTogMSxcclxuICAgICAgICAgICAgdG91Y2hlbmQ6IDEsXHJcbiAgICBcclxuICAgICAgICAgICAgbW91c2Vkb3duOiAyLFxyXG4gICAgICAgICAgICBtb3VzZW1vdmU6IDIsXHJcbiAgICAgICAgICAgIG1vdXNldXA6IDIsXHJcbiAgICBcclxuICAgICAgICAgICAgcG9pbnRlcmRvd246IDMsXHJcbiAgICAgICAgICAgIHBvaW50ZXJtb3ZlOiAzLFxyXG4gICAgICAgICAgICBwb2ludGVydXA6IDMsXHJcbiAgICBcclxuICAgICAgICAgICAgTVNQb2ludGVyRG93bjogMyxcclxuICAgICAgICAgICAgTVNQb2ludGVyTW92ZTogMyxcclxuICAgICAgICAgICAgTVNQb2ludGVyVXA6IDNcclxuICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgIG1lLmV4dGVuZChtZS5lYXNlID0ge30sIHtcclxuICAgICAgICAgICAgcXVhZHJhdGljOiB7XHJcbiAgICAgICAgICAgICAgICBzdHlsZTogJ2N1YmljLWJlemllcigwLjI1LCAwLjQ2LCAwLjQ1LCAwLjk0KScsXHJcbiAgICAgICAgICAgICAgICBmbjogZnVuY3Rpb24gKGspIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gayAqICggMiAtIGsgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY2lyY3VsYXI6IHtcclxuICAgICAgICAgICAgICAgIHN0eWxlOiAnY3ViaWMtYmV6aWVyKDAuMSwgMC41NywgMC4xLCAxKScsXHQvLyBOb3QgcHJvcGVybHkgXCJjaXJjdWxhclwiIGJ1dCB0aGlzIGxvb2tzIGJldHRlciwgaXQgc2hvdWxkIGJlICgwLjA3NSwgMC44MiwgMC4xNjUsIDEpXHJcbiAgICAgICAgICAgICAgICBmbjogZnVuY3Rpb24gKGspIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KCAxIC0gKCAtLWsgKiBrICkgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYmFjazoge1xyXG4gICAgICAgICAgICAgICAgc3R5bGU6ICdjdWJpYy1iZXppZXIoMC4xNzUsIDAuODg1LCAwLjMyLCAxLjI3NSknLFxyXG4gICAgICAgICAgICAgICAgZm46IGZ1bmN0aW9uIChrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoIGsgPSBrIC0gMSApICogayAqICggKCBiICsgMSApICogayArIGIgKSArIDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJvdW5jZToge1xyXG4gICAgICAgICAgICAgICAgc3R5bGU6ICcnLFxyXG4gICAgICAgICAgICAgICAgZm46IGZ1bmN0aW9uIChrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCAoIGsgLz0gMSApIDwgKCAxIC8gMi43NSApICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gNy41NjI1ICogayAqIGs7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggayA8ICggMiAvIDIuNzUgKSApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDcuNTYyNSAqICggayAtPSAoIDEuNSAvIDIuNzUgKSApICogayArIDAuNzU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggayA8ICggMi41IC8gMi43NSApICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gNy41NjI1ICogKCBrIC09ICggMi4yNSAvIDIuNzUgKSApICogayArIDAuOTM3NTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gNy41NjI1ICogKCBrIC09ICggMi42MjUgLyAyLjc1ICkgKSAqIGsgKyAwLjk4NDM3NTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVsYXN0aWM6IHtcclxuICAgICAgICAgICAgICAgIHN0eWxlOiAnJyxcclxuICAgICAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAoaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gMC4yMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IDAuNDtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICggayA9PT0gMCApIHsgcmV0dXJuIDA7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIGsgPT0gMSApIHsgcmV0dXJuIDE7IH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoIGUgKiBNYXRoLnBvdyggMiwgLSAxMCAqIGsgKSAqIE1hdGguc2luKCAoIGsgLSBmIC8gNCApICogKCAyICogTWF0aC5QSSApIC8gZiApICsgMSApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICBcclxuICAgICAgICBtZS50YXAgPSBmdW5jdGlvbiAoZSwgZXZlbnROYW1lKSB7XHJcbiAgICAgICAgICAgIHZhciBldiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpO1xyXG4gICAgICAgICAgICBldi5pbml0RXZlbnQoZXZlbnROYW1lLCB0cnVlLCB0cnVlKTtcclxuICAgICAgICAgICAgZXYucGFnZVggPSBlLnBhZ2VYO1xyXG4gICAgICAgICAgICBldi5wYWdlWSA9IGUucGFnZVk7XHJcbiAgICAgICAgICAgIGUudGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXYpO1xyXG4gICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICBtZS5jbGljayA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCxcclxuICAgICAgICAgICAgICAgIGV2O1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggISgvKFNFTEVDVHxJTlBVVHxURVhUQVJFQSkvaSkudGVzdCh0YXJnZXQudGFnTmFtZSkgKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvTW91c2VFdmVudC9pbml0TW91c2VFdmVudFxyXG4gICAgICAgICAgICAgICAgLy8gaW5pdE1vdXNlRXZlbnQgaXMgZGVwcmVjYXRlZC5cclxuICAgICAgICAgICAgICAgIGV2ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQod2luZG93Lk1vdXNlRXZlbnQgPyAnTW91c2VFdmVudHMnIDogJ0V2ZW50Jyk7XHJcbiAgICAgICAgICAgICAgICBldi5pbml0RXZlbnQoJ2NsaWNrJywgdHJ1ZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBldi52aWV3ID0gZS52aWV3IHx8IHdpbmRvdztcclxuICAgICAgICAgICAgICAgIGV2LmRldGFpbCA9IDE7XHJcbiAgICAgICAgICAgICAgICBldi5zY3JlZW5YID0gdGFyZ2V0LnNjcmVlblggfHwgMDtcclxuICAgICAgICAgICAgICAgIGV2LnNjcmVlblkgPSB0YXJnZXQuc2NyZWVuWSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgZXYuY2xpZW50WCA9IHRhcmdldC5jbGllbnRYIHx8IDA7XHJcbiAgICAgICAgICAgICAgICBldi5jbGllbnRZID0gdGFyZ2V0LmNsaWVudFkgfHwgMDtcclxuICAgICAgICAgICAgICAgIGV2LmN0cmxLZXkgPSAhIWUuY3RybEtleTtcclxuICAgICAgICAgICAgICAgIGV2LmFsdEtleSA9ICEhZS5hbHRLZXk7XHJcbiAgICAgICAgICAgICAgICBldi5zaGlmdEtleSA9ICEhZS5zaGlmdEtleTtcclxuICAgICAgICAgICAgICAgIGV2Lm1ldGFLZXkgPSAhIWUubWV0YUtleTtcclxuICAgICAgICAgICAgICAgIGV2LmJ1dHRvbiA9IDA7XHJcbiAgICAgICAgICAgICAgICBldi5yZWxhdGVkVGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGV2Ll9jb25zdHJ1Y3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChldik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgXHJcbiAgICAgICAgbWUuZ2V0VG91Y2hBY3Rpb24gPSBmdW5jdGlvbihldmVudFBhc3N0aHJvdWdoLCBhZGRQaW5jaCkge1xyXG4gICAgICAgICAgICB2YXIgdG91Y2hBY3Rpb24gPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIGlmICggZXZlbnRQYXNzdGhyb3VnaCA9PT0gJ3ZlcnRpY2FsJyApIHtcclxuICAgICAgICAgICAgICAgIHRvdWNoQWN0aW9uID0gJ3Bhbi15JztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudFBhc3N0aHJvdWdoID09PSAnaG9yaXpvbnRhbCcgKSB7XHJcbiAgICAgICAgICAgICAgICB0b3VjaEFjdGlvbiA9ICdwYW4teCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFkZFBpbmNoICYmIHRvdWNoQWN0aW9uICE9ICdub25lJykge1xyXG4gICAgICAgICAgICAgICAgLy8gYWRkIHBpbmNoLXpvb20gc3VwcG9ydCBpZiB0aGUgYnJvd3NlciBzdXBwb3J0cyBpdCwgYnV0IGlmIG5vdCAoZWcuIENocm9tZSA8NTUpIGRvIG5vdGhpbmdcclxuICAgICAgICAgICAgICAgIHRvdWNoQWN0aW9uICs9ICcgcGluY2gtem9vbSc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRvdWNoQWN0aW9uO1xyXG4gICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICBtZS5nZXRSZWN0ID0gZnVuY3Rpb24oZWwpIHtcclxuICAgICAgICAgICAgaWYgKGVsIGluc3RhbmNlb2YgU1ZHRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wIDogcmVjdC50b3AsXHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdCA6IHJlY3QubGVmdCxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA6IHJlY3Qud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IDogcmVjdC5oZWlnaHRcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcCA6IGVsLm9mZnNldFRvcCxcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0IDogZWwub2Zmc2V0TGVmdCxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA6IGVsLm9mZnNldFdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA6IGVsLm9mZnNldEhlaWdodFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICByZXR1cm4gbWU7XHJcbiAgICB9KSgpO1xyXG4gICAgZnVuY3Rpb24gSVNjcm9sbCAoZWwsIG9wdGlvbnMpIHtcclxuICAgICAgICB0aGlzLndyYXBwZXIgPSB0eXBlb2YgZWwgPT0gJ3N0cmluZycgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsKSA6IGVsO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsZXIgPSB0aGlzLndyYXBwZXIuY2hpbGRyZW5bMF07XHJcbiAgICAgICAgdGhpcy5zY3JvbGxlclN0eWxlID0gdGhpcy5zY3JvbGxlci5zdHlsZTtcdFx0Ly8gY2FjaGUgc3R5bGUgZm9yIGJldHRlciBwZXJmb3JtYW5jZVxyXG4gICAgXHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0ge1xyXG4gICAgXHJcbiAgICAgICAgICAgIHJlc2l6ZVNjcm9sbGJhcnM6IHRydWUsXHJcbiAgICBcclxuICAgICAgICAgICAgbW91c2VXaGVlbFNwZWVkOiAyMCxcclxuICAgIFxyXG4gICAgICAgICAgICBzbmFwVGhyZXNob2xkOiAwLjMzNCxcclxuICAgIFxyXG4gICAgLy8gSU5TRVJUIFBPSU5UOiBPUFRJT05TXHJcbiAgICAgICAgICAgIGRpc2FibGVQb2ludGVyIDogIXV0aWxzLmhhc1BvaW50ZXIsXHJcbiAgICAgICAgICAgIGRpc2FibGVUb3VjaCA6IHV0aWxzLmhhc1BvaW50ZXIgfHwgIXV0aWxzLmhhc1RvdWNoLFxyXG4gICAgICAgICAgICBkaXNhYmxlTW91c2UgOiB1dGlscy5oYXNQb2ludGVyIHx8IHV0aWxzLmhhc1RvdWNoLFxyXG4gICAgICAgICAgICBzdGFydFg6IDAsXHJcbiAgICAgICAgICAgIHN0YXJ0WTogMCxcclxuICAgICAgICAgICAgc2Nyb2xsWTogdHJ1ZSxcclxuICAgICAgICAgICAgZGlyZWN0aW9uTG9ja1RocmVzaG9sZDogNSxcclxuICAgICAgICAgICAgbW9tZW50dW06IHRydWUsXHJcbiAgICBcclxuICAgICAgICAgICAgYm91bmNlOiB0cnVlLFxyXG4gICAgICAgICAgICBib3VuY2VUaW1lOiA2MDAsXHJcbiAgICAgICAgICAgIGJvdW5jZUVhc2luZzogJycsXHJcbiAgICBcclxuICAgICAgICAgICAgcHJldmVudERlZmF1bHQ6IHRydWUsXHJcbiAgICAgICAgICAgIHByZXZlbnREZWZhdWx0RXhjZXB0aW9uOiB7IHRhZ05hbWU6IC9eKElOUFVUfFRFWFRBUkVBfEJVVFRPTnxTRUxFQ1QpJC8gfSxcclxuICAgIFxyXG4gICAgICAgICAgICBIV0NvbXBvc2l0aW5nOiB0cnVlLFxyXG4gICAgICAgICAgICB1c2VUcmFuc2l0aW9uOiB0cnVlLFxyXG4gICAgICAgICAgICB1c2VUcmFuc2Zvcm06IHRydWUsXHJcbiAgICAgICAgICAgIGJpbmRUb1dyYXBwZXI6IHR5cGVvZiB3aW5kb3cub25tb3VzZWRvd24gPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICB9O1xyXG4gICAgXHJcbiAgICAgICAgZm9yICggdmFyIGkgaW4gb3B0aW9ucyApIHtcclxuICAgICAgICAgICAgdGhpcy5vcHRpb25zW2ldID0gb3B0aW9uc1tpXTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAvLyBOb3JtYWxpemUgb3B0aW9uc1xyXG4gICAgICAgIHRoaXMudHJhbnNsYXRlWiA9IHRoaXMub3B0aW9ucy5IV0NvbXBvc2l0aW5nICYmIHV0aWxzLmhhc1BlcnNwZWN0aXZlID8gJyB0cmFuc2xhdGVaKDApJyA6ICcnO1xyXG4gICAgXHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnVzZVRyYW5zaXRpb24gPSB1dGlscy5oYXNUcmFuc2l0aW9uICYmIHRoaXMub3B0aW9ucy51c2VUcmFuc2l0aW9uO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy51c2VUcmFuc2Zvcm0gPSB1dGlscy5oYXNUcmFuc2Zvcm0gJiYgdGhpcy5vcHRpb25zLnVzZVRyYW5zZm9ybTtcclxuICAgIFxyXG4gICAgICAgIHRoaXMub3B0aW9ucy5ldmVudFBhc3N0aHJvdWdoID0gdGhpcy5vcHRpb25zLmV2ZW50UGFzc3Rocm91Z2ggPT09IHRydWUgPyAndmVydGljYWwnIDogdGhpcy5vcHRpb25zLmV2ZW50UGFzc3Rocm91Z2g7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnByZXZlbnREZWZhdWx0ID0gIXRoaXMub3B0aW9ucy5ldmVudFBhc3N0aHJvdWdoICYmIHRoaXMub3B0aW9ucy5wcmV2ZW50RGVmYXVsdDtcclxuICAgIFxyXG4gICAgICAgIC8vIElmIHlvdSB3YW50IGV2ZW50UGFzc3Rocm91Z2ggSSBoYXZlIHRvIGxvY2sgb25lIG9mIHRoZSBheGVzXHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnNjcm9sbFkgPSB0aGlzLm9wdGlvbnMuZXZlbnRQYXNzdGhyb3VnaCA9PSAndmVydGljYWwnID8gZmFsc2UgOiB0aGlzLm9wdGlvbnMuc2Nyb2xsWTtcclxuICAgICAgICB0aGlzLm9wdGlvbnMuc2Nyb2xsWCA9IHRoaXMub3B0aW9ucy5ldmVudFBhc3N0aHJvdWdoID09ICdob3Jpem9udGFsJyA/IGZhbHNlIDogdGhpcy5vcHRpb25zLnNjcm9sbFg7XHJcbiAgICBcclxuICAgICAgICAvLyBXaXRoIGV2ZW50UGFzc3Rocm91Z2ggd2UgYWxzbyBuZWVkIGxvY2tEaXJlY3Rpb24gbWVjaGFuaXNtXHJcbiAgICAgICAgdGhpcy5vcHRpb25zLmZyZWVTY3JvbGwgPSB0aGlzLm9wdGlvbnMuZnJlZVNjcm9sbCAmJiAhdGhpcy5vcHRpb25zLmV2ZW50UGFzc3Rocm91Z2g7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLmRpcmVjdGlvbkxvY2tUaHJlc2hvbGQgPSB0aGlzLm9wdGlvbnMuZXZlbnRQYXNzdGhyb3VnaCA/IDAgOiB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uTG9ja1RocmVzaG9sZDtcclxuICAgIFxyXG4gICAgICAgIHRoaXMub3B0aW9ucy5ib3VuY2VFYXNpbmcgPSB0eXBlb2YgdGhpcy5vcHRpb25zLmJvdW5jZUVhc2luZyA9PSAnc3RyaW5nJyA/IHV0aWxzLmVhc2VbdGhpcy5vcHRpb25zLmJvdW5jZUVhc2luZ10gfHwgdXRpbHMuZWFzZS5jaXJjdWxhciA6IHRoaXMub3B0aW9ucy5ib3VuY2VFYXNpbmc7XHJcbiAgICBcclxuICAgICAgICB0aGlzLm9wdGlvbnMucmVzaXplUG9sbGluZyA9IHRoaXMub3B0aW9ucy5yZXNpemVQb2xsaW5nID09PSB1bmRlZmluZWQgPyA2MCA6IHRoaXMub3B0aW9ucy5yZXNpemVQb2xsaW5nO1xyXG4gICAgXHJcbiAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMudGFwID09PSB0cnVlICkge1xyXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMudGFwID0gJ3RhcCc7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2N1YmlxL2lzY3JvbGwvaXNzdWVzLzEwMjlcclxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy51c2VUcmFuc2l0aW9uICYmICF0aGlzLm9wdGlvbnMudXNlVHJhbnNmb3JtKSB7XHJcbiAgICAgICAgICAgIGlmKCEoL3JlbGF0aXZlfGFic29sdXRlL2kpLnRlc3QodGhpcy5zY3JvbGxlclN0eWxlLnBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxlclN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2hyaW5rU2Nyb2xsYmFycyA9PSAnc2NhbGUnICkge1xyXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMudXNlVHJhbnNpdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHRoaXMub3B0aW9ucy5pbnZlcnRXaGVlbERpcmVjdGlvbiA9IHRoaXMub3B0aW9ucy5pbnZlcnRXaGVlbERpcmVjdGlvbiA/IC0xIDogMTtcclxuICAgIFxyXG4gICAgICAgIGlmICggdGhpcy5vcHRpb25zLnByb2JlVHlwZSA9PSAzICkge1xyXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMudXNlVHJhbnNpdGlvbiA9IGZhbHNlO1x0fVxyXG4gICAgXHJcbiAgICAvLyBJTlNFUlQgUE9JTlQ6IE5PUk1BTElaQVRJT05cclxuICAgIFxyXG4gICAgICAgIC8vIFNvbWUgZGVmYXVsdHNcclxuICAgICAgICB0aGlzLnggPSAwO1xyXG4gICAgICAgIHRoaXMueSA9IDA7XHJcbiAgICAgICAgdGhpcy5kaXJlY3Rpb25YID0gMDtcclxuICAgICAgICB0aGlzLmRpcmVjdGlvblkgPSAwO1xyXG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xyXG4gICAgXHJcbiAgICAvLyBJTlNFUlQgUE9JTlQ6IERFRkFVTFRTXHJcbiAgICBcclxuICAgICAgICB0aGlzLl9pbml0KCk7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XHJcbiAgICBcclxuICAgICAgICB0aGlzLnNjcm9sbFRvKHRoaXMub3B0aW9ucy5zdGFydFgsIHRoaXMub3B0aW9ucy5zdGFydFkpO1xyXG4gICAgICAgIHRoaXMuZW5hYmxlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIElTY3JvbGwucHJvdG90eXBlID0ge1xyXG4gICAgICAgIHZlcnNpb246ICc1LjIuMC1zbmFwc2hvdCcsXHJcbiAgICBcclxuICAgICAgICBfaW5pdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9pbml0RXZlbnRzKCk7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2Nyb2xsYmFycyB8fCB0aGlzLm9wdGlvbnMuaW5kaWNhdG9ycyApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2luaXRJbmRpY2F0b3JzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5tb3VzZVdoZWVsICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faW5pdFdoZWVsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5zbmFwICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faW5pdFNuYXAoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmtleUJpbmRpbmdzICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faW5pdEtleXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAvLyBJTlNFUlQgUE9JTlQ6IF9pbml0XHJcbiAgICBcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9pbml0RXZlbnRzKHRydWUpO1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZXNpemVUaW1lb3V0KTtcclxuICAgICAgICAgICAgIHRoaXMucmVzaXplVGltZW91dCA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuX2V4ZWNFdmVudCgnZGVzdHJveScpO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBfdHJhbnNpdGlvbkVuZDogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgaWYgKCBlLnRhcmdldCAhPSB0aGlzLnNjcm9sbGVyIHx8ICF0aGlzLmlzSW5UcmFuc2l0aW9uICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvblRpbWUoKTtcclxuICAgICAgICAgICAgaWYgKCAhdGhpcy5yZXNldFBvc2l0aW9uKHRoaXMub3B0aW9ucy5ib3VuY2VUaW1lKSApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNJblRyYW5zaXRpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2V4ZWNFdmVudCgnc2Nyb2xsRW5kJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgX3N0YXJ0OiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAvLyBSZWFjdCB0byBsZWZ0IG1vdXNlIGJ1dHRvbiBvbmx5XHJcbiAgICAgICAgICAgIGlmICggdXRpbHMuZXZlbnRUeXBlW2UudHlwZV0gIT0gMSApIHtcclxuICAgICAgICAgICAgICAvLyBmb3IgYnV0dG9uIHByb3BlcnR5XHJcbiAgICAgICAgICAgICAgLy8gaHR0cDovL3VuaXhwYXBhLmNvbS9qcy9tb3VzZS5odG1sXHJcbiAgICAgICAgICAgICAgdmFyIGJ1dHRvbjtcclxuICAgICAgICAgICAgaWYgKCFlLndoaWNoKSB7XHJcbiAgICAgICAgICAgICAgLyogSUUgY2FzZSAqL1xyXG4gICAgICAgICAgICAgIGJ1dHRvbiA9IChlLmJ1dHRvbiA8IDIpID8gMCA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgKChlLmJ1dHRvbiA9PSA0KSA/IDEgOiAyKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAvKiBBbGwgb3RoZXJzICovXHJcbiAgICAgICAgICAgICAgYnV0dG9uID0gZS5idXR0b247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICggYnV0dG9uICE9PSAwICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggIXRoaXMuZW5hYmxlZCB8fCAodGhpcy5pbml0aWF0ZWQgJiYgdXRpbHMuZXZlbnRUeXBlW2UudHlwZV0gIT09IHRoaXMuaW5pdGlhdGVkKSApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnByZXZlbnREZWZhdWx0ICYmICF1dGlscy5pc0JhZEFuZHJvaWQgJiYgIXV0aWxzLnByZXZlbnREZWZhdWx0RXhjZXB0aW9uKGUudGFyZ2V0LCB0aGlzLm9wdGlvbnMucHJldmVudERlZmF1bHRFeGNlcHRpb24pICkge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdmFyIHBvaW50ID0gZS50b3VjaGVzID8gZS50b3VjaGVzWzBdIDogZSxcclxuICAgICAgICAgICAgICAgIHBvcztcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLmluaXRpYXRlZFx0PSB1dGlscy5ldmVudFR5cGVbZS50eXBlXTtcclxuICAgICAgICAgICAgdGhpcy5tb3ZlZFx0XHQ9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3RYXHRcdD0gMDtcclxuICAgICAgICAgICAgdGhpcy5kaXN0WVx0XHQ9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uWCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uWSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uTG9ja2VkID0gMDtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IHV0aWxzLmdldFRpbWUoKTtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy51c2VUcmFuc2l0aW9uICYmIHRoaXMuaXNJblRyYW5zaXRpb24gKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uVGltZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0luVHJhbnNpdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgcG9zID0gdGhpcy5nZXRDb21wdXRlZFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc2xhdGUoTWF0aC5yb3VuZChwb3MueCksIE1hdGgucm91bmQocG9zLnkpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2V4ZWNFdmVudCgnc2Nyb2xsRW5kJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoICF0aGlzLm9wdGlvbnMudXNlVHJhbnNpdGlvbiAmJiB0aGlzLmlzQW5pbWF0aW5nICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0FuaW1hdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZXhlY0V2ZW50KCdzY3JvbGxFbmQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRYICAgID0gdGhpcy54O1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0WSAgICA9IHRoaXMueTtcclxuICAgICAgICAgICAgdGhpcy5hYnNTdGFydFggPSB0aGlzLng7XHJcbiAgICAgICAgICAgIHRoaXMuYWJzU3RhcnRZID0gdGhpcy55O1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50WCAgICA9IHBvaW50LnBhZ2VYO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50WSAgICA9IHBvaW50LnBhZ2VZO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuX2V4ZWNFdmVudCgnYmVmb3JlU2Nyb2xsU3RhcnQnKTtcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgX21vdmU6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGlmICggIXRoaXMuZW5hYmxlZCB8fCB1dGlscy5ldmVudFR5cGVbZS50eXBlXSAhPT0gdGhpcy5pbml0aWF0ZWQgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5wcmV2ZW50RGVmYXVsdCApIHtcdC8vIGluY3JlYXNlcyBwZXJmb3JtYW5jZSBvbiBBbmRyb2lkPyBUT0RPOiBjaGVjayFcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHZhciBwb2ludFx0XHQ9IGUudG91Y2hlcyA/IGUudG91Y2hlc1swXSA6IGUsXHJcbiAgICAgICAgICAgICAgICBkZWx0YVhcdFx0PSBwb2ludC5wYWdlWCAtIHRoaXMucG9pbnRYLFxyXG4gICAgICAgICAgICAgICAgZGVsdGFZXHRcdD0gcG9pbnQucGFnZVkgLSB0aGlzLnBvaW50WSxcclxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcFx0PSB1dGlscy5nZXRUaW1lKCksXHJcbiAgICAgICAgICAgICAgICBuZXdYLCBuZXdZLFxyXG4gICAgICAgICAgICAgICAgYWJzRGlzdFgsIGFic0Rpc3RZO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRYXHRcdD0gcG9pbnQucGFnZVg7XHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRZXHRcdD0gcG9pbnQucGFnZVk7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5kaXN0WFx0XHQrPSBkZWx0YVg7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzdFlcdFx0Kz0gZGVsdGFZO1xyXG4gICAgICAgICAgICBhYnNEaXN0WFx0XHQ9IE1hdGguYWJzKHRoaXMuZGlzdFgpO1xyXG4gICAgICAgICAgICBhYnNEaXN0WVx0XHQ9IE1hdGguYWJzKHRoaXMuZGlzdFkpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbW92ZSBhdCBsZWFzdCAxMCBwaXhlbHMgZm9yIHRoZSBzY3JvbGxpbmcgdG8gaW5pdGlhdGVcclxuICAgICAgICAgICAgaWYgKCB0aW1lc3RhbXAgLSB0aGlzLmVuZFRpbWUgPiAzMDAgJiYgKGFic0Rpc3RYIDwgMTAgJiYgYWJzRGlzdFkgPCAxMCkgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAvLyBJZiB5b3UgYXJlIHNjcm9sbGluZyBpbiBvbmUgZGlyZWN0aW9uIGxvY2sgdGhlIG90aGVyXHJcbiAgICAgICAgICAgIGlmICggIXRoaXMuZGlyZWN0aW9uTG9ja2VkICYmICF0aGlzLm9wdGlvbnMuZnJlZVNjcm9sbCApIHtcclxuICAgICAgICAgICAgICAgIGlmICggYWJzRGlzdFggPiBhYnNEaXN0WSArIHRoaXMub3B0aW9ucy5kaXJlY3Rpb25Mb2NrVGhyZXNob2xkICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uTG9ja2VkID0gJ2gnO1x0XHQvLyBsb2NrIGhvcml6b250YWxseVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICggYWJzRGlzdFkgPj0gYWJzRGlzdFggKyB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uTG9ja1RocmVzaG9sZCApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbkxvY2tlZCA9ICd2JztcdFx0Ly8gbG9jayB2ZXJ0aWNhbGx5XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uTG9ja2VkID0gJ24nO1x0XHQvLyBubyBsb2NrXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMuZGlyZWN0aW9uTG9ja2VkID09ICdoJyApIHtcclxuICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmV2ZW50UGFzc3Rocm91Z2ggPT0gJ3ZlcnRpY2FsJyApIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLm9wdGlvbnMuZXZlbnRQYXNzdGhyb3VnaCA9PSAnaG9yaXpvbnRhbCcgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWF0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGRlbHRhWSA9IDA7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRoaXMuZGlyZWN0aW9uTG9ja2VkID09ICd2JyApIHtcclxuICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmV2ZW50UGFzc3Rocm91Z2ggPT0gJ2hvcml6b250YWwnICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRoaXMub3B0aW9ucy5ldmVudFBhc3N0aHJvdWdoID09ICd2ZXJ0aWNhbCcgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWF0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGRlbHRhWCA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBkZWx0YVggPSB0aGlzLmhhc0hvcml6b250YWxTY3JvbGwgPyBkZWx0YVggOiAwO1xyXG4gICAgICAgICAgICBkZWx0YVkgPSB0aGlzLmhhc1ZlcnRpY2FsU2Nyb2xsID8gZGVsdGFZIDogMDtcclxuICAgIFxyXG4gICAgICAgICAgICBuZXdYID0gdGhpcy54ICsgZGVsdGFYO1xyXG4gICAgICAgICAgICBuZXdZID0gdGhpcy55ICsgZGVsdGFZO1xyXG4gICAgXHJcbiAgICAgICAgICAgIC8vIFNsb3cgZG93biBpZiBvdXRzaWRlIG9mIHRoZSBib3VuZGFyaWVzXHJcbiAgICAgICAgICAgIGlmICggbmV3WCA+IDAgfHwgbmV3WCA8IHRoaXMubWF4U2Nyb2xsWCApIHtcclxuICAgICAgICAgICAgICAgIG5ld1ggPSB0aGlzLm9wdGlvbnMuYm91bmNlID8gdGhpcy54ICsgZGVsdGFYIC8gMyA6IG5ld1ggPiAwID8gMCA6IHRoaXMubWF4U2Nyb2xsWDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIG5ld1kgPiAwIHx8IG5ld1kgPCB0aGlzLm1heFNjcm9sbFkgKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdZID0gdGhpcy5vcHRpb25zLmJvdW5jZSA/IHRoaXMueSArIGRlbHRhWSAvIDMgOiBuZXdZID4gMCA/IDAgOiB0aGlzLm1heFNjcm9sbFk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLmRpcmVjdGlvblggPSBkZWx0YVggPiAwID8gLTEgOiBkZWx0YVggPCAwID8gMSA6IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uWSA9IGRlbHRhWSA+IDAgPyAtMSA6IGRlbHRhWSA8IDAgPyAxIDogMDtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoICF0aGlzLm1vdmVkICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZXhlY0V2ZW50KCdzY3JvbGxTdGFydCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5tb3ZlZCA9IHRydWU7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5fdHJhbnNsYXRlKG5ld1gsIG5ld1kpO1xyXG4gICAgXHJcbiAgICAvKiBSRVBMQUNFIFNUQVJUOiBfbW92ZSAqL1xyXG4gICAgICAgICAgICBpZiAoIHRpbWVzdGFtcCAtIHRoaXMuc3RhcnRUaW1lID4gMzAwICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSB0aW1lc3RhbXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0WCA9IHRoaXMueDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRZID0gdGhpcy55O1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5wcm9iZVR5cGUgPT0gMSApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9leGVjRXZlbnQoJ3Njcm9sbCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMucHJvYmVUeXBlID4gMSApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2V4ZWNFdmVudCgnc2Nyb2xsJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIC8qIFJFUExBQ0UgRU5EOiBfbW92ZSAqL1xyXG4gICAgXHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIF9lbmQ6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGlmICggIXRoaXMuZW5hYmxlZCB8fCB1dGlscy5ldmVudFR5cGVbZS50eXBlXSAhPT0gdGhpcy5pbml0aWF0ZWQgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5wcmV2ZW50RGVmYXVsdCAmJiAhdXRpbHMucHJldmVudERlZmF1bHRFeGNlcHRpb24oZS50YXJnZXQsIHRoaXMub3B0aW9ucy5wcmV2ZW50RGVmYXVsdEV4Y2VwdGlvbikgKSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB2YXIgcG9pbnQgPSBlLmNoYW5nZWRUb3VjaGVzID8gZS5jaGFuZ2VkVG91Y2hlc1swXSA6IGUsXHJcbiAgICAgICAgICAgICAgICBtb21lbnR1bVgsXHJcbiAgICAgICAgICAgICAgICBtb21lbnR1bVksXHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IHV0aWxzLmdldFRpbWUoKSAtIHRoaXMuc3RhcnRUaW1lLFxyXG4gICAgICAgICAgICAgICAgbmV3WCA9IE1hdGgucm91bmQodGhpcy54KSxcclxuICAgICAgICAgICAgICAgIG5ld1kgPSBNYXRoLnJvdW5kKHRoaXMueSksXHJcbiAgICAgICAgICAgICAgICBkaXN0YW5jZVggPSBNYXRoLmFicyhuZXdYIC0gdGhpcy5zdGFydFgpLFxyXG4gICAgICAgICAgICAgICAgZGlzdGFuY2VZID0gTWF0aC5hYnMobmV3WSAtIHRoaXMuc3RhcnRZKSxcclxuICAgICAgICAgICAgICAgIHRpbWUgPSAwLFxyXG4gICAgICAgICAgICAgICAgZWFzaW5nID0gJyc7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5pc0luVHJhbnNpdGlvbiA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhdGVkID0gMDtcclxuICAgICAgICAgICAgdGhpcy5lbmRUaW1lID0gdXRpbHMuZ2V0VGltZSgpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIC8vIHJlc2V0IGlmIHdlIGFyZSBvdXRzaWRlIG9mIHRoZSBib3VuZGFyaWVzXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5yZXNldFBvc2l0aW9uKHRoaXMub3B0aW9ucy5ib3VuY2VUaW1lKSApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG8obmV3WCwgbmV3WSk7XHQvLyBlbnN1cmVzIHRoYXQgdGhlIGxhc3QgcG9zaXRpb24gaXMgcm91bmRlZFxyXG4gICAgXHJcbiAgICAgICAgICAgIC8vIHdlIHNjcm9sbGVkIGxlc3MgdGhhbiAxMCBwaXhlbHNcclxuICAgICAgICAgICAgaWYgKCAhdGhpcy5tb3ZlZCApIHtcclxuICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnRhcCApIHtcclxuICAgICAgICAgICAgICAgICAgICB1dGlscy50YXAoZSwgdGhpcy5vcHRpb25zLnRhcCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmNsaWNrICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHV0aWxzLmNsaWNrKGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9leGVjRXZlbnQoJ3Njcm9sbENhbmNlbCcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB0aGlzLl9ldmVudHMuZmxpY2sgJiYgZHVyYXRpb24gPCAyMDAgJiYgZGlzdGFuY2VYIDwgMTAwICYmIGRpc3RhbmNlWSA8IDEwMCApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2V4ZWNFdmVudCgnZmxpY2snKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIC8vIHN0YXJ0IG1vbWVudHVtIGFuaW1hdGlvbiBpZiBuZWVkZWRcclxuICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMubW9tZW50dW0gJiYgZHVyYXRpb24gPCAzMDAgKSB7XHJcbiAgICAgICAgICAgICAgICBtb21lbnR1bVggPSB0aGlzLmhhc0hvcml6b250YWxTY3JvbGwgPyB1dGlscy5tb21lbnR1bSh0aGlzLngsIHRoaXMuc3RhcnRYLCBkdXJhdGlvbiwgdGhpcy5tYXhTY3JvbGxYLCB0aGlzLm9wdGlvbnMuYm91bmNlID8gdGhpcy53cmFwcGVyV2lkdGggOiAwLCB0aGlzLm9wdGlvbnMuZGVjZWxlcmF0aW9uKSA6IHsgZGVzdGluYXRpb246IG5ld1gsIGR1cmF0aW9uOiAwIH07XHJcbiAgICAgICAgICAgICAgICBtb21lbnR1bVkgPSB0aGlzLmhhc1ZlcnRpY2FsU2Nyb2xsID8gdXRpbHMubW9tZW50dW0odGhpcy55LCB0aGlzLnN0YXJ0WSwgZHVyYXRpb24sIHRoaXMubWF4U2Nyb2xsWSwgdGhpcy5vcHRpb25zLmJvdW5jZSA/IHRoaXMud3JhcHBlckhlaWdodCA6IDAsIHRoaXMub3B0aW9ucy5kZWNlbGVyYXRpb24pIDogeyBkZXN0aW5hdGlvbjogbmV3WSwgZHVyYXRpb246IDAgfTtcclxuICAgICAgICAgICAgICAgIG5ld1ggPSBtb21lbnR1bVguZGVzdGluYXRpb247XHJcbiAgICAgICAgICAgICAgICBuZXdZID0gbW9tZW50dW1ZLmRlc3RpbmF0aW9uO1xyXG4gICAgICAgICAgICAgICAgdGltZSA9IE1hdGgubWF4KG1vbWVudHVtWC5kdXJhdGlvbiwgbW9tZW50dW1ZLmR1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNJblRyYW5zaXRpb24gPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5zbmFwICkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNuYXAgPSB0aGlzLl9uZWFyZXN0U25hcChuZXdYLCBuZXdZKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSBzbmFwO1xyXG4gICAgICAgICAgICAgICAgdGltZSA9IHRoaXMub3B0aW9ucy5zbmFwU3BlZWQgfHwgTWF0aC5tYXgoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oTWF0aC5hYnMobmV3WCAtIHNuYXAueCksIDEwMDApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oTWF0aC5hYnMobmV3WSAtIHNuYXAueSksIDEwMDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICksIDMwMCk7XHJcbiAgICAgICAgICAgICAgICBuZXdYID0gc25hcC54O1xyXG4gICAgICAgICAgICAgICAgbmV3WSA9IHNuYXAueTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb25YID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uWSA9IDA7XHJcbiAgICAgICAgICAgICAgICBlYXNpbmcgPSB0aGlzLm9wdGlvbnMuYm91bmNlRWFzaW5nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgIC8vIElOU0VSVCBQT0lOVDogX2VuZFxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggbmV3WCAhPSB0aGlzLnggfHwgbmV3WSAhPSB0aGlzLnkgKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjaGFuZ2UgZWFzaW5nIGZ1bmN0aW9uIHdoZW4gc2Nyb2xsZXIgZ29lcyBvdXQgb2YgdGhlIGJvdW5kYXJpZXNcclxuICAgICAgICAgICAgICAgIGlmICggbmV3WCA+IDAgfHwgbmV3WCA8IHRoaXMubWF4U2Nyb2xsWCB8fCBuZXdZID4gMCB8fCBuZXdZIDwgdGhpcy5tYXhTY3JvbGxZICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVhc2luZyA9IHV0aWxzLmVhc2UucXVhZHJhdGljO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvKG5ld1gsIG5ld1ksIHRpbWUsIGVhc2luZyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9leGVjRXZlbnQoJ3Njcm9sbEVuZCcpO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBfcmVzaXplOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgIFxyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZXNpemVUaW1lb3V0KTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLnJlc2l6ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRoYXQucmVmcmVzaCgpO1xyXG4gICAgICAgICAgICB9LCB0aGlzLm9wdGlvbnMucmVzaXplUG9sbGluZyk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIHJlc2V0UG9zaXRpb246IGZ1bmN0aW9uICh0aW1lKSB7XHJcbiAgICAgICAgICAgIHZhciB4ID0gdGhpcy54LFxyXG4gICAgICAgICAgICAgICAgeSA9IHRoaXMueTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aW1lID0gdGltZSB8fCAwO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggIXRoaXMuaGFzSG9yaXpvbnRhbFNjcm9sbCB8fCB0aGlzLnggPiAwICkge1xyXG4gICAgICAgICAgICAgICAgeCA9IDA7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHRoaXMueCA8IHRoaXMubWF4U2Nyb2xsWCApIHtcclxuICAgICAgICAgICAgICAgIHggPSB0aGlzLm1heFNjcm9sbFg7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoICF0aGlzLmhhc1ZlcnRpY2FsU2Nyb2xsIHx8IHRoaXMueSA+IDAgKSB7XHJcbiAgICAgICAgICAgICAgICB5ID0gMDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICggdGhpcy55IDwgdGhpcy5tYXhTY3JvbGxZICkge1xyXG4gICAgICAgICAgICAgICAgeSA9IHRoaXMubWF4U2Nyb2xsWTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggeCA9PSB0aGlzLnggJiYgeSA9PSB0aGlzLnkgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbFRvKHgsIHksIHRpbWUsIHRoaXMub3B0aW9ucy5ib3VuY2VFYXNpbmcpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBkaXNhYmxlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBlbmFibGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgcmVmcmVzaDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB1dGlscy5nZXRSZWN0KHRoaXMud3JhcHBlcik7XHRcdC8vIEZvcmNlIHJlZmxvd1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMud3JhcHBlcldpZHRoXHQ9IHRoaXMud3JhcHBlci5jbGllbnRXaWR0aDtcclxuICAgICAgICAgICAgdGhpcy53cmFwcGVySGVpZ2h0XHQ9IHRoaXMud3JhcHBlci5jbGllbnRIZWlnaHQ7XHJcbiAgICBcclxuICAgICAgICAgICAgdmFyIHJlY3QgPSB1dGlscy5nZXRSZWN0KHRoaXMuc2Nyb2xsZXIpO1xyXG4gICAgLyogUkVQTEFDRSBTVEFSVDogcmVmcmVzaCAqL1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXJXaWR0aFx0PSByZWN0LndpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbGVySGVpZ2h0XHQ9IHJlY3QuaGVpZ2h0O1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMubWF4U2Nyb2xsWFx0XHQ9IHRoaXMud3JhcHBlcldpZHRoIC0gdGhpcy5zY3JvbGxlcldpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLm1heFNjcm9sbFlcdFx0PSB0aGlzLndyYXBwZXJIZWlnaHQgLSB0aGlzLnNjcm9sbGVySGVpZ2h0O1xyXG4gICAgXHJcbiAgICAvKiBSRVBMQUNFIEVORDogcmVmcmVzaCAqL1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuaGFzSG9yaXpvbnRhbFNjcm9sbFx0PSB0aGlzLm9wdGlvbnMuc2Nyb2xsWCAmJiB0aGlzLm1heFNjcm9sbFggPCAwO1xyXG4gICAgICAgICAgICB0aGlzLmhhc1ZlcnRpY2FsU2Nyb2xsXHRcdD0gdGhpcy5vcHRpb25zLnNjcm9sbFkgJiYgdGhpcy5tYXhTY3JvbGxZIDwgMDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICggIXRoaXMuaGFzSG9yaXpvbnRhbFNjcm9sbCApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWF4U2Nyb2xsWCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyV2lkdGggPSB0aGlzLndyYXBwZXJXaWR0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggIXRoaXMuaGFzVmVydGljYWxTY3JvbGwgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1heFNjcm9sbFkgPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxlckhlaWdodCA9IHRoaXMud3JhcHBlckhlaWdodDtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuZW5kVGltZSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uWCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uWSA9IDA7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZih1dGlscy5oYXNQb2ludGVyICYmICF0aGlzLm9wdGlvbnMuZGlzYWJsZVBvaW50ZXIpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoZSB3cmFwcGVyIHNob3VsZCBoYXZlIGB0b3VjaEFjdGlvbmAgcHJvcGVydHkgZm9yIHVzaW5nIHBvaW50ZXJFdmVudC5cclxuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZVt1dGlscy5zdHlsZS50b3VjaEFjdGlvbl0gPSB1dGlscy5nZXRUb3VjaEFjdGlvbih0aGlzLm9wdGlvbnMuZXZlbnRQYXNzdGhyb3VnaCwgdHJ1ZSk7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIC8vIGNhc2UuIG5vdCBzdXBwb3J0ICdwaW5jaC16b29tJ1xyXG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2N1YmlxL2lzY3JvbGwvaXNzdWVzLzExMTgjaXNzdWVjb21tZW50LTI3MDA1NzU4M1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLndyYXBwZXIuc3R5bGVbdXRpbHMuc3R5bGUudG91Y2hBY3Rpb25dKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlW3V0aWxzLnN0eWxlLnRvdWNoQWN0aW9uXSA9IHV0aWxzLmdldFRvdWNoQWN0aW9uKHRoaXMub3B0aW9ucy5ldmVudFBhc3N0aHJvdWdoLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy53cmFwcGVyT2Zmc2V0ID0gdXRpbHMub2Zmc2V0KHRoaXMud3JhcHBlcik7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5fZXhlY0V2ZW50KCdyZWZyZXNoJyk7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5yZXNldFBvc2l0aW9uKCk7XHJcbiAgICBcclxuICAgIC8vIElOU0VSVCBQT0lOVDogX3JlZnJlc2hcclxuICAgIFxyXG4gICAgICAgIH0sXHRcclxuICAgIFxyXG4gICAgICAgIG9uOiBmdW5jdGlvbiAodHlwZSwgZm4pIHtcclxuICAgICAgICAgICAgaWYgKCAhdGhpcy5fZXZlbnRzW3R5cGVdICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gW107XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0ucHVzaChmbik7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIG9mZjogZnVuY3Rpb24gKHR5cGUsIGZuKSB7XHJcbiAgICAgICAgICAgIGlmICggIXRoaXMuX2V2ZW50c1t0eXBlXSApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuX2V2ZW50c1t0eXBlXS5pbmRleE9mKGZuKTtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIGluZGV4ID4gLTEgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBfZXhlY0V2ZW50OiBmdW5jdGlvbiAodHlwZSkge1xyXG4gICAgICAgICAgICBpZiAoICF0aGlzLl9ldmVudHNbdHlwZV0gKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB2YXIgaSA9IDAsXHJcbiAgICAgICAgICAgICAgICBsID0gdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aDtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoICFsICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgZm9yICggOyBpIDwgbDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdW2ldLmFwcGx5KHRoaXMsIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgc2Nyb2xsQnk6IGZ1bmN0aW9uICh4LCB5LCB0aW1lLCBlYXNpbmcpIHtcclxuICAgICAgICAgICAgeCA9IHRoaXMueCArIHg7XHJcbiAgICAgICAgICAgIHkgPSB0aGlzLnkgKyB5O1xyXG4gICAgICAgICAgICB0aW1lID0gdGltZSB8fCAwO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG8oeCwgeSwgdGltZSwgZWFzaW5nKTtcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgc2Nyb2xsVG86IGZ1bmN0aW9uICh4LCB5LCB0aW1lLCBlYXNpbmcpIHtcclxuICAgICAgICAgICAgZWFzaW5nID0gZWFzaW5nIHx8IHV0aWxzLmVhc2UuY2lyY3VsYXI7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5pc0luVHJhbnNpdGlvbiA9IHRoaXMub3B0aW9ucy51c2VUcmFuc2l0aW9uICYmIHRpbWUgPiAwO1xyXG4gICAgICAgICAgICB2YXIgdHJhbnNpdGlvblR5cGUgPSB0aGlzLm9wdGlvbnMudXNlVHJhbnNpdGlvbiAmJiBlYXNpbmcuc3R5bGU7XHJcbiAgICAgICAgICAgIGlmICggIXRpbWUgfHwgdHJhbnNpdGlvblR5cGUgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodHJhbnNpdGlvblR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvblRpbWluZ0Z1bmN0aW9uKGVhc2luZy5zdHlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb25UaW1lKHRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zbGF0ZSh4LCB5KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2FuaW1hdGUoeCwgeSwgdGltZSwgZWFzaW5nLmZuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBzY3JvbGxUb0VsZW1lbnQ6IGZ1bmN0aW9uIChlbCwgdGltZSwgb2Zmc2V0WCwgb2Zmc2V0WSwgZWFzaW5nKSB7XHJcbiAgICAgICAgICAgIGVsID0gZWwubm9kZVR5cGUgPyBlbCA6IHRoaXMuc2Nyb2xsZXIucXVlcnlTZWxlY3RvcihlbCk7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCAhZWwgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB2YXIgcG9zID0gdXRpbHMub2Zmc2V0KGVsKTtcclxuICAgIFxyXG4gICAgICAgICAgICBwb3MubGVmdCAtPSB0aGlzLndyYXBwZXJPZmZzZXQubGVmdDtcclxuICAgICAgICAgICAgcG9zLnRvcCAgLT0gdGhpcy53cmFwcGVyT2Zmc2V0LnRvcDtcclxuICAgIFxyXG4gICAgICAgICAgICAvLyBpZiBvZmZzZXRYL1kgYXJlIHRydWUgd2UgY2VudGVyIHRoZSBlbGVtZW50IHRvIHRoZSBzY3JlZW5cclxuICAgICAgICAgICAgdmFyIGVsUmVjdCA9IHV0aWxzLmdldFJlY3QoZWwpO1xyXG4gICAgICAgICAgICB2YXIgd3JhcHBlclJlY3QgPSB1dGlscy5nZXRSZWN0KHRoaXMud3JhcHBlcik7XHJcbiAgICAgICAgICAgIGlmICggb2Zmc2V0WCA9PT0gdHJ1ZSApIHtcclxuICAgICAgICAgICAgICAgIG9mZnNldFggPSBNYXRoLnJvdW5kKGVsUmVjdC53aWR0aCAvIDIgLSB3cmFwcGVyUmVjdC53aWR0aCAvIDIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICggb2Zmc2V0WSA9PT0gdHJ1ZSApIHtcclxuICAgICAgICAgICAgICAgIG9mZnNldFkgPSBNYXRoLnJvdW5kKGVsUmVjdC5oZWlnaHQgLyAyIC0gd3JhcHBlclJlY3QuaGVpZ2h0IC8gMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBwb3MubGVmdCAtPSBvZmZzZXRYIHx8IDA7XHJcbiAgICAgICAgICAgIHBvcy50b3AgIC09IG9mZnNldFkgfHwgMDtcclxuICAgIFxyXG4gICAgICAgICAgICBwb3MubGVmdCA9IHBvcy5sZWZ0ID4gMCA/IDAgOiBwb3MubGVmdCA8IHRoaXMubWF4U2Nyb2xsWCA/IHRoaXMubWF4U2Nyb2xsWCA6IHBvcy5sZWZ0O1xyXG4gICAgICAgICAgICBwb3MudG9wICA9IHBvcy50b3AgID4gMCA/IDAgOiBwb3MudG9wICA8IHRoaXMubWF4U2Nyb2xsWSA/IHRoaXMubWF4U2Nyb2xsWSA6IHBvcy50b3A7XHJcbiAgICBcclxuICAgICAgICAgICAgdGltZSA9IHRpbWUgPT09IHVuZGVmaW5lZCB8fCB0aW1lID09PSBudWxsIHx8IHRpbWUgPT09ICdhdXRvJyA/IE1hdGgubWF4KE1hdGguYWJzKHRoaXMueC1wb3MubGVmdCksIE1hdGguYWJzKHRoaXMueS1wb3MudG9wKSkgOiB0aW1lO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG8ocG9zLmxlZnQsIHBvcy50b3AsIHRpbWUsIGVhc2luZyk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIF90cmFuc2l0aW9uVGltZTogZnVuY3Rpb24gKHRpbWUpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMudXNlVHJhbnNpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRpbWUgPSB0aW1lIHx8IDA7XHJcbiAgICAgICAgICAgIHZhciBkdXJhdGlvblByb3AgPSB1dGlscy5zdHlsZS50cmFuc2l0aW9uRHVyYXRpb247XHJcbiAgICAgICAgICAgIGlmKCFkdXJhdGlvblByb3ApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXJTdHlsZVtkdXJhdGlvblByb3BdID0gdGltZSArICdtcyc7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCAhdGltZSAmJiB1dGlscy5pc0JhZEFuZHJvaWQgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyU3R5bGVbZHVyYXRpb25Qcm9wXSA9ICcwLjAwMDFtcyc7XHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgMC4wMDAxbXNcclxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihzZWxmLnNjcm9sbGVyU3R5bGVbZHVyYXRpb25Qcm9wXSA9PT0gJzAuMDAwMW1zJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNjcm9sbGVyU3R5bGVbZHVyYXRpb25Qcm9wXSA9ICcwcyc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5pbmRpY2F0b3JzICkge1xyXG4gICAgICAgICAgICAgICAgZm9yICggdmFyIGkgPSB0aGlzLmluZGljYXRvcnMubGVuZ3RoOyBpLS07ICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yc1tpXS50cmFuc2l0aW9uVGltZSh0aW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICBcclxuICAgIC8vIElOU0VSVCBQT0lOVDogX3RyYW5zaXRpb25UaW1lXHJcbiAgICBcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgX3RyYW5zaXRpb25UaW1pbmdGdW5jdGlvbjogZnVuY3Rpb24gKGVhc2luZykge1xyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbGVyU3R5bGVbdXRpbHMuc3R5bGUudHJhbnNpdGlvblRpbWluZ0Z1bmN0aW9uXSA9IGVhc2luZztcclxuICAgIFxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5pbmRpY2F0b3JzICkge1xyXG4gICAgICAgICAgICAgICAgZm9yICggdmFyIGkgPSB0aGlzLmluZGljYXRvcnMubGVuZ3RoOyBpLS07ICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yc1tpXS50cmFuc2l0aW9uVGltaW5nRnVuY3Rpb24oZWFzaW5nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICBcclxuICAgIC8vIElOU0VSVCBQT0lOVDogX3RyYW5zaXRpb25UaW1pbmdGdW5jdGlvblxyXG4gICAgXHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIF90cmFuc2xhdGU6IGZ1bmN0aW9uICh4LCB5KSB7XHJcbiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnVzZVRyYW5zZm9ybSApIHtcclxuICAgIFxyXG4gICAgLyogUkVQTEFDRSBTVEFSVDogX3RyYW5zbGF0ZSAqL1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyU3R5bGVbdXRpbHMuc3R5bGUudHJhbnNmb3JtXSA9ICd0cmFuc2xhdGUoJyArIHggKyAncHgsJyArIHkgKyAncHgpJyArIHRoaXMudHJhbnNsYXRlWjtcclxuICAgIFxyXG4gICAgLyogUkVQTEFDRSBFTkQ6IF90cmFuc2xhdGUgKi9cclxuICAgIFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgeCA9IE1hdGgucm91bmQoeCk7XHJcbiAgICAgICAgICAgICAgICB5ID0gTWF0aC5yb3VuZCh5KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXJTdHlsZS5sZWZ0ID0geCArICdweCc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyU3R5bGUudG9wID0geSArICdweCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgXHJcbiAgICBcclxuICAgICAgICBpZiAoIHRoaXMuaW5kaWNhdG9ycyApIHtcclxuICAgICAgICAgICAgZm9yICggdmFyIGkgPSB0aGlzLmluZGljYXRvcnMubGVuZ3RoOyBpLS07ICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JzW2ldLnVwZGF0ZVBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgLy8gSU5TRVJUIFBPSU5UOiBfdHJhbnNsYXRlXHJcbiAgICBcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgX2luaXRFdmVudHM6IGZ1bmN0aW9uIChyZW1vdmUpIHtcclxuICAgICAgICAgICAgdmFyIGV2ZW50VHlwZSA9IHJlbW92ZSA/IHV0aWxzLnJlbW92ZUV2ZW50IDogdXRpbHMuYWRkRXZlbnQsXHJcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLm9wdGlvbnMuYmluZFRvV3JhcHBlciA/IHRoaXMud3JhcHBlciA6IHdpbmRvdztcclxuICAgIFxyXG4gICAgICAgICAgICBldmVudFR5cGUod2luZG93LCAnb3JpZW50YXRpb25jaGFuZ2UnLCB0aGlzKTtcclxuICAgICAgICAgICAgZXZlbnRUeXBlKHdpbmRvdywgJ3Jlc2l6ZScsIHRoaXMpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmNsaWNrICkge1xyXG4gICAgICAgICAgICAgICAgZXZlbnRUeXBlKHRoaXMud3JhcHBlciwgJ2NsaWNrJywgdGhpcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoICF0aGlzLm9wdGlvbnMuZGlzYWJsZU1vdXNlICkge1xyXG4gICAgICAgICAgICAgICAgZXZlbnRUeXBlKHRoaXMud3JhcHBlciwgJ21vdXNlZG93bicsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgZXZlbnRUeXBlKHRhcmdldCwgJ21vdXNlbW92ZScsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgZXZlbnRUeXBlKHRhcmdldCwgJ21vdXNlY2FuY2VsJywgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICBldmVudFR5cGUodGFyZ2V0LCAnbW91c2V1cCcsIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB1dGlscy5oYXNQb2ludGVyICYmICF0aGlzLm9wdGlvbnMuZGlzYWJsZVBvaW50ZXIgKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudFR5cGUodGhpcy53cmFwcGVyLCB1dGlscy5wcmVmaXhQb2ludGVyRXZlbnQoJ3BvaW50ZXJkb3duJyksIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgZXZlbnRUeXBlKHRhcmdldCwgdXRpbHMucHJlZml4UG9pbnRlckV2ZW50KCdwb2ludGVybW92ZScpLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSh0YXJnZXQsIHV0aWxzLnByZWZpeFBvaW50ZXJFdmVudCgncG9pbnRlcmNhbmNlbCcpLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSh0YXJnZXQsIHV0aWxzLnByZWZpeFBvaW50ZXJFdmVudCgncG9pbnRlcnVwJyksIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB1dGlscy5oYXNUb3VjaCAmJiAhdGhpcy5vcHRpb25zLmRpc2FibGVUb3VjaCApIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSh0aGlzLndyYXBwZXIsICd0b3VjaHN0YXJ0JywgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICBldmVudFR5cGUodGFyZ2V0LCAndG91Y2htb3ZlJywgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICBldmVudFR5cGUodGFyZ2V0LCAndG91Y2hjYW5jZWwnLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSh0YXJnZXQsICd0b3VjaGVuZCcsIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgZXZlbnRUeXBlKHRoaXMuc2Nyb2xsZXIsICd0cmFuc2l0aW9uZW5kJywgdGhpcyk7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZSh0aGlzLnNjcm9sbGVyLCAnd2Via2l0VHJhbnNpdGlvbkVuZCcsIHRoaXMpO1xyXG4gICAgICAgICAgICBldmVudFR5cGUodGhpcy5zY3JvbGxlciwgJ29UcmFuc2l0aW9uRW5kJywgdGhpcyk7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZSh0aGlzLnNjcm9sbGVyLCAnTVNUcmFuc2l0aW9uRW5kJywgdGhpcyk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIGdldENvbXB1dGVkUG9zaXRpb246IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG1hdHJpeCA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuc2Nyb2xsZXIsIG51bGwpLFxyXG4gICAgICAgICAgICAgICAgeCwgeTtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy51c2VUcmFuc2Zvcm0gKSB7XHJcbiAgICAgICAgICAgICAgICBtYXRyaXggPSBtYXRyaXhbdXRpbHMuc3R5bGUudHJhbnNmb3JtXS5zcGxpdCgnKScpWzBdLnNwbGl0KCcsICcpO1xyXG4gICAgICAgICAgICAgICAgeCA9ICsobWF0cml4WzEyXSB8fCBtYXRyaXhbNF0pO1xyXG4gICAgICAgICAgICAgICAgeSA9ICsobWF0cml4WzEzXSB8fCBtYXRyaXhbNV0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgeCA9ICttYXRyaXgubGVmdC5yZXBsYWNlKC9bXi1cXGQuXS9nLCAnJyk7XHJcbiAgICAgICAgICAgICAgICB5ID0gK21hdHJpeC50b3AucmVwbGFjZSgvW14tXFxkLl0vZywgJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHsgeDogeCwgeTogeSB9O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgX2luaXRJbmRpY2F0b3JzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBpbnRlcmFjdGl2ZSA9IHRoaXMub3B0aW9ucy5pbnRlcmFjdGl2ZVNjcm9sbGJhcnMsXHJcbiAgICAgICAgICAgICAgICBjdXN0b21TdHlsZSA9IHR5cGVvZiB0aGlzLm9wdGlvbnMuc2Nyb2xsYmFycyAhPSAnc3RyaW5nJyxcclxuICAgICAgICAgICAgICAgIGluZGljYXRvcnMgPSBbXSxcclxuICAgICAgICAgICAgICAgIGluZGljYXRvcjtcclxuICAgIFxyXG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JzID0gW107XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2Nyb2xsYmFycyApIHtcclxuICAgICAgICAgICAgICAgIC8vIFZlcnRpY2FsIHNjcm9sbGJhclxyXG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2Nyb2xsWSApIHtcclxuICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3IgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsOiBjcmVhdGVEZWZhdWx0U2Nyb2xsYmFyKCd2JywgaW50ZXJhY3RpdmUsIHRoaXMub3B0aW9ucy5zY3JvbGxiYXJzKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3RpdmU6IGludGVyYWN0aXZlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0U2Nyb2xsYmFyczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tU3R5bGU6IGN1c3RvbVN0eWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNpemU6IHRoaXMub3B0aW9ucy5yZXNpemVTY3JvbGxiYXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaHJpbms6IHRoaXMub3B0aW9ucy5zaHJpbmtTY3JvbGxiYXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWRlOiB0aGlzLm9wdGlvbnMuZmFkZVNjcm9sbGJhcnMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Rlblg6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5hcHBlbmRDaGlsZChpbmRpY2F0b3IuZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGljYXRvcnMucHVzaChpbmRpY2F0b3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICAvLyBIb3Jpem9udGFsIHNjcm9sbGJhclxyXG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2Nyb2xsWCApIHtcclxuICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3IgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsOiBjcmVhdGVEZWZhdWx0U2Nyb2xsYmFyKCdoJywgaW50ZXJhY3RpdmUsIHRoaXMub3B0aW9ucy5zY3JvbGxiYXJzKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3RpdmU6IGludGVyYWN0aXZlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0U2Nyb2xsYmFyczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tU3R5bGU6IGN1c3RvbVN0eWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNpemU6IHRoaXMub3B0aW9ucy5yZXNpemVTY3JvbGxiYXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaHJpbms6IHRoaXMub3B0aW9ucy5zaHJpbmtTY3JvbGxiYXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWRlOiB0aGlzLm9wdGlvbnMuZmFkZVNjcm9sbGJhcnMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Rlblk6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5hcHBlbmRDaGlsZChpbmRpY2F0b3IuZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGljYXRvcnMucHVzaChpbmRpY2F0b3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuaW5kaWNhdG9ycyApIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IGNoZWNrIGNvbmNhdCBjb21wYXRpYmlsaXR5XHJcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3JzID0gaW5kaWNhdG9ycy5jb25jYXQodGhpcy5vcHRpb25zLmluZGljYXRvcnMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgZm9yICggdmFyIGkgPSBpbmRpY2F0b3JzLmxlbmd0aDsgaS0tOyApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9ycy5wdXNoKCBuZXcgSW5kaWNhdG9yKHRoaXMsIGluZGljYXRvcnNbaV0pICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAvLyBUT0RPOiBjaGVjayBpZiB3ZSBjYW4gdXNlIGFycmF5Lm1hcCAod2lkZSBjb21wYXRpYmlsaXR5IGFuZCBwZXJmb3JtYW5jZSBpc3N1ZXMpXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIF9pbmRpY2F0b3JzTWFwIChmbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoYXQuaW5kaWNhdG9ycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoIHZhciBpID0gdGhhdC5pbmRpY2F0b3JzLmxlbmd0aDsgaS0tOyApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm4uY2FsbCh0aGF0LmluZGljYXRvcnNbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmZhZGVTY3JvbGxiYXJzICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbignc2Nyb2xsRW5kJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF9pbmRpY2F0b3JzTWFwKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mYWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbignc2Nyb2xsQ2FuY2VsJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF9pbmRpY2F0b3JzTWFwKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mYWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbignc2Nyb2xsU3RhcnQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2luZGljYXRvcnNNYXAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZhZGUoMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbignYmVmb3JlU2Nyb2xsU3RhcnQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2luZGljYXRvcnNNYXAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZhZGUoMSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5vbigncmVmcmVzaCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF9pbmRpY2F0b3JzTWFwKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLm9uKCdkZXN0cm95JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX2luZGljYXRvcnNNYXAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmluZGljYXRvcnM7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBfaW5pdFdoZWVsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHV0aWxzLmFkZEV2ZW50KHRoaXMud3JhcHBlciwgJ3doZWVsJywgdGhpcyk7XHJcbiAgICAgICAgICAgIHV0aWxzLmFkZEV2ZW50KHRoaXMud3JhcHBlciwgJ21vdXNld2hlZWwnLCB0aGlzKTtcclxuICAgICAgICAgICAgdXRpbHMuYWRkRXZlbnQodGhpcy53cmFwcGVyLCAnRE9NTW91c2VTY3JvbGwnLCB0aGlzKTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLm9uKCdkZXN0cm95JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMud2hlZWxUaW1lb3V0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMud2hlZWxUaW1lb3V0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnJlbW92ZUV2ZW50KHRoaXMud3JhcHBlciwgJ3doZWVsJywgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5yZW1vdmVFdmVudCh0aGlzLndyYXBwZXIsICdtb3VzZXdoZWVsJywgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5yZW1vdmVFdmVudCh0aGlzLndyYXBwZXIsICdET01Nb3VzZVNjcm9sbCcsIHRoaXMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgX3doZWVsOiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBpZiAoICF0aGlzLmVuYWJsZWQgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBcclxuICAgICAgICAgICAgdmFyIHdoZWVsRGVsdGFYLCB3aGVlbERlbHRhWSxcclxuICAgICAgICAgICAgICAgIG5ld1gsIG5ld1ksXHJcbiAgICAgICAgICAgICAgICB0aGF0ID0gdGhpcztcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMud2hlZWxUaW1lb3V0ID09PSB1bmRlZmluZWQgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGF0Ll9leGVjRXZlbnQoJ3Njcm9sbFN0YXJ0Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSBzY3JvbGxFbmQgZXZlbnQgYWZ0ZXIgNDAwbXMgdGhlIHdoZWVsIHN0b3BwZWQgc2Nyb2xsaW5nXHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLndoZWVsVGltZW91dCk7XHJcbiAgICAgICAgICAgIHRoaXMud2hlZWxUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZighdGhhdC5vcHRpb25zLnNuYXApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0Ll9leGVjRXZlbnQoJ3Njcm9sbEVuZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhhdC53aGVlbFRpbWVvdXQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH0sIDQwMCk7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCAnZGVsdGFYJyBpbiBlICkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuZGVsdGFNb2RlID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlZWxEZWx0YVggPSAtZS5kZWx0YVggKiB0aGlzLm9wdGlvbnMubW91c2VXaGVlbFNwZWVkO1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZWVsRGVsdGFZID0gLWUuZGVsdGFZICogdGhpcy5vcHRpb25zLm1vdXNlV2hlZWxTcGVlZDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlZWxEZWx0YVggPSAtZS5kZWx0YVg7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlZWxEZWx0YVkgPSAtZS5kZWx0YVk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoICd3aGVlbERlbHRhWCcgaW4gZSApIHtcclxuICAgICAgICAgICAgICAgIHdoZWVsRGVsdGFYID0gZS53aGVlbERlbHRhWCAvIDEyMCAqIHRoaXMub3B0aW9ucy5tb3VzZVdoZWVsU3BlZWQ7XHJcbiAgICAgICAgICAgICAgICB3aGVlbERlbHRhWSA9IGUud2hlZWxEZWx0YVkgLyAxMjAgKiB0aGlzLm9wdGlvbnMubW91c2VXaGVlbFNwZWVkO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCAnd2hlZWxEZWx0YScgaW4gZSApIHtcclxuICAgICAgICAgICAgICAgIHdoZWVsRGVsdGFYID0gd2hlZWxEZWx0YVkgPSBlLndoZWVsRGVsdGEgLyAxMjAgKiB0aGlzLm9wdGlvbnMubW91c2VXaGVlbFNwZWVkO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCAnZGV0YWlsJyBpbiBlICkge1xyXG4gICAgICAgICAgICAgICAgd2hlZWxEZWx0YVggPSB3aGVlbERlbHRhWSA9IC1lLmRldGFpbCAvIDMgKiB0aGlzLm9wdGlvbnMubW91c2VXaGVlbFNwZWVkO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgd2hlZWxEZWx0YVggKj0gdGhpcy5vcHRpb25zLmludmVydFdoZWVsRGlyZWN0aW9uO1xyXG4gICAgICAgICAgICB3aGVlbERlbHRhWSAqPSB0aGlzLm9wdGlvbnMuaW52ZXJ0V2hlZWxEaXJlY3Rpb247XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCAhdGhpcy5oYXNWZXJ0aWNhbFNjcm9sbCApIHtcclxuICAgICAgICAgICAgICAgIHdoZWVsRGVsdGFYID0gd2hlZWxEZWx0YVk7XHJcbiAgICAgICAgICAgICAgICB3aGVlbERlbHRhWSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5zbmFwICkge1xyXG4gICAgICAgICAgICAgICAgbmV3WCA9IHRoaXMuY3VycmVudFBhZ2UucGFnZVg7XHJcbiAgICAgICAgICAgICAgICBuZXdZID0gdGhpcy5jdXJyZW50UGFnZS5wYWdlWTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCB3aGVlbERlbHRhWCA+IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3WC0tO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICggd2hlZWxEZWx0YVggPCAwICkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld1grKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCB3aGVlbERlbHRhWSA+IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3WS0tO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICggd2hlZWxEZWx0YVkgPCAwICkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld1krKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgdGhpcy5nb1RvUGFnZShuZXdYLCBuZXdZKTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgbmV3WCA9IHRoaXMueCArIE1hdGgucm91bmQodGhpcy5oYXNIb3Jpem9udGFsU2Nyb2xsID8gd2hlZWxEZWx0YVggOiAwKTtcclxuICAgICAgICAgICAgbmV3WSA9IHRoaXMueSArIE1hdGgucm91bmQodGhpcy5oYXNWZXJ0aWNhbFNjcm9sbCA/IHdoZWVsRGVsdGFZIDogMCk7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb25YID0gd2hlZWxEZWx0YVggPiAwID8gLTEgOiB3aGVlbERlbHRhWCA8IDAgPyAxIDogMDtcclxuICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb25ZID0gd2hlZWxEZWx0YVkgPiAwID8gLTEgOiB3aGVlbERlbHRhWSA8IDAgPyAxIDogMDtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIG5ld1ggPiAwICkge1xyXG4gICAgICAgICAgICAgICAgbmV3WCA9IDA7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIG5ld1ggPCB0aGlzLm1heFNjcm9sbFggKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdYID0gdGhpcy5tYXhTY3JvbGxYO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCBuZXdZID4gMCApIHtcclxuICAgICAgICAgICAgICAgIG5ld1kgPSAwO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCBuZXdZIDwgdGhpcy5tYXhTY3JvbGxZICkge1xyXG4gICAgICAgICAgICAgICAgbmV3WSA9IHRoaXMubWF4U2Nyb2xsWTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG8obmV3WCwgbmV3WSwgMCk7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMucHJvYmVUeXBlID4gMSApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2V4ZWNFdmVudCgnc2Nyb2xsJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgLy8gSU5TRVJUIFBPSU5UOiBfd2hlZWxcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgX2luaXRTbmFwOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSB7fTtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHR5cGVvZiB0aGlzLm9wdGlvbnMuc25hcCA9PSAnc3RyaW5nJyApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5zbmFwID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yQWxsKHRoaXMub3B0aW9ucy5zbmFwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMub24oJ3JlZnJlc2gnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IDAsIGwsXHJcbiAgICAgICAgICAgICAgICAgICAgbSA9IDAsIG4sXHJcbiAgICAgICAgICAgICAgICAgICAgY3gsIGN5LFxyXG4gICAgICAgICAgICAgICAgICAgIHggPSAwLCB5LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0ZXBYID0gdGhpcy5vcHRpb25zLnNuYXBTdGVwWCB8fCB0aGlzLndyYXBwZXJXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICBzdGVwWSA9IHRoaXMub3B0aW9ucy5zbmFwU3RlcFkgfHwgdGhpcy53cmFwcGVySGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgIGVsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY3Q7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMucGFnZXMgPSBbXTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCAhdGhpcy53cmFwcGVyV2lkdGggfHwgIXRoaXMud3JhcHBlckhlaWdodCB8fCAhdGhpcy5zY3JvbGxlcldpZHRoIHx8ICF0aGlzLnNjcm9sbGVySGVpZ2h0ICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc25hcCA9PT0gdHJ1ZSApIHtcclxuICAgICAgICAgICAgICAgICAgICBjeCA9IE1hdGgucm91bmQoIHN0ZXBYIC8gMiApO1xyXG4gICAgICAgICAgICAgICAgICAgIGN5ID0gTWF0aC5yb3VuZCggc3RlcFkgLyAyICk7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIHggPiAtdGhpcy5zY3JvbGxlcldpZHRoICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2VzW2ldID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ID0gMDtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIHkgPiAtdGhpcy5zY3JvbGxlckhlaWdodCApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZXNbaV1bbF0gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogTWF0aC5tYXgoeCwgdGhpcy5tYXhTY3JvbGxYKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBNYXRoLm1heCh5LCB0aGlzLm1heFNjcm9sbFkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBzdGVwWCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHN0ZXBZLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN4OiB4IC0gY3gsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3k6IHkgLSBjeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeSAtPSBzdGVwWTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHggLT0gc3RlcFg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsID0gdGhpcy5vcHRpb25zLnNuYXA7XHJcbiAgICAgICAgICAgICAgICAgICAgbCA9IGVsLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICBuID0gLTE7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKCA7IGkgPCBsOyBpKysgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY3QgPSB1dGlscy5nZXRSZWN0KGVsW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBpID09PSAwIHx8IHJlY3QubGVmdCA8PSB1dGlscy5nZXRSZWN0KGVsW2ktMV0pLmxlZnQgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4rKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIXRoaXMucGFnZXNbbV0gKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2VzW21dID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gTWF0aC5tYXgoLXJlY3QubGVmdCwgdGhpcy5tYXhTY3JvbGxYKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IE1hdGgubWF4KC1yZWN0LnRvcCwgdGhpcy5tYXhTY3JvbGxZKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3ggPSB4IC0gTWF0aC5yb3VuZChyZWN0LndpZHRoIC8gMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN5ID0geSAtIE1hdGgucm91bmQocmVjdC5oZWlnaHQgLyAyKTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2VzW21dW25dID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogeCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogcmVjdC53aWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogcmVjdC5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjeDogY3gsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjeTogY3lcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHggPiB0aGlzLm1heFNjcm9sbFggKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMuZ29Ub1BhZ2UodGhpcy5jdXJyZW50UGFnZS5wYWdlWCB8fCAwLCB0aGlzLmN1cnJlbnRQYWdlLnBhZ2VZIHx8IDAsIDApO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgc25hcCB0aHJlc2hvbGQgaWYgbmVlZGVkXHJcbiAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5zbmFwVGhyZXNob2xkICUgMSA9PT0gMCApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNuYXBUaHJlc2hvbGRYID0gdGhpcy5vcHRpb25zLnNuYXBUaHJlc2hvbGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zbmFwVGhyZXNob2xkWSA9IHRoaXMub3B0aW9ucy5zbmFwVGhyZXNob2xkO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNuYXBUaHJlc2hvbGRYID0gTWF0aC5yb3VuZCh0aGlzLnBhZ2VzW3RoaXMuY3VycmVudFBhZ2UucGFnZVhdW3RoaXMuY3VycmVudFBhZ2UucGFnZVldLndpZHRoICogdGhpcy5vcHRpb25zLnNuYXBUaHJlc2hvbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc25hcFRocmVzaG9sZFkgPSBNYXRoLnJvdW5kKHRoaXMucGFnZXNbdGhpcy5jdXJyZW50UGFnZS5wYWdlWF1bdGhpcy5jdXJyZW50UGFnZS5wYWdlWV0uaGVpZ2h0ICogdGhpcy5vcHRpb25zLnNuYXBUaHJlc2hvbGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLm9uKCdmbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0aW1lID0gdGhpcy5vcHRpb25zLnNuYXBTcGVlZCB8fCBNYXRoLm1heChcclxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5tYXgoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihNYXRoLmFicyh0aGlzLnggLSB0aGlzLnN0YXJ0WCksIDEwMDApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oTWF0aC5hYnModGhpcy55IC0gdGhpcy5zdGFydFkpLCAxMDAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApLCAzMDApO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdvVG9QYWdlKFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UucGFnZVggKyB0aGlzLmRpcmVjdGlvblgsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZS5wYWdlWSArIHRoaXMuZGlyZWN0aW9uWSxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgX25lYXJlc3RTbmFwOiBmdW5jdGlvbiAoeCwgeSkge1xyXG4gICAgICAgICAgICBpZiAoICF0aGlzLnBhZ2VzLmxlbmd0aCApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IHg6IDAsIHk6IDAsIHBhZ2VYOiAwLCBwYWdlWTogMCB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdmFyIGkgPSAwLFxyXG4gICAgICAgICAgICAgICAgbCA9IHRoaXMucGFnZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgbSA9IDA7XHJcbiAgICBcclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UgZXhjZWVkZWQgdGhlIHNuYXAgdGhyZXNob2xkXHJcbiAgICAgICAgICAgIGlmICggTWF0aC5hYnMoeCAtIHRoaXMuYWJzU3RhcnRYKSA8IHRoaXMuc25hcFRocmVzaG9sZFggJiZcclxuICAgICAgICAgICAgICAgIE1hdGguYWJzKHkgLSB0aGlzLmFic1N0YXJ0WSkgPCB0aGlzLnNuYXBUaHJlc2hvbGRZICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFBhZ2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHggPiAwICkge1xyXG4gICAgICAgICAgICAgICAgeCA9IDA7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHggPCB0aGlzLm1heFNjcm9sbFggKSB7XHJcbiAgICAgICAgICAgICAgICB4ID0gdGhpcy5tYXhTY3JvbGxYO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB5ID4gMCApIHtcclxuICAgICAgICAgICAgICAgIHkgPSAwO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCB5IDwgdGhpcy5tYXhTY3JvbGxZICkge1xyXG4gICAgICAgICAgICAgICAgeSA9IHRoaXMubWF4U2Nyb2xsWTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGZvciAoIDsgaSA8IGw7IGkrKyApIHtcclxuICAgICAgICAgICAgICAgIGlmICggeCA+PSB0aGlzLnBhZ2VzW2ldWzBdLmN4ICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHggPSB0aGlzLnBhZ2VzW2ldWzBdLng7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBsID0gdGhpcy5wYWdlc1tpXS5sZW5ndGg7XHJcbiAgICBcclxuICAgICAgICAgICAgZm9yICggOyBtIDwgbDsgbSsrICkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCB5ID49IHRoaXMucGFnZXNbMF1bbV0uY3kgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeSA9IHRoaXMucGFnZXNbMF1bbV0ueTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggaSA9PSB0aGlzLmN1cnJlbnRQYWdlLnBhZ2VYICkge1xyXG4gICAgICAgICAgICAgICAgaSArPSB0aGlzLmRpcmVjdGlvblg7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGlmICggaSA8IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBpID49IHRoaXMucGFnZXMubGVuZ3RoICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0aGlzLnBhZ2VzLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIHggPSB0aGlzLnBhZ2VzW2ldWzBdLng7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIG0gPT0gdGhpcy5jdXJyZW50UGFnZS5wYWdlWSApIHtcclxuICAgICAgICAgICAgICAgIG0gKz0gdGhpcy5kaXJlY3Rpb25ZO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoIG0gPCAwICkge1xyXG4gICAgICAgICAgICAgICAgICAgIG0gPSAwO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICggbSA+PSB0aGlzLnBhZ2VzWzBdLmxlbmd0aCApIHtcclxuICAgICAgICAgICAgICAgICAgICBtID0gdGhpcy5wYWdlc1swXS5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICB5ID0gdGhpcy5wYWdlc1swXVttXS55O1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHg6IHgsXHJcbiAgICAgICAgICAgICAgICB5OiB5LFxyXG4gICAgICAgICAgICAgICAgcGFnZVg6IGksXHJcbiAgICAgICAgICAgICAgICBwYWdlWTogbVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBnb1RvUGFnZTogZnVuY3Rpb24gKHgsIHksIHRpbWUsIGVhc2luZykge1xyXG4gICAgICAgICAgICBlYXNpbmcgPSBlYXNpbmcgfHwgdGhpcy5vcHRpb25zLmJvdW5jZUVhc2luZztcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHggPj0gdGhpcy5wYWdlcy5sZW5ndGggKSB7XHJcbiAgICAgICAgICAgICAgICB4ID0gdGhpcy5wYWdlcy5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCB4IDwgMCApIHtcclxuICAgICAgICAgICAgICAgIHggPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB5ID49IHRoaXMucGFnZXNbeF0ubGVuZ3RoICkge1xyXG4gICAgICAgICAgICAgICAgeSA9IHRoaXMucGFnZXNbeF0ubGVuZ3RoIC0gMTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICggeSA8IDAgKSB7XHJcbiAgICAgICAgICAgICAgICB5ID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHZhciBwb3NYID0gdGhpcy5wYWdlc1t4XVt5XS54LFxyXG4gICAgICAgICAgICAgICAgcG9zWSA9IHRoaXMucGFnZXNbeF1beV0ueTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aW1lID0gdGltZSA9PT0gdW5kZWZpbmVkID8gdGhpcy5vcHRpb25zLnNuYXBTcGVlZCB8fCBNYXRoLm1heChcclxuICAgICAgICAgICAgICAgIE1hdGgubWF4KFxyXG4gICAgICAgICAgICAgICAgICAgIE1hdGgubWluKE1hdGguYWJzKHBvc1ggLSB0aGlzLngpLCAxMDAwKSxcclxuICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihNYXRoLmFicyhwb3NZIC0gdGhpcy55KSwgMTAwMClcclxuICAgICAgICAgICAgICAgICksIDMwMCkgOiB0aW1lO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiBwb3NYLFxyXG4gICAgICAgICAgICAgICAgeTogcG9zWSxcclxuICAgICAgICAgICAgICAgIHBhZ2VYOiB4LFxyXG4gICAgICAgICAgICAgICAgcGFnZVk6IHlcclxuICAgICAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbFRvKHBvc1gsIHBvc1ksIHRpbWUsIGVhc2luZyk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICh0aW1lLCBlYXNpbmcpIHtcclxuICAgICAgICAgICAgdmFyIHggPSB0aGlzLmN1cnJlbnRQYWdlLnBhZ2VYLFxyXG4gICAgICAgICAgICAgICAgeSA9IHRoaXMuY3VycmVudFBhZ2UucGFnZVk7XHJcbiAgICBcclxuICAgICAgICAgICAgeCsrO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggeCA+PSB0aGlzLnBhZ2VzLmxlbmd0aCAmJiB0aGlzLmhhc1ZlcnRpY2FsU2Nyb2xsICkge1xyXG4gICAgICAgICAgICAgICAgeCA9IDA7XHJcbiAgICAgICAgICAgICAgICB5Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLmdvVG9QYWdlKHgsIHksIHRpbWUsIGVhc2luZyk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIHByZXY6IGZ1bmN0aW9uICh0aW1lLCBlYXNpbmcpIHtcclxuICAgICAgICAgICAgdmFyIHggPSB0aGlzLmN1cnJlbnRQYWdlLnBhZ2VYLFxyXG4gICAgICAgICAgICAgICAgeSA9IHRoaXMuY3VycmVudFBhZ2UucGFnZVk7XHJcbiAgICBcclxuICAgICAgICAgICAgeC0tO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggeCA8IDAgJiYgdGhpcy5oYXNWZXJ0aWNhbFNjcm9sbCApIHtcclxuICAgICAgICAgICAgICAgIHggPSAwO1xyXG4gICAgICAgICAgICAgICAgeS0tO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5nb1RvUGFnZSh4LCB5LCB0aW1lLCBlYXNpbmcpO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBfaW5pdEtleXM6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIC8vIGRlZmF1bHQga2V5IGJpbmRpbmdzXHJcbiAgICAgICAgICAgIHZhciBrZXlzID0ge1xyXG4gICAgICAgICAgICAgICAgcGFnZVVwOiAzMyxcclxuICAgICAgICAgICAgICAgIHBhZ2VEb3duOiAzNCxcclxuICAgICAgICAgICAgICAgIGVuZDogMzUsXHJcbiAgICAgICAgICAgICAgICBob21lOiAzNixcclxuICAgICAgICAgICAgICAgIGxlZnQ6IDM3LFxyXG4gICAgICAgICAgICAgICAgdXA6IDM4LFxyXG4gICAgICAgICAgICAgICAgcmlnaHQ6IDM5LFxyXG4gICAgICAgICAgICAgICAgZG93bjogNDBcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdmFyIGk7XHJcbiAgICBcclxuICAgICAgICAgICAgLy8gaWYgeW91IGdpdmUgbWUgY2hhcmFjdGVycyBJIGdpdmUgeW91IGtleWNvZGVcclxuICAgICAgICAgICAgaWYgKCB0eXBlb2YgdGhpcy5vcHRpb25zLmtleUJpbmRpbmdzID09ICdvYmplY3QnICkge1xyXG4gICAgICAgICAgICAgICAgZm9yICggaSBpbiB0aGlzLm9wdGlvbnMua2V5QmluZGluZ3MgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCB0eXBlb2YgdGhpcy5vcHRpb25zLmtleUJpbmRpbmdzW2ldID09ICdzdHJpbmcnICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMua2V5QmluZGluZ3NbaV0gPSB0aGlzLm9wdGlvbnMua2V5QmluZGluZ3NbaV0udG9VcHBlckNhc2UoKS5jaGFyQ29kZUF0KDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5rZXlCaW5kaW5ncyA9IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgZm9yICggaSBpbiBrZXlzICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmtleUJpbmRpbmdzW2ldID0gdGhpcy5vcHRpb25zLmtleUJpbmRpbmdzW2ldIHx8IGtleXNbaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB1dGlscy5hZGRFdmVudCh3aW5kb3csICdrZXlkb3duJywgdGhpcyk7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5vbignZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnJlbW92ZUV2ZW50KHdpbmRvdywgJ2tleWRvd24nLCB0aGlzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIF9rZXk6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGlmICggIXRoaXMuZW5hYmxlZCApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHZhciBzbmFwID0gdGhpcy5vcHRpb25zLnNuYXAsXHQvLyB3ZSBhcmUgdXNpbmcgdGhpcyBhbG90LCBiZXR0ZXIgdG8gY2FjaGUgaXRcclxuICAgICAgICAgICAgICAgIG5ld1ggPSBzbmFwID8gdGhpcy5jdXJyZW50UGFnZS5wYWdlWCA6IHRoaXMueCxcclxuICAgICAgICAgICAgICAgIG5ld1kgPSBzbmFwID8gdGhpcy5jdXJyZW50UGFnZS5wYWdlWSA6IHRoaXMueSxcclxuICAgICAgICAgICAgICAgIG5vdyA9IHV0aWxzLmdldFRpbWUoKSxcclxuICAgICAgICAgICAgICAgIHByZXZUaW1lID0gdGhpcy5rZXlUaW1lIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBhY2NlbGVyYXRpb24gPSAwLjI1MCxcclxuICAgICAgICAgICAgICAgIHBvcztcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy51c2VUcmFuc2l0aW9uICYmIHRoaXMuaXNJblRyYW5zaXRpb24gKSB7XHJcbiAgICAgICAgICAgICAgICBwb3MgPSB0aGlzLmdldENvbXB1dGVkUG9zaXRpb24oKTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNsYXRlKE1hdGgucm91bmQocG9zLngpLCBNYXRoLnJvdW5kKHBvcy55KSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzSW5UcmFuc2l0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLmtleUFjY2VsZXJhdGlvbiA9IG5vdyAtIHByZXZUaW1lIDwgMjAwID8gTWF0aC5taW4odGhpcy5rZXlBY2NlbGVyYXRpb24gKyBhY2NlbGVyYXRpb24sIDUwKSA6IDA7XHJcbiAgICBcclxuICAgICAgICAgICAgc3dpdGNoICggZS5rZXlDb2RlICkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSB0aGlzLm9wdGlvbnMua2V5QmluZGluZ3MucGFnZVVwOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5oYXNIb3Jpem9udGFsU2Nyb2xsICYmICF0aGlzLmhhc1ZlcnRpY2FsU2Nyb2xsICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdYICs9IHNuYXAgPyAxIDogdGhpcy53cmFwcGVyV2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3WSArPSBzbmFwID8gMSA6IHRoaXMud3JhcHBlckhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIHRoaXMub3B0aW9ucy5rZXlCaW5kaW5ncy5wYWdlRG93bjpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMuaGFzSG9yaXpvbnRhbFNjcm9sbCAmJiAhdGhpcy5oYXNWZXJ0aWNhbFNjcm9sbCApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3WCAtPSBzbmFwID8gMSA6IHRoaXMud3JhcHBlcldpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1kgLT0gc25hcCA/IDEgOiB0aGlzLndyYXBwZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSB0aGlzLm9wdGlvbnMua2V5QmluZGluZ3MuZW5kOlxyXG4gICAgICAgICAgICAgICAgICAgIG5ld1ggPSBzbmFwID8gdGhpcy5wYWdlcy5sZW5ndGgtMSA6IHRoaXMubWF4U2Nyb2xsWDtcclxuICAgICAgICAgICAgICAgICAgICBuZXdZID0gc25hcCA/IHRoaXMucGFnZXNbMF0ubGVuZ3RoLTEgOiB0aGlzLm1heFNjcm9sbFk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIHRoaXMub3B0aW9ucy5rZXlCaW5kaW5ncy5ob21lOlxyXG4gICAgICAgICAgICAgICAgICAgIG5ld1ggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld1kgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSB0aGlzLm9wdGlvbnMua2V5QmluZGluZ3MubGVmdDpcclxuICAgICAgICAgICAgICAgICAgICBuZXdYICs9IHNuYXAgPyAtMSA6IDUgKyB0aGlzLmtleUFjY2VsZXJhdGlvbj4+MDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgdGhpcy5vcHRpb25zLmtleUJpbmRpbmdzLnVwOlxyXG4gICAgICAgICAgICAgICAgICAgIG5ld1kgKz0gc25hcCA/IDEgOiA1ICsgdGhpcy5rZXlBY2NlbGVyYXRpb24+PjA7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIHRoaXMub3B0aW9ucy5rZXlCaW5kaW5ncy5yaWdodDpcclxuICAgICAgICAgICAgICAgICAgICBuZXdYIC09IHNuYXAgPyAtMSA6IDUgKyB0aGlzLmtleUFjY2VsZXJhdGlvbj4+MDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgdGhpcy5vcHRpb25zLmtleUJpbmRpbmdzLmRvd246XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3WSAtPSBzbmFwID8gMSA6IDUgKyB0aGlzLmtleUFjY2VsZXJhdGlvbj4+MDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCBzbmFwICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nb1RvUGFnZShuZXdYLCBuZXdZKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggbmV3WCA+IDAgKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdYID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5QWNjZWxlcmF0aW9uID0gMDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICggbmV3WCA8IHRoaXMubWF4U2Nyb2xsWCApIHtcclxuICAgICAgICAgICAgICAgIG5ld1ggPSB0aGlzLm1heFNjcm9sbFg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleUFjY2VsZXJhdGlvbiA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIG5ld1kgPiAwICkge1xyXG4gICAgICAgICAgICAgICAgbmV3WSA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleUFjY2VsZXJhdGlvbiA9IDA7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIG5ld1kgPCB0aGlzLm1heFNjcm9sbFkgKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdZID0gdGhpcy5tYXhTY3JvbGxZO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlBY2NlbGVyYXRpb24gPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUbyhuZXdYLCBuZXdZLCAwKTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLmtleVRpbWUgPSBub3c7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIF9hbmltYXRlOiBmdW5jdGlvbiAoZGVzdFgsIGRlc3RZLCBkdXJhdGlvbiwgZWFzaW5nRm4pIHtcclxuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxyXG4gICAgICAgICAgICAgICAgc3RhcnRYID0gdGhpcy54LFxyXG4gICAgICAgICAgICAgICAgc3RhcnRZID0gdGhpcy55LFxyXG4gICAgICAgICAgICAgICAgc3RhcnRUaW1lID0gdXRpbHMuZ2V0VGltZSgpLFxyXG4gICAgICAgICAgICAgICAgZGVzdFRpbWUgPSBzdGFydFRpbWUgKyBkdXJhdGlvbjtcclxuICAgIFxyXG4gICAgICAgICAgICBmdW5jdGlvbiBzdGVwICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBub3cgPSB1dGlscy5nZXRUaW1lKCksXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3WCwgbmV3WSxcclxuICAgICAgICAgICAgICAgICAgICBlYXNpbmc7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGlmICggbm93ID49IGRlc3RUaW1lICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaXNBbmltYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0Ll90cmFuc2xhdGUoZGVzdFgsIGRlc3RZKTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBpZiAoICF0aGF0LnJlc2V0UG9zaXRpb24odGhhdC5vcHRpb25zLmJvdW5jZVRpbWUpICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9leGVjRXZlbnQoJ3Njcm9sbEVuZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgbm93ID0gKCBub3cgLSBzdGFydFRpbWUgKSAvIGR1cmF0aW9uO1xyXG4gICAgICAgICAgICAgICAgZWFzaW5nID0gZWFzaW5nRm4obm93KTtcclxuICAgICAgICAgICAgICAgIG5ld1ggPSAoIGRlc3RYIC0gc3RhcnRYICkgKiBlYXNpbmcgKyBzdGFydFg7XHJcbiAgICAgICAgICAgICAgICBuZXdZID0gKCBkZXN0WSAtIHN0YXJ0WSApICogZWFzaW5nICsgc3RhcnRZO1xyXG4gICAgICAgICAgICAgICAgdGhhdC5fdHJhbnNsYXRlKG5ld1gsIG5ld1kpO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoIHRoYXQuaXNBbmltYXRpbmcgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgckFGKHN0ZXApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoIHRoYXQub3B0aW9ucy5wcm9iZVR5cGUgPT0gMyApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0Ll9leGVjRXZlbnQoJ3Njcm9sbCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5pc0FuaW1hdGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIHN0ZXAoKTtcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgaGFuZGxlRXZlbnQ6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoIGUudHlwZSApIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3RvdWNoc3RhcnQnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAncG9pbnRlcmRvd24nOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnTVNQb2ludGVyRG93bic6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtb3VzZWRvd24nOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0KGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndG91Y2htb3ZlJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3BvaW50ZXJtb3ZlJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ01TUG9pbnRlck1vdmUnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2Vtb3ZlJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb3ZlKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndG91Y2hlbmQnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAncG9pbnRlcnVwJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ01TUG9pbnRlclVwJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ21vdXNldXAnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAndG91Y2hjYW5jZWwnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAncG9pbnRlcmNhbmNlbCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdNU1BvaW50ZXJDYW5jZWwnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2VjYW5jZWwnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VuZChlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ29yaWVudGF0aW9uY2hhbmdlJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3Jlc2l6ZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzaXplKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0cmFuc2l0aW9uZW5kJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3dlYmtpdFRyYW5zaXRpb25FbmQnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnb1RyYW5zaXRpb25FbmQnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnTVNUcmFuc2l0aW9uRW5kJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uRW5kKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnd2hlZWwnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnRE9NTW91c2VTY3JvbGwnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2V3aGVlbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fd2hlZWwoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdrZXlkb3duJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXkoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjbGljayc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLmVuYWJsZWQgJiYgIWUuX2NvbnN0cnVjdGVkICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHRTY3JvbGxiYXIgKGRpcmVjdGlvbiwgaW50ZXJhY3RpdmUsIHR5cGUpIHtcclxuICAgICAgICB2YXIgc2Nyb2xsYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksXHJcbiAgICAgICAgICAgIGluZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgXHJcbiAgICAgICAgaWYgKCB0eXBlID09PSB0cnVlICkge1xyXG4gICAgICAgICAgICBzY3JvbGxiYXIuc3R5bGUuY3NzVGV4dCA9ICdwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4Ojk5OTknO1xyXG4gICAgICAgICAgICBpbmRpY2F0b3Iuc3R5bGUuY3NzVGV4dCA9ICctd2Via2l0LWJveC1zaXppbmc6Ym9yZGVyLWJveDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveDtib3gtc2l6aW5nOmJvcmRlci1ib3g7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSk7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuOSk7Ym9yZGVyLXJhZGl1czozcHgnO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIGluZGljYXRvci5jbGFzc05hbWUgPSAnaVNjcm9sbEluZGljYXRvcic7XHJcbiAgICBcclxuICAgICAgICBpZiAoIGRpcmVjdGlvbiA9PSAnaCcgKSB7XHJcbiAgICAgICAgICAgIGlmICggdHlwZSA9PT0gdHJ1ZSApIHtcclxuICAgICAgICAgICAgICAgIHNjcm9sbGJhci5zdHlsZS5jc3NUZXh0ICs9ICc7aGVpZ2h0OjdweDtsZWZ0OjJweDtyaWdodDoycHg7Ym90dG9tOjAnO1xyXG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yLnN0eWxlLmhlaWdodCA9ICcxMDAlJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzY3JvbGxiYXIuY2xhc3NOYW1lID0gJ2lTY3JvbGxIb3Jpem9udGFsU2Nyb2xsYmFyJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoIHR5cGUgPT09IHRydWUgKSB7XHJcbiAgICAgICAgICAgICAgICBzY3JvbGxiYXIuc3R5bGUuY3NzVGV4dCArPSAnO3dpZHRoOjdweDtib3R0b206MnB4O3RvcDoycHg7cmlnaHQ6MXB4JztcclxuICAgICAgICAgICAgICAgIGluZGljYXRvci5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzY3JvbGxiYXIuY2xhc3NOYW1lID0gJ2lTY3JvbGxWZXJ0aWNhbFNjcm9sbGJhcic7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgc2Nyb2xsYmFyLnN0eWxlLmNzc1RleHQgKz0gJztvdmVyZmxvdzpoaWRkZW4nO1xyXG4gICAgXHJcbiAgICAgICAgaWYgKCAhaW50ZXJhY3RpdmUgKSB7XHJcbiAgICAgICAgICAgIHNjcm9sbGJhci5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHNjcm9sbGJhci5hcHBlbmRDaGlsZChpbmRpY2F0b3IpO1xyXG4gICAgXHJcbiAgICAgICAgcmV0dXJuIHNjcm9sbGJhcjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnVuY3Rpb24gSW5kaWNhdG9yIChzY3JvbGxlciwgb3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMud3JhcHBlciA9IHR5cGVvZiBvcHRpb25zLmVsID09ICdzdHJpbmcnID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb25zLmVsKSA6IG9wdGlvbnMuZWw7XHJcbiAgICAgICAgdGhpcy53cmFwcGVyU3R5bGUgPSB0aGlzLndyYXBwZXIuc3R5bGU7XHJcbiAgICAgICAgdGhpcy5pbmRpY2F0b3IgPSB0aGlzLndyYXBwZXIuY2hpbGRyZW5bMF07XHJcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JTdHlsZSA9IHRoaXMuaW5kaWNhdG9yLnN0eWxlO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsZXIgPSBzY3JvbGxlcjtcclxuICAgIFxyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgbGlzdGVuWDogdHJ1ZSxcclxuICAgICAgICAgICAgbGlzdGVuWTogdHJ1ZSxcclxuICAgICAgICAgICAgaW50ZXJhY3RpdmU6IGZhbHNlLFxyXG4gICAgICAgICAgICByZXNpemU6IHRydWUsXHJcbiAgICAgICAgICAgIGRlZmF1bHRTY3JvbGxiYXJzOiBmYWxzZSxcclxuICAgICAgICAgICAgc2hyaW5rOiBmYWxzZSxcclxuICAgICAgICAgICAgZmFkZTogZmFsc2UsXHJcbiAgICAgICAgICAgIHNwZWVkUmF0aW9YOiAwLFxyXG4gICAgICAgICAgICBzcGVlZFJhdGlvWTogMFxyXG4gICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICBmb3IgKCB2YXIgaSBpbiBvcHRpb25zICkge1xyXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnNbaV0gPSBvcHRpb25zW2ldO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHRoaXMuc2l6ZVJhdGlvWCA9IDE7XHJcbiAgICAgICAgdGhpcy5zaXplUmF0aW9ZID0gMTtcclxuICAgICAgICB0aGlzLm1heFBvc1ggPSAwO1xyXG4gICAgICAgIHRoaXMubWF4UG9zWSA9IDA7XHJcbiAgICBcclxuICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5pbnRlcmFjdGl2ZSApIHtcclxuICAgICAgICAgICAgaWYgKCAhdGhpcy5vcHRpb25zLmRpc2FibGVUb3VjaCApIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLmFkZEV2ZW50KHRoaXMuaW5kaWNhdG9yLCAndG91Y2hzdGFydCcsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdXRpbHMuYWRkRXZlbnQod2luZG93LCAndG91Y2hlbmQnLCB0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoICF0aGlzLm9wdGlvbnMuZGlzYWJsZVBvaW50ZXIgKSB7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5hZGRFdmVudCh0aGlzLmluZGljYXRvciwgdXRpbHMucHJlZml4UG9pbnRlckV2ZW50KCdwb2ludGVyZG93bicpLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHV0aWxzLmFkZEV2ZW50KHdpbmRvdywgdXRpbHMucHJlZml4UG9pbnRlckV2ZW50KCdwb2ludGVydXAnKSwgdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCAhdGhpcy5vcHRpb25zLmRpc2FibGVNb3VzZSApIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLmFkZEV2ZW50KHRoaXMuaW5kaWNhdG9yLCAnbW91c2Vkb3duJywgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5hZGRFdmVudCh3aW5kb3csICdtb3VzZXVwJywgdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5mYWRlICkge1xyXG4gICAgICAgICAgICB0aGlzLndyYXBwZXJTdHlsZVt1dGlscy5zdHlsZS50cmFuc2Zvcm1dID0gdGhpcy5zY3JvbGxlci50cmFuc2xhdGVaO1xyXG4gICAgICAgICAgICB2YXIgZHVyYXRpb25Qcm9wID0gdXRpbHMuc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uO1xyXG4gICAgICAgICAgICBpZighZHVyYXRpb25Qcm9wKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy53cmFwcGVyU3R5bGVbZHVyYXRpb25Qcm9wXSA9IHV0aWxzLmlzQmFkQW5kcm9pZCA/ICcwLjAwMDFtcycgOiAnMG1zJztcclxuICAgICAgICAgICAgLy8gcmVtb3ZlIDAuMDAwMW1zXHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgaWYodXRpbHMuaXNCYWRBbmRyb2lkKSB7XHJcbiAgICAgICAgICAgICAgICByQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc2VsZi53cmFwcGVyU3R5bGVbZHVyYXRpb25Qcm9wXSA9PT0gJzAuMDAwMW1zJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLndyYXBwZXJTdHlsZVtkdXJhdGlvblByb3BdID0gJzBzJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLndyYXBwZXJTdHlsZS5vcGFjaXR5ID0gJzAnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgSW5kaWNhdG9yLnByb3RvdHlwZSA9IHtcclxuICAgICAgICBoYW5kbGVFdmVudDogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoICggZS50eXBlICkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndG91Y2hzdGFydCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdwb2ludGVyZG93bic6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdNU1BvaW50ZXJEb3duJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ21vdXNlZG93bic6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhcnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0b3VjaG1vdmUnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAncG9pbnRlcm1vdmUnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnTVNQb2ludGVyTW92ZSc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtb3VzZW1vdmUnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21vdmUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0b3VjaGVuZCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdwb2ludGVydXAnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnTVNQb2ludGVyVXAnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2V1cCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0b3VjaGNhbmNlbCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdwb2ludGVyY2FuY2VsJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ01TUG9pbnRlckNhbmNlbCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtb3VzZWNhbmNlbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW5kKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuZmFkZVNjcm9sbGJhcnMgKSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5mYWRlVGltZW91dCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZhZGVUaW1lb3V0ID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5pbnRlcmFjdGl2ZSApIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnJlbW92ZUV2ZW50KHRoaXMuaW5kaWNhdG9yLCAndG91Y2hzdGFydCcsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdXRpbHMucmVtb3ZlRXZlbnQodGhpcy5pbmRpY2F0b3IsIHV0aWxzLnByZWZpeFBvaW50ZXJFdmVudCgncG9pbnRlcmRvd24nKSwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5yZW1vdmVFdmVudCh0aGlzLmluZGljYXRvciwgJ21vdXNlZG93bicsIHRoaXMpO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICB1dGlscy5yZW1vdmVFdmVudCh3aW5kb3csICd0b3VjaG1vdmUnLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnJlbW92ZUV2ZW50KHdpbmRvdywgdXRpbHMucHJlZml4UG9pbnRlckV2ZW50KCdwb2ludGVybW92ZScpLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnJlbW92ZUV2ZW50KHdpbmRvdywgJ21vdXNlbW92ZScsIHRoaXMpO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICB1dGlscy5yZW1vdmVFdmVudCh3aW5kb3csICd0b3VjaGVuZCcsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdXRpbHMucmVtb3ZlRXZlbnQod2luZG93LCB1dGlscy5wcmVmaXhQb2ludGVyRXZlbnQoJ3BvaW50ZXJ1cCcpLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnJlbW92ZUV2ZW50KHdpbmRvdywgJ21vdXNldXAnLCB0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmRlZmF1bHRTY3JvbGxiYXJzICYmIHRoaXMud3JhcHBlci5wYXJlbnROb2RlICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy53cmFwcGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBfc3RhcnQ6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIHZhciBwb2ludCA9IGUudG91Y2hlcyA/IGUudG91Y2hlc1swXSA6IGU7XHJcbiAgICBcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvblRpbWUoKTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLmluaXRpYXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMubW92ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5sYXN0UG9pbnRYXHQ9IHBvaW50LnBhZ2VYO1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RQb2ludFlcdD0gcG9pbnQucGFnZVk7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5zdGFydFRpbWVcdD0gdXRpbHMuZ2V0VGltZSgpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggIXRoaXMub3B0aW9ucy5kaXNhYmxlVG91Y2ggKSB7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5hZGRFdmVudCh3aW5kb3csICd0b3VjaG1vdmUnLCB0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoICF0aGlzLm9wdGlvbnMuZGlzYWJsZVBvaW50ZXIgKSB7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5hZGRFdmVudCh3aW5kb3csIHV0aWxzLnByZWZpeFBvaW50ZXJFdmVudCgncG9pbnRlcm1vdmUnKSwgdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCAhdGhpcy5vcHRpb25zLmRpc2FibGVNb3VzZSApIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLmFkZEV2ZW50KHdpbmRvdywgJ21vdXNlbW92ZScsIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxlci5fZXhlY0V2ZW50KCdiZWZvcmVTY3JvbGxTdGFydCcpO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBfbW92ZTogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgdmFyIHBvaW50ID0gZS50b3VjaGVzID8gZS50b3VjaGVzWzBdIDogZSxcclxuICAgICAgICAgICAgICAgIGRlbHRhWCwgZGVsdGFZLFxyXG4gICAgICAgICAgICAgICAgbmV3WCwgbmV3WSxcclxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcCA9IHV0aWxzLmdldFRpbWUoKTtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoICF0aGlzLm1vdmVkICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxlci5fZXhlY0V2ZW50KCdzY3JvbGxTdGFydCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5tb3ZlZCA9IHRydWU7XHJcbiAgICBcclxuICAgICAgICAgICAgZGVsdGFYID0gcG9pbnQucGFnZVggLSB0aGlzLmxhc3RQb2ludFg7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFBvaW50WCA9IHBvaW50LnBhZ2VYO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGRlbHRhWSA9IHBvaW50LnBhZ2VZIC0gdGhpcy5sYXN0UG9pbnRZO1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RQb2ludFkgPSBwb2ludC5wYWdlWTtcclxuICAgIFxyXG4gICAgICAgICAgICBuZXdYID0gdGhpcy54ICsgZGVsdGFYO1xyXG4gICAgICAgICAgICBuZXdZID0gdGhpcy55ICsgZGVsdGFZO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuX3BvcyhuZXdYLCBuZXdZKTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5zY3JvbGxlci5vcHRpb25zLnByb2JlVHlwZSA9PSAxICYmIHRpbWVzdGFtcCAtIHRoaXMuc3RhcnRUaW1lID4gMzAwICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSB0aW1lc3RhbXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLl9leGVjRXZlbnQoJ3Njcm9sbCcpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLnNjcm9sbGVyLm9wdGlvbnMucHJvYmVUeXBlID4gMSApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXIuX2V4ZWNFdmVudCgnc2Nyb2xsJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgXHJcbiAgICAvLyBJTlNFUlQgUE9JTlQ6IGluZGljYXRvci5fbW92ZVxyXG4gICAgXHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgX2VuZDogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgaWYgKCAhdGhpcy5pbml0aWF0ZWQgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLmluaXRpYXRlZCA9IGZhbHNlO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIFxyXG4gICAgICAgICAgICB1dGlscy5yZW1vdmVFdmVudCh3aW5kb3csICd0b3VjaG1vdmUnLCB0aGlzKTtcclxuICAgICAgICAgICAgdXRpbHMucmVtb3ZlRXZlbnQod2luZG93LCB1dGlscy5wcmVmaXhQb2ludGVyRXZlbnQoJ3BvaW50ZXJtb3ZlJyksIHRoaXMpO1xyXG4gICAgICAgICAgICB1dGlscy5yZW1vdmVFdmVudCh3aW5kb3csICdtb3VzZW1vdmUnLCB0aGlzKTtcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMuc2Nyb2xsZXIub3B0aW9ucy5zbmFwICkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNuYXAgPSB0aGlzLnNjcm9sbGVyLl9uZWFyZXN0U25hcCh0aGlzLnNjcm9sbGVyLngsIHRoaXMuc2Nyb2xsZXIueSk7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIHZhciB0aW1lID0gdGhpcy5vcHRpb25zLnNuYXBTcGVlZCB8fCBNYXRoLm1heChcclxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5tYXgoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihNYXRoLmFicyh0aGlzLnNjcm9sbGVyLnggLSBzbmFwLngpLCAxMDAwKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWluKE1hdGguYWJzKHRoaXMuc2Nyb2xsZXIueSAtIHNuYXAueSksIDEwMDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICksIDMwMCk7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGlmICggdGhpcy5zY3JvbGxlci54ICE9IHNuYXAueCB8fCB0aGlzLnNjcm9sbGVyLnkgIT0gc25hcC55ICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXIuZGlyZWN0aW9uWCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxlci5kaXJlY3Rpb25ZID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLmN1cnJlbnRQYWdlID0gc25hcDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnNjcm9sbFRvKHNuYXAueCwgc25hcC55LCB0aW1lLCB0aGlzLnNjcm9sbGVyLm9wdGlvbnMuYm91bmNlRWFzaW5nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5tb3ZlZCApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXIuX2V4ZWNFdmVudCgnc2Nyb2xsRW5kJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgdHJhbnNpdGlvblRpbWU6IGZ1bmN0aW9uICh0aW1lKSB7XHJcbiAgICAgICAgICAgIHRpbWUgPSB0aW1lIHx8IDA7XHJcbiAgICAgICAgICAgIHZhciBkdXJhdGlvblByb3AgPSB1dGlscy5zdHlsZS50cmFuc2l0aW9uRHVyYXRpb247XHJcbiAgICAgICAgICAgIGlmKCFkdXJhdGlvblByb3ApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yU3R5bGVbZHVyYXRpb25Qcm9wXSA9IHRpbWUgKyAnbXMnO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggIXRpbWUgJiYgdXRpbHMuaXNCYWRBbmRyb2lkICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JTdHlsZVtkdXJhdGlvblByb3BdID0gJzAuMDAwMW1zJztcclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSAwLjAwMDFtc1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHNlbGYuaW5kaWNhdG9yU3R5bGVbZHVyYXRpb25Qcm9wXSA9PT0gJzAuMDAwMW1zJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmluZGljYXRvclN0eWxlW2R1cmF0aW9uUHJvcF0gPSAnMHMnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIHRyYW5zaXRpb25UaW1pbmdGdW5jdGlvbjogZnVuY3Rpb24gKGVhc2luZykge1xyXG4gICAgICAgICAgICB0aGlzLmluZGljYXRvclN0eWxlW3V0aWxzLnN0eWxlLnRyYW5zaXRpb25UaW1pbmdGdW5jdGlvbl0gPSBlYXNpbmc7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIHJlZnJlc2g6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uVGltZSgpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmxpc3RlblggJiYgIXRoaXMub3B0aW9ucy5saXN0ZW5ZICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JTdHlsZS5kaXNwbGF5ID0gdGhpcy5zY3JvbGxlci5oYXNIb3Jpem9udGFsU2Nyb2xsID8gJ2Jsb2NrJyA6ICdub25lJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmICggdGhpcy5vcHRpb25zLmxpc3RlblkgJiYgIXRoaXMub3B0aW9ucy5saXN0ZW5YICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JTdHlsZS5kaXNwbGF5ID0gdGhpcy5zY3JvbGxlci5oYXNWZXJ0aWNhbFNjcm9sbCA/ICdibG9jaycgOiAnbm9uZSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluZGljYXRvclN0eWxlLmRpc3BsYXkgPSB0aGlzLnNjcm9sbGVyLmhhc0hvcml6b250YWxTY3JvbGwgfHwgdGhpcy5zY3JvbGxlci5oYXNWZXJ0aWNhbFNjcm9sbCA/ICdibG9jaycgOiAnbm9uZSc7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMuc2Nyb2xsZXIuaGFzSG9yaXpvbnRhbFNjcm9sbCAmJiB0aGlzLnNjcm9sbGVyLmhhc1ZlcnRpY2FsU2Nyb2xsICkge1xyXG4gICAgICAgICAgICAgICAgdXRpbHMuYWRkQ2xhc3ModGhpcy53cmFwcGVyLCAnaVNjcm9sbEJvdGhTY3JvbGxiYXJzJyk7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIsICdpU2Nyb2xsTG9uZVNjcm9sbGJhcicpO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5kZWZhdWx0U2Nyb2xsYmFycyAmJiB0aGlzLm9wdGlvbnMuY3VzdG9tU3R5bGUgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMubGlzdGVuWCApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlLnJpZ2h0ID0gJzhweCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlLmJvdHRvbSA9ICc4cHgnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnJlbW92ZUNsYXNzKHRoaXMud3JhcHBlciwgJ2lTY3JvbGxCb3RoU2Nyb2xsYmFycycpO1xyXG4gICAgICAgICAgICAgICAgdXRpbHMuYWRkQ2xhc3ModGhpcy53cmFwcGVyLCAnaVNjcm9sbExvbmVTY3JvbGxiYXInKTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuZGVmYXVsdFNjcm9sbGJhcnMgJiYgdGhpcy5vcHRpb25zLmN1c3RvbVN0eWxlICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLmxpc3RlblggKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZS5yaWdodCA9ICcycHgnO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZS5ib3R0b20gPSAnMnB4JztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICB1dGlscy5nZXRSZWN0KHRoaXMud3JhcHBlcik7XHQvLyBmb3JjZSByZWZyZXNoXHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMubGlzdGVuWCApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlcldpZHRoID0gdGhpcy53cmFwcGVyLmNsaWVudFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMucmVzaXplICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yV2lkdGggPSBNYXRoLm1heChNYXRoLnJvdW5kKHRoaXMud3JhcHBlcldpZHRoICogdGhpcy53cmFwcGVyV2lkdGggLyAodGhpcy5zY3JvbGxlci5zY3JvbGxlcldpZHRoIHx8IHRoaXMud3JhcHBlcldpZHRoIHx8IDEpKSwgOCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JTdHlsZS53aWR0aCA9IHRoaXMuaW5kaWNhdG9yV2lkdGggKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluZGljYXRvcldpZHRoID0gdGhpcy5pbmRpY2F0b3IuY2xpZW50V2lkdGg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMubWF4UG9zWCA9IHRoaXMud3JhcHBlcldpZHRoIC0gdGhpcy5pbmRpY2F0b3JXaWR0aDtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2hyaW5rID09ICdjbGlwJyApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1pbkJvdW5kYXJ5WCA9IC10aGlzLmluZGljYXRvcldpZHRoICsgODtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1heEJvdW5kYXJ5WCA9IHRoaXMud3JhcHBlcldpZHRoIC0gODtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5taW5Cb3VuZGFyeVggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWF4Qm91bmRhcnlYID0gdGhpcy5tYXhQb3NYO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNpemVSYXRpb1ggPSB0aGlzLm9wdGlvbnMuc3BlZWRSYXRpb1ggfHwgKHRoaXMuc2Nyb2xsZXIubWF4U2Nyb2xsWCAmJiAodGhpcy5tYXhQb3NYIC8gdGhpcy5zY3JvbGxlci5tYXhTY3JvbGxYKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5saXN0ZW5ZICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVySGVpZ2h0ID0gdGhpcy53cmFwcGVyLmNsaWVudEhlaWdodDtcclxuICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnJlc2l6ZSApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluZGljYXRvckhlaWdodCA9IE1hdGgubWF4KE1hdGgucm91bmQodGhpcy53cmFwcGVySGVpZ2h0ICogdGhpcy53cmFwcGVySGVpZ2h0IC8gKHRoaXMuc2Nyb2xsZXIuc2Nyb2xsZXJIZWlnaHQgfHwgdGhpcy53cmFwcGVySGVpZ2h0IHx8IDEpKSwgOCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JTdHlsZS5oZWlnaHQgPSB0aGlzLmluZGljYXRvckhlaWdodCArICdweCc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9ySGVpZ2h0ID0gdGhpcy5pbmRpY2F0b3IuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1heFBvc1kgPSB0aGlzLndyYXBwZXJIZWlnaHQgLSB0aGlzLmluZGljYXRvckhlaWdodDtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2hyaW5rID09ICdjbGlwJyApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1pbkJvdW5kYXJ5WSA9IC10aGlzLmluZGljYXRvckhlaWdodCArIDg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXhCb3VuZGFyeVkgPSB0aGlzLndyYXBwZXJIZWlnaHQgLSA4O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1pbkJvdW5kYXJ5WSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXhCb3VuZGFyeVkgPSB0aGlzLm1heFBvc1k7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMubWF4UG9zWSA9IHRoaXMud3JhcHBlckhlaWdodCAtIHRoaXMuaW5kaWNhdG9ySGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaXplUmF0aW9ZID0gdGhpcy5vcHRpb25zLnNwZWVkUmF0aW9ZIHx8ICh0aGlzLnNjcm9sbGVyLm1heFNjcm9sbFkgJiYgKHRoaXMubWF4UG9zWSAvIHRoaXMuc2Nyb2xsZXIubWF4U2Nyb2xsWSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVQb3NpdGlvbigpO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICB1cGRhdGVQb3NpdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgeCA9IHRoaXMub3B0aW9ucy5saXN0ZW5YICYmIE1hdGgucm91bmQodGhpcy5zaXplUmF0aW9YICogdGhpcy5zY3JvbGxlci54KSB8fCAwLFxyXG4gICAgICAgICAgICAgICAgeSA9IHRoaXMub3B0aW9ucy5saXN0ZW5ZICYmIE1hdGgucm91bmQodGhpcy5zaXplUmF0aW9ZICogdGhpcy5zY3JvbGxlci55KSB8fCAwO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICggIXRoaXMub3B0aW9ucy5pZ25vcmVCb3VuZGFyaWVzICkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCB4IDwgdGhpcy5taW5Cb3VuZGFyeVggKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2hyaW5rID09ICdzY2FsZScgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSBNYXRoLm1heCh0aGlzLmluZGljYXRvcldpZHRoICsgeCwgOCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yU3R5bGUud2lkdGggPSB0aGlzLndpZHRoICsgJ3B4JztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgeCA9IHRoaXMubWluQm91bmRhcnlYO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICggeCA+IHRoaXMubWF4Qm91bmRhcnlYICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5vcHRpb25zLnNocmluayA9PSAnc2NhbGUnICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gTWF0aC5tYXgodGhpcy5pbmRpY2F0b3JXaWR0aCAtICh4IC0gdGhpcy5tYXhQb3NYKSwgOCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yU3R5bGUud2lkdGggPSB0aGlzLndpZHRoICsgJ3B4JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgeCA9IHRoaXMubWF4UG9zWCArIHRoaXMuaW5kaWNhdG9yV2lkdGggLSB0aGlzLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSB0aGlzLm1heEJvdW5kYXJ5WDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLm9wdGlvbnMuc2hyaW5rID09ICdzY2FsZScgJiYgdGhpcy53aWR0aCAhPSB0aGlzLmluZGljYXRvcldpZHRoICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLmluZGljYXRvcldpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yU3R5bGUud2lkdGggPSB0aGlzLndpZHRoICsgJ3B4JztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCB5IDwgdGhpcy5taW5Cb3VuZGFyeVkgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2hyaW5rID09ICdzY2FsZScgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gTWF0aC5tYXgodGhpcy5pbmRpY2F0b3JIZWlnaHQgKyB5ICogMywgOCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yU3R5bGUuaGVpZ2h0ID0gdGhpcy5oZWlnaHQgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB5ID0gdGhpcy5taW5Cb3VuZGFyeVk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB5ID4gdGhpcy5tYXhCb3VuZGFyeVkgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGlzLm9wdGlvbnMuc2hyaW5rID09ICdzY2FsZScgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gTWF0aC5tYXgodGhpcy5pbmRpY2F0b3JIZWlnaHQgLSAoeSAtIHRoaXMubWF4UG9zWSkgKiAzLCA4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JTdHlsZS5oZWlnaHQgPSB0aGlzLmhlaWdodCArICdweCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSB0aGlzLm1heFBvc1kgKyB0aGlzLmluZGljYXRvckhlaWdodCAtIHRoaXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSB0aGlzLm1heEJvdW5kYXJ5WTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0aGlzLm9wdGlvbnMuc2hyaW5rID09ICdzY2FsZScgJiYgdGhpcy5oZWlnaHQgIT0gdGhpcy5pbmRpY2F0b3JIZWlnaHQgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLmluZGljYXRvckhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluZGljYXRvclN0eWxlLmhlaWdodCA9IHRoaXMuaGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMueCA9IHg7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYgKCB0aGlzLnNjcm9sbGVyLm9wdGlvbnMudXNlVHJhbnNmb3JtICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JTdHlsZVt1dGlscy5zdHlsZS50cmFuc2Zvcm1dID0gJ3RyYW5zbGF0ZSgnICsgeCArICdweCwnICsgeSArICdweCknICsgdGhpcy5zY3JvbGxlci50cmFuc2xhdGVaO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JTdHlsZS5sZWZ0ID0geCArICdweCc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluZGljYXRvclN0eWxlLnRvcCA9IHkgKyAncHgnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIF9wb3M6IGZ1bmN0aW9uICh4LCB5KSB7XHJcbiAgICAgICAgICAgIGlmICggeCA8IDAgKSB7XHJcbiAgICAgICAgICAgICAgICB4ID0gMDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICggeCA+IHRoaXMubWF4UG9zWCApIHtcclxuICAgICAgICAgICAgICAgIHggPSB0aGlzLm1heFBvc1g7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoIHkgPCAwICkge1xyXG4gICAgICAgICAgICAgICAgeSA9IDA7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHkgPiB0aGlzLm1heFBvc1kgKSB7XHJcbiAgICAgICAgICAgICAgICB5ID0gdGhpcy5tYXhQb3NZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgeCA9IHRoaXMub3B0aW9ucy5saXN0ZW5YID8gTWF0aC5yb3VuZCh4IC8gdGhpcy5zaXplUmF0aW9YKSA6IHRoaXMuc2Nyb2xsZXIueDtcclxuICAgICAgICAgICAgeSA9IHRoaXMub3B0aW9ucy5saXN0ZW5ZID8gTWF0aC5yb3VuZCh5IC8gdGhpcy5zaXplUmF0aW9ZKSA6IHRoaXMuc2Nyb2xsZXIueTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnNjcm9sbFRvKHgsIHkpO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBmYWRlOiBmdW5jdGlvbiAodmFsLCBob2xkKSB7XHJcbiAgICAgICAgICAgIGlmICggaG9sZCAmJiAhdGhpcy52aXNpYmxlICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZmFkZVRpbWVvdXQpO1xyXG4gICAgICAgICAgICB0aGlzLmZhZGVUaW1lb3V0ID0gbnVsbDtcclxuICAgIFxyXG4gICAgICAgICAgICB2YXIgdGltZSA9IHZhbCA/IDI1MCA6IDUwMCxcclxuICAgICAgICAgICAgICAgIGRlbGF5ID0gdmFsID8gMCA6IDMwMDtcclxuICAgIFxyXG4gICAgICAgICAgICB2YWwgPSB2YWwgPyAnMScgOiAnMCc7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy53cmFwcGVyU3R5bGVbdXRpbHMuc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uXSA9IHRpbWUgKyAnbXMnO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuZmFkZVRpbWVvdXQgPSBzZXRUaW1lb3V0KChmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXJTdHlsZS5vcGFjaXR5ID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gK3ZhbDtcclxuICAgICAgICAgICAgfSkuYmluZCh0aGlzLCB2YWwpLCBkZWxheSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgSVNjcm9sbC51dGlscyA9IHV0aWxzO1xyXG4gICAgXHJcbiAgICBpZiAoIHR5cGVvZiBtb2R1bGUgIT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XHJcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBJU2Nyb2xsO1xyXG4gICAgfSBlbHNlIGlmICggdHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XHJcbiAgICAgICAgICAgIGRlZmluZSggZnVuY3Rpb24gKCkgeyByZXR1cm4gSVNjcm9sbDsgfSApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB3aW5kb3cuSVNjcm9sbCA9IElTY3JvbGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIH0pKHdpbmRvdywgZG9jdW1lbnQsIE1hdGgpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvanMvY29tbW9uL2lzY3JvbGwuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==")}]);